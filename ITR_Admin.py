from ast import arguments
from testlink import TestlinkAPIClient, TestLinkHelper
# from bs4 import BeautifulSoup
# from urllib.parse import quote_plus
from seleniumwire import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.common.keys import Keys
import time
import json
from selenium.webdriver.support.ui import Select
import math
from datetime import datetime, timedelta
from dateutil.relativedelta import relativedelta
import random
import cx_Oracle
import os
# import pandas as pd
import string

# import ITR_Admin_Common

# TestLink User: kyle
URL = 'http://testserver-win:81/testlink/lib/api/xmlrpc/v1/xmlrpc.php'
DevKey = 'adcb86843d0c77e6e0c9950f80a143c0'

# TestLink 초기화
tl_helper = TestLinkHelper()
testlink = tl_helper.connect(TestlinkAPIClient) 
testlink.__init__(URL, DevKey)
testlink.checkDevKey()

# 브라우저 설정
options = webdriver.ChromeOptions()
options.add_experimental_option("excludeSwitches", ["enable-logging"])
driver = webdriver.Chrome(options=options)
# baseUrl = 'http://stagingadmin.onpacs.com'
baseUrl = 'http://vm-onpacs:8082'
# html = requests.get(baseUrl)
# soup = BeautifulSoup(html.text, 'html.parser')
# url = baseUrl + quote_plus(plusUrl)
driver.get(baseUrl)


# Notice 창 닫기
popup = driver.window_handles
while len(popup) != 1:
    driver.switch_to.window(popup[1])
    #driver.close()
    driver.find_element(By.ID, "notice_modal_cancel_week").click()
    popup = driver.window_handles
driver.switch_to.window(popup[0])
# html = driver.page_source
# soup = BeautifulSoup(html)
# result_list = []

# TestPlanID = AutoTest 버전 테스트
testPlanID = 2996
buildName = 1

# 테스트 계정
adminID = 'testAdmin'
adminPW = 'Server123!@#'
subadminID = 'testSubadmin'
subadminPW = 'Server123!@#'
reporterID = 'testReporter'
reporterPW = 'Server123!@#'
wk_id = "testInfReporter"
wk_pw = "Server123!@#"
wk_id_2 = "ITRTestUsers" #DownloadControl_User_Add / DownloadControl_User_Modify / DownloadControl_Institution_Add / DownloadControl_Institution_Modify / UserManagement_Registartion_Modify
wk_pw_2 = "1234qwer!@"#DownloadControl_User_Add / DownloadControl_User_Modify / DownloadControl_Institution_Add / DownloadControl_Institution_Modify 
search_id = "testInfReporter" #DirectMessageBox_Search / DirectMessageSetting_Search
search_username = "TestINFReporter" #DirectMessageBox_Search / DirectMessageSetting_Search

# 공통 변수
WorklistUrl = 'http://vm-onpacs'
today = datetime.now()
test_hospital = "Cloud Team"
test_hospital_code = '997'
start = time.time()
search_text = "test" #DirectMessageBox_Search
search_institution = "INFINITT" #NewDirectMessage_Institution
search_institution_2 = "Cloud" #MultiReadingCenterRule / Institution_SearchFilter / DownloadControl_Institution_Add / DownloadControl_Institution_Modify / UserManageMent_UserRegistartion_Add
search_institution_3 = "Cloud Team" #Institution_Modify / DownloadControl_User_Add
#search_institution_code = "997" #Institution_SearchFilter / Institution_Add
search_center = "인피니트" #NewDirectMessage_Center_Search / MultiReadingCenterRule / Institution_Add / UserManageMent_UserRegistartion_Add
search_center_2 = "인피니트테스트" #MultiReadingCenterRule
search_reporter = "TestINFReporter" #NewDirectMessage_Center_Reporter
unauth_search_id = "TEST_MAP" #DirectMessageSetting_Search
unauth_search_username = "김태호" #DirectMessageSetting_Search
add_test_id = "TestA" #+난수 # DirectMessageSetting_Authorize / UserManageMent_UserRegistartion_Add / UserMangement_UserRegistartion_Delete / UserManagement_Registration_Add
add_test_pw = "1234qwer!" #DirectMessageSetting_Authorize / UserManageMent_UserRegistartion_Add
upload_pic = "C:\\Users\\INFINITT\\Desktop\\uploadtest.png" # NoticeList_NoticeEditBoard
upload_pic_url = "https://i.ytimg.com/vi/gREpAVOERis/maxresdefault.jpg" # NoticeList_NoticeEditBoards
specialty = "ITRTest" #DownloadControl_Add / Specialty_SpecialtyList_Search
specialty_add = "SpTest" #Specialty_SpecialtyList_Add

class Common:
    def refer_show_entries(num):
        select = Select(driver.find_element(By.CSS_SELECTOR,"#refer-assigned-list_length > label > select"))                
        select.select_by_value(str(num))
    def config_show_entries(num):
        select = Select(driver.find_element(By.CSS_SELECTOR,"#download-list_length > label > select"))
        select.select_by_value(str(num))
    def cnt_pages():
        # 현재 Job list 페이지의 job count 리턴
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]
        pages = math.ceil(int(list_cnt) / 100)
        return pages
    def ReFresh():
        driver.find_element(By.CSS_SELECTOR, "body > nav > div > div:nth-child(1) > a.navbar-brand").click()
        driver.implicitly_wait(5)

class signInOut:
    def admin_sign_in():
        driver.find_element(By.ID, 'user-id').clear()
        driver.find_element(By.ID, 'user-id').send_keys(adminID)
        driver.find_element(By.ID, 'user-password').send_keys(adminPW)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()
        driver.implicitly_wait(5)
    def admin_sign_out():
        driver.find_element(By.CSS_SELECTOR, '.pull-right > span').click()
    def subadmin_sign_in():
        driver.find_element(By.ID, 'user-id').clear()
        driver.find_element(By.ID, 'user-id').send_keys(subadminID)
        driver.find_element(By.ID, 'user-password').send_keys(subadminPW)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()
        driver.implicitly_wait(5)
    def subadmin_sign_out():
        driver.find_element(By.CSS_SELECTOR, '.pull-right > span').click()
    def wk_login(work_id, work_pw):
        driver.find_element(By.ID, 'user-id').clear()
        driver.find_element(By.ID, 'user-id').send_keys(work_id)
        driver.find_element(By.ID, 'user-password').clear()
        driver.find_element(By.ID, 'user-password').send_keys(work_pw)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()
        driver.implicitly_wait(5)    

        driver.find_element(By.CSS_SELECTOR, '.btn').click()
        driver.implicitly_wait(5)
        # 인증서 비밀번호 입력 닫기
        try:
            WebDriverWait(driver, 1.5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[4]/div/div/div[2]/div/div[2]/button[1]")))
            driver.find_element(By.XPATH, "/html/body/div[4]/div/div/div[2]/div/div[2]/button[1]").click()
        except:
            pass
            #print("no cert")

        # waiting loading
        try:
            WebDriverWait(driver, 0.5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section[1]/div/div/div/section[1]/div[3]/div/div[1]/button[3]")))
        except:
            pass

class windowSize:
    driver.set_window_size(1920, 1080)

class Sign:
    def Sign_InOut():
        print("ITR-1: Sign > Sign In/Out")
        testResult = ''
        reason = list()       
        
        # 2 steps start! : user ID와 password를 입력하지 않고 sign in을 클릭한다
        # user ID와 password를 입력하지 않고 sign in을 클릭한다
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").send_keys("")
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").send_keys("")
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()

        # 오류 메시지 확인: This field is required.
        try:
            assert driver.find_element(By.ID, "user-id-error").text == "This field is required."
        except:
            testResult = 'failed'
            reason.append("Sign_InOut step 2 isn't valid")    
        
        # 3 steps start! : 잘못된 user ID를 입력하고 sign in을 클릭한다
        # 잘못된 user ID와 Password를 입력하고 sign in을 클릭한다
        strings = string.ascii_letters
        userid = ""
        for i in range(8):
            userid += random.choice(strings)
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").send_keys(userid)
        time.sleep(0.5)
        
        digits = string.digits
        pw = ""
        for i in range(8):
            pw += random.choice(digits)
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").send_keys(pw)
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()
        
        # 오류 메시지 확인: User not found
        try:
            assert driver.find_element(By.CSS_SELECTOR, ".validation-summary-errors > ul > li").text == "User not found"
        except:
            testResult = 'failed'
            reason.append("Sign_InOut step 3 isn't valid")
        
        # 4 steps start! : password 미입력 하고 sign in을 클릭한다 
        # password 미입력 하고 sign in을 클릭한다        
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").clear()
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").send_keys(adminID)
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").clear()
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").send_keys("")
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()

        # 오류 메시지 확인: This field is required.
        try:
           assert driver.find_element(By.ID, "user-password-error").text == "This field is required."
        except:
            testResult = 'failed'
            reason.append("Sign_InOut step 3 isn't valid")
        
        # 4 steps start! : admin 유저가 아닌 계정으로 로그인 한다.
        # admin 유저가 아닌 계정으로 로그인 한다.    
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").clear()    
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").send_keys(reporterID)
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").clear()
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").send_keys(reporterPW)
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()

        # 오류 메시지 확인: not admin user
        try:
            assert driver.find_element(By.CSS_SELECTOR, ".validation-summary-errors >  ul > li").text == "Not admin user"
        except:
            testResult = 'failed'
            reason.append("Sign_InOut step 4 isn't valid")
        
        # 5 steps start! : 정상적인 계정으로 로그인 한다.
        # 정상적인 계정으로 로그인 한다.
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").clear()   
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[3]/div/input").send_keys(adminID)
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").clear()
        driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/form/div[4]/div/input").send_keys(adminPW)
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, '.btn').click()
        driver.implicitly_wait(5)        

        # 정상적으로 로그인 되었는지 확인
        try:
            assert driver.find_element(By.CSS_SELECTOR, ".pull-right > span").text == "Sign Out"
        except:
            testResult = 'failed'
            reason.append("Sign_InOut step 5 isn't valid")
        
        # sign_InOut 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1531, testPlanID, buildName, 'f', result)            
        else:
            testlink.reportTCResult(1531, testPlanID, buildName, 'p', "Sign In/Out Test Passed")
        driver.find_element(By.CSS_SELECTOR, ".pull-right > span").click()
        driver.implicitly_wait(3)
    
    def Rememeber_Me():
        print("ITR-2: Sign > Remember Me")
        testResult = ''
        reason = list() 
        
        # 1 steps start! : User ID와 User Password를 입력하고, Remember Me를 체크한 후, Sign In을 클릭한다.
        # 정상적인 계정을 입력 및 remind me를 체크하고 로그인 한다.
        driver.find_element(By.ID, 'user-id').clear()
        driver.find_element(By.ID, 'user-id').send_keys(adminID)
        driver.find_element(By.ID, 'user-password').send_keys(adminPW)
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, '.col-xs-8.p-t-5 > label').click()
        driver.find_element(By.CSS_SELECTOR, '.btn').click()         
        driver.implicitly_wait(3)                       
        time.sleep(0.5)

        # 로그아웃 후, 마지막에 접속한 User ID와 Remind Me 체크 상태를 확인한다.
        signInOut.admin_sign_out()        
        try:
            assert (driver.find_element(By.ID, 'user-id').get_property("value"), driver.find_element(By.XPATH, '/html/body/div/div/div[2]/div/form/div[5]/div[1]/input').get_property('checked')) == (adminID, True)
        except:
            testResult = 'failed' 
            reason.append("1 Steps failed")
        
        # Remember_Me 결과 전송       
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1538, testPlanID, buildName, 'f', result)            
        else:
            testlink.reportTCResult(1538, testPlanID, buildName, 'p', "Remember Me Test Passed")    

class Topbar:
    def Search_Schedule_List():
        print("ITR-3: Topbar > Search Schedule List")
        testResult = '' 
        reason = list() 
        
        signInOut.admin_sign_in()

        # 1 steps start! : 상단의 Schedule badge를 클릭하고, Schedule 개수를 확인한다.
        # 상단의 Schedule badge를 클릭하고, Schedule 개수를 확인한다.
        time.sleep(3)
        driver.find_element(By.ID, 'schedule_info_box').click()
        sch_info_num = driver.find_element(By.ID, 'schedule_info_number').text
        sch_info_num = sch_info_num.split('/')
        refer_sch_num, sch_num = sch_info_num[0], sch_info_num[1].strip()
        time.sleep(3)

        # Hospital list에서 schedule count 저장
        hospitals = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        hospital_list = []
        for i in hospitals:
            hospital_list.append((i.get_property("dataset"))["institutionCode"])
        
        hospital_schedule_cnt = int()
        not_refer_joblist_cnt = int()
        all_joblist_cnt = int()
        for i in hospital_list:
            try:
                # 병원 리스트에서 Schedule badge의 count 저장
                temp_schedule_cnt = driver.find_element(By.CSS_SELECTOR, "#list-institution-row-"+str(i)+" > span:nth-child(1) > span").get_property("textContent")
                hospital_schedule_cnt += int((temp_schedule_cnt.split())[2])
                
                # Schedule이 있는 병원 선택
                driver.find_element(By.CSS_SELECTOR, "#list-institution-row-"+str(i)).click()
                
                # All Assigned List 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()
                time.sleep(1)         
                
                # All Assigned List > Showing entry 결과 저장
                temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
                all_joblist_cnt += int((temp_cnt.split())[5])

                # Not Assigned List 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

                # Not Assigned List > Showing entry 결과 저장
                time.sleep(1)
                temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
                all_joblist_cnt += int((temp_cnt.split())[5])
                not_refer_joblist_cnt += int((temp_cnt.split())[5])

                # All Assigned List 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()
                time.sleep(1)
            except:
                continue

        # Schedule badge의 schedule 개수와 조회 결과 리스트의 schedule 개수를 비교한다.              
        try:
            assert int(sch_num) == all_joblist_cnt == hospital_schedule_cnt
        except:
            testResult = 'failed'
            reason.append("1 steps failed")
        
        # Schedule badge의 refer된 schedule 개수와 조회 결과 리스트의 refer된 schedule 개수를 비교한다.        
        try:
            assert int(refer_sch_num) == not_refer_joblist_cnt
        except:
            testResult = 'failed'
            reason.append("2 steps failed")

        # Searh_Schedule_List 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1542, testPlanID, buildName, 'f', result)            
        else:
            testlink.reportTCResult(1542, testPlanID, buildName, 'p', "Search_Schedule_List Test Passed")  

class Refer:
    def Hospital_List():
        print("ITR-7: Refer > Hospital List")
        testResult = ''
        reason = list() 

        # Refer 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        time.sleep(1)

        # 1 steps start! : 모든 병원의 badge count와 job list의 결과가 일치하는지 확인
        # Hospital list 저장
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        hospital_cnt = len(data)

        # 각 hospital의 refer, requested, emergency job의 건수 비교
        if hospital_cnt > 0:
            n = 0

            for i in data:
                priority_cnt = i['PriorityCount']
                job_cnt = i['JobCount']
                refer_cnt = i['ReferCount']
                refer_priority_cnt = 0
                emer_reporter_list_cnt = int()
                time.sleep(2)
                del driver.requests
                hospital_list[n].click()

                # 선택한 병원의 Job list 결과 저장 
                request = driver.wait_for_request('.*/GetAllAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]
                
                # Showing entry 결과 저장
                temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
                temp_cnt = temp_cnt.split()
                list_cnt = temp_cnt[5]
                refer_reporter_list = []
                emer_reporter_list = []
                
                # Show 100 entries 설정
                select = Select(driver.find_element(By.CSS_SELECTOR,"#refer-assigned-list_length > label > select"))
                select.select_by_value("100")
                pages = math.ceil(int(list_cnt) / 100)
                
                # All Assigned List 탭에서 Refer count를 조회 결과에서 계산 
                while pages > 0: 
                    for i in data:
                        # All Assigned List 탭에서 Refer 건수 계산
                        refer_text = (i["REFERRED_USER_KEYS"])
                        temp_refer_text_list = (refer_text.split(','))                        
                        for j in temp_refer_text_list:                            
                            refer_reporter_list.append(j)
                    
                        # All Assigned List 탭에서 Emergency Job 건수 계산
                        if i["JobPriority"] == 'E':
                            emer_reporter_key = (i["REFERRED_USER_KEYS"])
                            temp_emer_reporter = (emer_reporter_key.split(','))
                            for j in temp_emer_reporter:
                                emer_reporter_list.append(j)
                            emer_reporter_list_cnt = len(emer_reporter_list)
                            
                    pages = pages - 1
                    del driver.requests
                    
                    # 새로운 페이지 조회 결과 저장
                    if pages > 0:
                        driver.find_element(By.CSS_SELECTOR,"#refer-assigned-list_next > a").click()
                        request = driver.wait_for_request('.*/GetAllAssignedList.*')
                        body = request.response.body.decode('utf-8')
                        data = json.loads(body)["data"]
                    refer_text_list_cnt = len(refer_reporter_list)
                    
                # 병원 리스트의 Refer badge count와 Job list의 refer job list 개수 확인
                try:
                    assert refer_cnt == refer_text_list_cnt
                except:
                    testResult = 'failed'
                    reason.append("Step1 - Refer count isn't valid")
                    
                # 요청 결과 삭제
                del driver.requests
                
                # All Assigned List의 Showing entries 값 저장
                temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
                temp_cnt = temp_cnt.split()
                list_cnt = temp_cnt[5]
                assigned_list_result = int(list_cnt)

                # Not Assigned List 탭 클릭
                element = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]/a")
                driver.execute_script("arguments[0].click()",element)
                
                # 선택한 병원의 Not Assigned List 결과 저장
                request = driver.wait_for_request('.*/GetNotAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                # Not Assigned List의 Showing entries 값 저장
                temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
                temp_cnt = temp_cnt.split()
                list_cnt = temp_cnt[5]
                not_refer_text_list = int(list_cnt)
                pages = math.ceil(int(list_cnt) / 100)

                # Emergency Job 건수 계산
                while pages > 0: 
                    for i in data:
                        if i["JobPriority"] == 'E':
                            emer_reporter_list_cnt = emer_reporter_list_cnt + 1
                            
                    pages = pages - 1   
                    del driver.requests
                    if pages > 0:
                        # 새로운 페이지의 결과 저장
                        driver.find_element(By.CSS_SELECTOR,"#refer-assigned-list_next > a").click()
                        request = driver.wait_for_request('.*/GetNotAssignedList.*')
                        body = request.response.body.decode('utf-8')
                        data = json.loads(body)["data"]
                        time.sleep(1)

                try:
                    assert (int(priority_cnt), int(job_cnt)) == (int(emer_reporter_list_cnt), int(assigned_list_result) + int(not_refer_text_list))
                except:
                        testResult = 'failed'
                        reason.append("1 steps failed")

                # All Assigned List 탭 클릭
                driver.find_element(By.XPATH,"/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]/a").click()
                n = n + 1

        # 2 steps start! : 병원을 선택하면 표시되는 Reporter가 해당 병원의 소속된 Reporter 인지 확인
        # Refer 화면 새로고침
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Hospital list 저장
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        hospital_cnt = len(data)
        
        if hospital_cnt > 0:
            n = 0

            for i in data:
                # Institution name 저장
                inst_name = i['InstitutionName']
                time.sleep(0.5)
                del driver.requests
                
                # Hospital list 다시 저장
                hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                hospital_list[n].click()
                
                # Hospital list의 Reporter list 저장
                request = driver.wait_for_request('.*/GetReporterListByInstitution.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)
                reporter_list = []
                
                # Reporter Key 저장                
                for i in data:
                    reporter_list.append(i['ReporterKey'])

                # Configuration > Download control로 이동
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]/a").click()
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/button[3]").click()

                # 선택한 병원의 institution code 입력 후, 검색
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[2]/div/div[2]/div").click()
                driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > div > input[type=text]").send_keys(inst_name)
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[2]/div/div[2]/div/div/div/input").send_keys(Keys.RETURN)
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[2]/div/div[5]/button").click()
                time.sleep(0.5)
                del driver.requests
                
                # Showing entries 100으로 변경
                select = Select(driver.find_element(By.CSS_SELECTOR,"#download-list_length > label > select"))                
                select.select_by_value("100")

                # Download control의 Reporter list 저장
                request = driver.wait_for_request('.*/GetDownloadControlList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]
                dc_reporter_list = []

                # 선택한 Institution의 Reporter key 저장
                for i in data:
                    dc_reporter_list.append(i['UserKey'])

                # Hospital list에서의 reporter가 download control에서 해당 institution의 reporter인지 확인
                for i in reporter_list:
                        if int(i) not in dc_reporter_list:
                            result = "false"
                        else:
                            result = "true"

                try:
                    assert result == "true"
                except:
                    testResult = 'failed'
                    reason.append("2 steps failed")
                
                # Refer 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
                n = n + 1
        
        # 3 steps start! : 병원 리스트 > Reporter 클릭 시, 표시되는 modality job count가 job list와 일치하는지 확인
        # Hospital list 저장
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        hospital_cnt = len(data)

        if hospital_cnt > 0:
            n = 0

            while n < hospital_cnt:
                # Hospital list 저장 및 병원 순서대로 클릭
                hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                hospital_list[n].click()

                # 선택한 병원의 Reporter list 저장 및 인원 수 확인
                temp = driver.find_elements(By.CLASS_NAME, "list-report-id")            
                temp_cnt = len(temp)
                m = 0
                
                # 병원 탭에 표시되는 Reporter의 modality list와 클릭시 표시되는 job list의 modality list 비교
                while m < temp_cnt:
                    sub_modal_list = []
                    
                    # 병원 탭 > 선택한 Reporter key 저장
                    time.sleep(2)
                    temp_reporter_key = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
                    reporter_key = (temp_reporter_key[m].get_property("dataset"))["reporterKey"]
                    
                    # 병원 탭 > Reporter 클릭
                    temp = driver.find_elements(By.CLASS_NAME, "list-report-id")
                    driver.execute_script("arguments[0].click()",temp[m])
                    
                    # 병원 탭 > 선택한 Reporter의 modality 저장
                    modality_list = driver.find_elements(By.CLASS_NAME, "list-modality-info")
                    for i in modality_list:
                        sub_modal_list.append(i.get_property("outerText").split('\n')[0])
                    
                    # 병원 탭 > 선택한 Reporter의 Job list 저장
                    request = driver.wait_for_request('.*/GetReferedListByReporter.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    temp_job_modality_list = []
                    job_modality_list = []

                    for i in data:
                        job_modality_list.append(i["Modality"])

                    # 판독의 탭 클릭
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[1]/ul/li[2]/a").click()

                    # 판독의 탭 > 선택한 Reporter 클릭
                    time.sleep(1)
                    del driver.requests
                    driver.find_element(By.CSS_SELECTOR, "#list-reporter-row-"+reporter_key).click()

                    # 판독의 탭 > 선택한 Reporter의 Job list에서 modality 저장                
                    request = driver.wait_for_request('.*/GetAllReferedListByReporter.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    
                    for i in data:
                        temp_job_modality_list.append(i["Modality"])

                    # 판독의 탭 > Modality list에서 중복 제거                    
                    for i in temp_job_modality_list:
                        if i not in job_modality_list:
                            job_modality_list.append(i)

                    # 병원 탭 > Reporter의 Modality와 판독의 탭 > Reporter Job list의 Modality 비교
                    try:
                        assert sub_modal_list.sort() == job_modality_list.sort()
                    except:
                        testResult = 'failed'
                        reason.append("3 steps failed")

                    # 병원탭 클릭
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[1]/ul/li[1]/a").click()
                    m = m + 1
                n = n + 1
                
                # Refer 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
                
        # 4 steps start! : View All Institution List 체크 시, 표시되는 병원이 올바른 것인지 확인
        # Subadmin 계정으로 로그인
        signInOut.admin_sign_out()
        signInOut.subadmin_sign_in()
        
        # View All Instituion List 체크
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[2]/label/span").click()

        # All Hospital list 저장
        time.sleep(1)
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        All_institution_list = []

        for i in data:
            All_institution_list.append(i["InstitutionCode"])

        # Configuration 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]").click()

        # Institutions 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/button[4]").click()

        # Institution list 저장
        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        institutions_list = []
        
        for i in data:
            institutions_list.append(i["InstitutionCode"])

        # Hospital list와 Institution list 비교
        try:
            assert All_institution_list.sort() == institutions_list.sort()
        except:
            testResult = 'failed'
            reason.append("4 steps failed")
        
        # 5 steps start! : View All Institution List 언체크 시, 표시되는 병원이 올바른 것인지 확인
        # Refer 탭 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        
        # # View All Instituion List 체크
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[2]/label/span").click()

        # View All Institution list에서 Job이 있는 Institution list만 저장
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        all_institution_list = []

        for i in data:
            if i["JobCount"] > 0 or i["PriorityCount"] > 0 or i["ReferCount"] > 0:
                all_institution_list.append(i["InstitutionCode"])

        # View All Instituion List 언체크
        del driver.requests        
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[2]/label/span").click()
        
        # View All Institution list 언체크 시의 Hospital list 저장
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        Job_institution_list = []

        for i in data:
            Job_institution_list.append(i["InstitutionCode"])

        # Job이 있는 hospital 만 list에 표시되는지 확인
        try:
            assert all_institution_list == Job_institution_list
        except:
            testResult = 'failed'
            reason.append("5 steps failed")

        # 6 steps start! : 선택한 병원의 job만 job list에 표시되는지 확인        
        # Hospital list 저장
        click_hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        hospital_cnt = len(data)
        hospital_list = []

        for i in data:
            if i["InstitutionName"] not in hospital_list:
                hospital_list.append(i["InstitutionName"])
        
        if hospital_cnt > 0:
            n = 0
            
            while n < hospital_cnt:
                # 순서대로 병원 클릭
                time.sleep(1)
                del driver.requests
                click_hospital_list[n].click()

                # All Assigned List 탭 > 선택한 병원의 job list 저장
                request = driver.wait_for_request('.*/GetAllAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]
                job_list = []

                for i in data:
                    if i["InstitutionName"] not in job_list:
                        job_list.append(i["InstitutionName"])

                # Not Assigned List 탭 클릭
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()
                
                # Not Assigned List 탭 > 선택한 병원의 job list 저장
                time.sleep(1)
                request = driver.wait_for_request('.*/GetNotAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for i in data:
                    if i["InstitutionName"] not in job_list:
                        job_list.append(i["InstitutionName"])

                # job list에 선택한 병원의 job만 표시되는지 확인
                try:
                    check_job_list = ' '.join(s for s in job_list)
                    assert hospital_list[n] == check_job_list                    
                except:
                    testResult = 'failed'
                    reason.append("6 steps failed")
                n = n + 1
            
                # All Assigned List 탭 클릭
                driver.find_element(By.XPATH,"/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]/a").click()

        # Admin 계정으로 로그인
        signInOut.subadmin_sign_out()
        signInOut.admin_sign_in()        

        # 7 steps start! : 선택한 병원의 badge count와 job list의 count가 일치하는지 확인
        # Hospital list 저장
        click_hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        hospital_cnt = len(data)
        
        if hospital_cnt > 0:
            n = 0
            reporter_list = []
            
            while n < hospital_cnt:
                # 순서대로 병원 클릭
                time.sleep(1)
                del driver.requests
                click_hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                click_hospital_list[n].click()
                m = 0

                # 선택한 병원의 Reporter list 저장
                time.sleep(2)
                reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
                time.sleep(0.5)
                reporter_list_cnt = len(reporter_list)
                
                # Reporter의 badge count 저장
                request = driver.wait_for_request('.*/GetReporterListByInstitution.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)
                badge_cnt_list = []
                job_cnt = []

                for i in data:
                    badge_counts = []
                    badge_counts.append(i["PriorityCount"])
                    badge_counts.append(i["ReferCount"])
                    badge_counts.append(i["OtherInstitutionReferCount"])
                    # badge_counts.append(i["ReportedCount"])
                    badge_counts.append(i["ScheduleCount"])
                    badge_cnt_list.append(badge_counts)

                # 순서대로 Reporter 클릭 후, job list에서 emergency, refer, scheduled count 저장
                while m < reporter_list_cnt:
                    reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
                    reporter_key = (reporter_list[m].get_property("dataset"))["reporterKey"]
                    driver.execute_script("arguments[0].click()",reporter_list[m])

                    # All Assigned 탭 > job list에서 선택한 Reporter의 emergency, refer, scheduled count 저장
                    request = driver.wait_for_request('.*/GetReferedListByReporter.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    emergency_cnt = 0
                    refer_cnt = 0
                    scheduled_cnt = 0
                    other_refer_cnt = 0
                    # reported_cnt = 0

                    for i in data:
                        # Emergency count 계산
                        if i["JobPriority"] == "E":
                            emergency_cnt = emergency_cnt + 1
                        refer_cnt = refer_cnt + 1
                        if i["ScheduleDate"] != None:
                            scheduled_cnt = scheduled_cnt + 1
                        
                    # 판독의 탭 클릭
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[1]/ul/li[2]/a").click()

                    # 판독의 탭 > 선택한 Reporter 클릭
                    time.sleep(2)
                    del driver.requests
                    driver.find_element(By.CSS_SELECTOR, "#list-reporter-row-"+reporter_key).click()

                    # Other refer count 저장
                    request = driver.wait_for_request('.*/GetInstitutionListByReporter.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)

                    for i in data:
                        if i["InstitutionName"] != click_hospital_list[n].get_property("dataset")["institutionName"]:
                            other_refer_cnt = other_refer_cnt + int(i["ReferCount"])
                    job_sub_cnt = []
                    job_sub_cnt.append(emergency_cnt)
                    job_sub_cnt.append(refer_cnt)
                    job_sub_cnt.append(other_refer_cnt)
                    job_sub_cnt.append(scheduled_cnt)
                    job_cnt.append(job_sub_cnt)
                    m = m + 1

                    # Refer 탭 클릭
                    time.sleep(1)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

                    # 병원 선택
                    time.sleep(2)
                    click_hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                    click_hospital_list[n].click()

                # Reporter badge count와 job list count 확인
                try:
                    assert badge_cnt_list == job_cnt                    
                except:
                    testResult = 'failed'
                    reason.append("7 steps failed")
                n = n + 1

                # Refer 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 8 steps start! : 선택한 Reporter의 Job list가 표시되는지 확인
        # Hospital list 저장
        click_hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        hospital_cnt = len(data)
        
        if hospital_cnt > 0:
            n = 0
            
            while n < hospital_cnt:
                # 순서대로 병원 클릭
                time.sleep(1)
                del driver.requests
                click_hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                click_hospital_list[n].click()
                m = 0

                # 선택한 병원의 Reporter list 저장
                time.sleep(2)
                reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
                reporter_list_cnt = len(reporter_list)

                # 순서대로 Reporter 클릭
                while m < reporter_list_cnt:
                    time.sleep(1)
                    del driver.requests                    
                    reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
                    reporter_key = (reporter_list[m].get_property("dataset"))["reporterKey"]
                    driver.execute_script("arguments[0].click()",reporter_list[m])

                    # 선택한 Reporter의 Job list 저장
                    request = driver.wait_for_request('.*/GetReferedListByReporter.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    job_reporter_key = []

                    for i in data:
                        if i["REFERRED_USER_KEYS"] not in job_reporter_key:
                            job_reporter_key.append(i["REFERRED_USER_KEYS"])
                    job_reporter_key = ' '.join(s for s in job_reporter_key)

                    # 선택한 Reporter의 Job list가 표시되는지 확인
                    try:
                        assert reporter_key == job_reporter_key 
                    except:
                        testResult = 'failed'
                        reason.append("8 steps failed")
                    m = m + 1

                # Refer 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
                n = n + 1

        # Hospital_List 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1567, testPlanID, buildName, 'f', result)            
        else:
            testlink.reportTCResult(1567, testPlanID, buildName, 'p', "Hospital_List Test Passed")  

    def Reporter_List():
        print("ITR-8: Refer > Reporter List")
        testResult = ''
        reason = list()        

        # 1 & 2 steps start! : 판독의 탭 > 판독의 리스트에 표시되는 badge count가 job list와 일치하는지 확인
        # Reporter list를 저장한다.
        driver.find_element(By.XPATH, "//*[@id='tab-reporter']").click()
        request = driver.wait_for_request('.*/GetReferCountsByReporter.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        reporter_cnt = len(data)

        reporter_list = []
        for i in data:
            reporter_list.append(i["ReporterKey"])

        del driver.requests
        time.sleep(1)

        # 판독의 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[1]/ul/li[2]").click()
        driver.wait_for_request('.*/GetReferCountsByReporter')
        time.sleep(0.3)
        
        # 각 reporter의 refer, emergency, schedule job의 건수를 비교한다.
        if reporter_cnt > 0:
            n = 0
            for i in data:                
                proirity_cnt = i['PriorityCount']
                refer_cnt = i['ReferCount']
                schedule_cnt = i['ScheduleCount']
                
                # Tap panel의 refer count와 조회 결과 리스트에서의 refer count를 비교한다.
                del driver.requests
                driver.find_element(By.CSS_SELECTOR, "#list-reporter-row-"+str(reporter_list[n])).click()
                time.sleep(1.5)                
                if refer_cnt > 0:
                    temp_cnt = driver.find_element(By.XPATH,'/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]').text
                    temp_cnt = temp_cnt.split()
                    list_cnt = temp_cnt[5]
                    try:
                        assert int(refer_cnt) == int(list_cnt)
                    except:
                        testResult = 'failed'
                        reason.append("1 steps failed: refer_cnt isn't valid")
                
                # Tap panel의 emergency job count와 조회 결과 리스트에서의 emergency job count를 비교한다.   
                if proirity_cnt > 0:
                    driver.find_element(By.CSS_SELECTOR, "#refer_search_priority_chosen span").click()
                    driver.find_element(By.CSS_SELECTOR, ".active-result:nth-child(2)").click()
                    driver.find_element(By.XPATH,'/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]').click()
                    time.sleep(1.5) 
                    temp_cnt = driver.find_element(By.XPATH,'/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]').text                                   
                    temp_cnt = temp_cnt.split()
                    list_cnt = temp_cnt[5]
                    try:
                        assert int(proirity_cnt) == int(list_cnt)                        
                    except:
                        testResult = 'failed'
                        reason.append("1 steps failed: proirity_cnt isn't valid")

                # Tap panel의 schedule job count와 조회 결과 리스트에서의 schedule job count를 비교한다.   
                if schedule_cnt > 0:
                    request = driver.wait_for_request('.*/GetAllReferedListByReporter.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    temp_cnt = 0                    
                    for i in data:              
                        if i['ScheduleDate'] != None:
                            temp_cnt = temp_cnt + 1
                    try:
                        assert int(schedule_cnt) == int(temp_cnt)                        
                    except:
                        testResult = "failed"
                        reason.append("1 & 2 steps failed: schedule_cnt isn't valid")
                        
                n = n + 1

                # 판독의 탭 > Search filter > Priority를 Priority로 선택
                priority = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[1]/div/a/span").get_property("textContent")
                if priority == "응급":
                    driver.find_element(By.CSS_SELECTOR, "#refer_search_priority_chosen span").click()
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[1]/div/div/ul/li[1]").click()

        # 3 steps start! : 판독의 탭 > Reporter를 클릭했을 때, 표시되는 병원 리스트와 병원 선택 시, 해당 병원의 job list가 표시되는지 확인
        # 판독의 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[1]/ul/li[2]/a").click()

        # Repoter list 저장
        request = driver.wait_for_request('.*/GetReferCountsByReporter.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        reporter_key_list = []

        for i in data:
            reporter_key_list.append(i["ReporterKey"])
        
        # 순서대로 Reporter를 선택
        for reporter_key in reporter_key_list:
            time.sleep(1)
            del driver.requests
            driver.find_element(By.CSS_SELECTOR, "#list-reporter-row-" + reporter_key).click()
            
            # 선택한 Reporter의 Institution list 저장
            request = driver.wait_for_request('.*/GetInstitutionListByReporter.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            intitution_code_list = []
            
            for i in data:
                intitution_code_list.append(i["InstitutionCode"])

            # 선택한 Reporter의 institution 개수 확인
            intitution_code_cnt = len(intitution_code_list)
            m = 0 
            
            # 선택한 Reporter의 institution을 순서대로 클릭
            job_list = []
            while m < intitution_code_cnt:
                time.sleep(1)
                del driver.requests
                click = driver.find_element(By.CSS_SELECTOR, ".list-group-item.list-sub-item[data-institution-code='" + intitution_code_list[m] + "']")
                driver.execute_script("arguments[0].click()",click)

                # 선택한 institution의 job list 저장
                request = driver.wait_for_request('.*/GetReferedListByReporter.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]
            
                for i in data:
                    if i["InstitutionCode"] not in job_list:
                        job_list.append(i["InstitutionCode"])
                m = m + 1

            # 선택한 Reporter의 institution과 job list 데이터의 institution이 동일한지 확인
            try:
                assert intitution_code_list == job_list
            except:
                testResult = "failed"
                reason.append("3 steps failed")

            # 판독의 탭 클릭
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[1]/ul/li[2]/a").click()

        # Reporter_List 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1577, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1577, testPlanID, buildName, 'p', "Reporter List Passed")
    
class Search_filter:
    def Priority():
        print("ITR-9: Search Filter > Priority")
        testResult = ''
        reason = list()

        # 1 steps start! : Priority 조건을 응급으로 선택한 후, Search 버튼 클릭
        # 새로고침
        driver.refresh()
        # Refer 탭 클릭
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Hospital list 저장
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        hospital_cnt = len(hospital_list)

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # 순서대로 Hospital 선택
        if hospital_cnt > 0:
            n = 0

            while n < hospital_cnt:
                # Hospital list 저장 및 병원 순서대로 클릭
                hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                time.sleep(1)
                hospital_list[n].click()
        
                # 병원 선택 > All Assigned List > Priority 드랍박스에서 응급을 선택 후, Search 버튼 클릭
                time.sleep(1)
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[1]/div").click()                
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[1]/div/div/ul/li[2]").click()
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

                # 병원 선택 > All Assigned List > Job list 저장
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/GetAllAssignedList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    job_priority = []

                    for i in data:
                        if i["JobPriority"] not in job_priority:
                            job_priority.append(i["JobPriority"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1  

                # Not Assigned List 탭 클릭
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()
                
                # 병원 선택 > Not Assigned List > Job list 저장
                time.sleep(1)
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/GetNotAssignedList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for i in data:
                        if i["JobPriority"] not in job_priority:
                            job_priority.append(i["JobPriority"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1  

                # 병원 선택 > Job list에서 응급만 표시되는지 확인
                try:
                    job_priority = ' '.join(s for s in job_priority)
                    assert job_priority == "E"
                except:
                    testResult = "failed"
                    reason.append("1 steps failed")
                n = n + 1
                # All Assigned List 탭 클릭
                time.sleep(1)
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        # 2 steps start! : Priority 조건을 일반으로 선택한 후, Search 버튼 클릭
        # Refer 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Hospital list 저장
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        hospital_cnt = len(hospital_list)

        # 순서대로 Hospital 선택
        if hospital_cnt > 0:
            n = 0

            while n < hospital_cnt:
                # Hospital list 저장 및 병원 순서대로 클릭
                click = hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                # hospital_list[n].click()
                driver.execute_script("arguments[0].click()",click[n])

                # 병원 선택 > All Assigned List > Priority 드랍박스에서 일반 선택 후, Search 버튼 클릭
                time.sleep(1)
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[1]/div").click()                
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[1]/div/div/ul/li[3]").click()
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

                # 병원 선택 > All Assigned List > Job list 저장
                request = driver.wait_for_request('.*/GetAllAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]
                job_priority = []

                for i in data:
                    if i["JobPriority"] not in job_priority:
                        job_priority.append(i["JobPriority"])
                
                # Not Assigned List 탭 클릭
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

                # 병원 선택 > Not Assigned List > Job list 저장
                time.sleep(1)
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/GetNotAssignedList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for i in data:
                        if i["JobPriority"] not in job_priority:
                            job_priority.append(i["JobPriority"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1  
                
                # 병원 선택 > Job list에서 응급만 표시되는지 확인
                try:
                    job_priority = ' '.join(s for s in job_priority)
                    assert job_priority == "N"
                except:
                    testResult = "failed"
                    reason.append("2 steps failed")
                n = n + 1
                # All Assigned List 탭 클릭
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        # Priority 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1583, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1583, testPlanID, buildName, 'p', "Priority Passed")

    def Job_Status():
        print("ITR-10: Search Filter > Job Status")
        testResult = ''
        reason = list()

        # 1 steps start! : Job Status를 Requested로 선택한 후, Search All버튼을 클릭한다.
        # 새로고침
        driver.refresh()
        # All List 탭 클릭
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        driver.wait_for_request('.*/GetAllAssignedList.*')
        time.sleep(0.3)

        # All List > Job Status를 Requested로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        time.sleep(1)

        # All List 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()
        driver.wait_for_request('.*/GetAllList.*')
        time.sleep(0.3)

        del driver.requests
        time.sleep(1)

        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[2]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1  

        # Job Status가 Requested 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Requested" or job_status == ''
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Job Status를 Reported로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 Reported로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        driver.refresh()
        # All List 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/a").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[3]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 Reported 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Reported" or job_status == ''
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Job Status를 Pending으로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 Pending로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[4]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 Pending 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Pending" or job_status == ''
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : Job Status를 Completed로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 Completed로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[5]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 Completed 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Completed" or job_status == ''
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # 5 steps start! : Job Status를 Recalled로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 Recalled로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[6]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        # pages = Common.cnt_pages()
        # while pages > 0:
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_status = []

        for i in data:
            if i["StatDescription"] not in job_status:
                job_status.append(i["StatDescription"])
        
        # Next 클릭
        if len(data) == 100:
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            # pages = pages - 1

        # Job Status가 Recalled 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Recalled" or job_status == ''
        except:
            testResult = "failed"
            reason.append("5 steps failed\n")

        # 6 steps start! : Job Status를 Canceled로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 Canceled로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[7]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        time.sleep(1)
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 Canceled 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Canceled" or job_status == ''
        except:
            testResult = "failed"
            reason.append("6 steps failed\n")

        # 7 steps start! : Job Status를 Canceled2로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를  Canceled2로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[8]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 Canceled2 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Canceled2" or job_status == ''
        except:
            testResult = "failed"
            reason.append("7 steps failed\n")

        # 8 steps start! : Job Status를 Returned로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 Returned로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[9]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        time.sleep(1)
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 Returned 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Returned" or job_status == ''
        except:
            testResult = "failed"
            reason.append("8 steps failed\n")

        # 9 steps start! : Job Status를 Failed Download Report로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 Failed Download Report로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[10]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 Failed Download Report 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "Failed Download Report" or job_status == ''
        except:
            testResult = "failed"
            reason.append("9 steps failed\n")

        # 10 steps start! : Job Status를 AI Processing으로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 AI Processing로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[11]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 AI Processing 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "AI Processing" or job_status == ''
        except:
            testResult = "failed"
            reason.append("10 steps failed\n")

        # 11 steps start! : Job Status를 DiscardRequest로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 DiscardRequest로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[12]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 DiscardRequest 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "DiscardRequest" or job_status == ''
        except:
            testResult = "failed"
            reason.append("11 steps failed\n")

        # 12 steps start! : Job Status를 DiscardCompleted로 선택한 후, Search All버튼을 클릭한다.
        # All List > Job Status를 DiscardCompleted로 변경하고, Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[13]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # All List > Job list의 Job Status 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            job_status = []

            for i in data:
                if i["StatDescription"] not in job_status:
                    job_status.append(i["StatDescription"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # Job Status가 DiscardCompleted 만 조회되었는지 확인
        try:
            job_status = ' '.join(s for s in job_status)
            assert job_status == "DiscardCompleted" or job_status == ''
        except:
            testResult = "failed"
            reason.append("12 steps failed\n")

        # Priority 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1588, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1588, testPlanID, buildName, 'p', "Job Status Passed")
    
    def Date():
        print("ITR-11: Search Filter > Job Date")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Date를 Job Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 2 steps start! : Date를 Study Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 3 steps start! : Date를 Schedule Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # Test 병원을 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # date_type에 job date, study date, schedule date 주소를 리스트로 선언
        date_type = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[3]/div/div/ul/li[1]','JobDTTMString'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[3]/div/div/ul/li[2]','StudyDTTMString'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[3]/div/div/ul/li[3]','ScheduleDateDTTMString']]

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # Date를 Job Date, Study Date, Schedule Date 순서대로 조회 시, All/Not Assigned List 탭의 데이터가 올바르게 조회되는지 확인
        for j in range(0,3):
            # All Assigned List 탭 클릭
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

            # Date를 Job Date로 선택
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[3]/div").click()
            driver.find_element(By.XPATH, date_type[j][0]).click()

            # Start Date를 Yesterday로 선택
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
            driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(1) > th:nth-child(1)").click()

            # Search 버튼 클릭
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

            # All Assigned List > Job list의 결과 저장
            pages = Common.cnt_pages()
            job_date = []
            while pages > 0:
                time.sleep(1)
                request = driver.wait_for_request('.*/GetAllAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                if data != '':
                    for i in data:
                        temp_job_date = i[date_type[j][1]]
                        if temp_job_date.split()[0] not in job_date:
                            job_date.append(temp_job_date.split()[0])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1
            
            # All Assigned List > Job list의 결과가 Yesterday 인지 확인
            try:
                for i in job_date:
                    assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or job_date == ''
            except:
                testResult = "failed"
                reason.append(j +" steps failed\n")

            # All Assigned List > Job Date를 Today로 선택
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
            driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(1) > th:nth-child(2)").click()

            # Search 버튼 클릭
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

            # Showing entries 100으로 변경
            Common.refer_show_entries(100)

            # All Assigned List > Job list의 결과 저장
            pages = Common.cnt_pages()
            job_date = []
            while pages > 0:
                time.sleep(1)
                request = driver.wait_for_request('.*/GetAllAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                if data != '':
                    for i in data:
                        temp_job_date = i[date_type[j][1]]
                        if temp_job_date.split()[0] not in job_date:
                            job_date.append(temp_job_date.split()[0])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1

            # All Assigned List > Job list의 결과가 Today 인지 확인
            try:
                job_date = ' '.join(s for s in job_date)
                assert job_date == str(today.strftime('%Y-%m-%d')) or job_date == ''
            except:
                testResult = "failed"
                reason.append(j +" steps failed\n")

            # All Assigned List > Job Date를 last 1~4 week으로 선택
            for n in range(2,7):
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
                driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(2) > th:nth-child("+str(n)+")").click()

                # Search 버튼 클릭
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                
                # Showing entries 100으로 변경
                Common.refer_show_entries(100)
                
                # All Assigned List > Job list의 결과 저장
                pages = Common.cnt_pages()
                job_date = []
                while pages > 0:
                    time.sleep(1)
                    request = driver.wait_for_request('.*/GetAllAssignedList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    if data != '':
                        for i in data:
                            temp_job_date = i[date_type[j][1]]
                            if temp_job_date.split()[0] not in job_date:
                                job_date.append(temp_job_date.split()[0])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

                # All Assigned List > Job list의 결과가 last 1~5week 인지 확인
                try:
                    for i in job_date:
                        assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or int(str(((today - timedelta(weeks=(n-1))) - datetime.strptime(i, '%Y-%m-%d'))).split()[0]) <= 0
                except:
                    testResult = "failed"
                    reason.append(j +" steps failed\n")

            # All Assigned List > Job Date를 last 1~12 month으로 선택
            m = 0
            for n in range(2,7):
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
                driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(3) > th:nth-child("+str(n)+")").click()

                # Search 버튼 클릭
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

                # Showing entries 100으로 변경
                Common.refer_show_entries(100)
            
                # All Assigned List > Job list의 결과 저장
                pages = Common.cnt_pages()
                job_date = []

                while pages > 0:
                    request = driver.wait_for_request('.*/GetAllAssignedList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    if data != '':
                        for i in data:
                            temp_job_date = i[date_type[j][1]]
                            if temp_job_date.split()[0] not in job_date:
                                job_date.append(temp_job_date.split()[0])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

                # All Assigned List > Job list의 결과가 last 1~12 month 인지 확인
                try:
                    for i in job_date:
                        if n == 2:
                            assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or int(str((today - relativedelta(months=1)) - datetime.strptime(i, '%Y-%m-%d')).split()[0]) <= 0
                        else:
                            assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or int(str(((today - relativedelta(months=(3*m))) - datetime.strptime(i, '%Y-%m-%d'))).split()[0]) <= 0
                            
                except:
                    testResult = "failed"
                    reason.append(j +" steps failed\n")
                m = m + 1

            # Not Assigned List 탭 클릭
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

            # Date를 Job Date로 선택
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[3]/div").click()
            driver.find_element(By.XPATH, date_type[j][0]).click()

            # Start Date를 Yesterday로 선택
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
            driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(1) > th:nth-child(1)").click()

            # Search 버튼 클릭
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

            # Showing entries 100으로 변경
            Common.refer_show_entries(100)

            # Not Assigned List > Job list의 결과 저장
            pages = Common.cnt_pages()
            job_date = []

            while pages > 0:
                time.sleep(1)
                request = driver.wait_for_request('.*/GetNotAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                if data != '':
                    for i in data:
                        temp_job_date = i[date_type[j][1]]
                        if temp_job_date.split()[0] not in job_date:
                            job_date.append(temp_job_date.split()[0])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1
            
            # Not Assigned List > Job list의 결과가 Yesterday 인지 확인
            try:
                for i in job_date:
                    assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or job_date == ''
            except:
                testResult = "failed"
                reason.append(j +" steps failed\n")

            # Not Assigned List > Job Date를 Today로 선택
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
            driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(1) > th:nth-child(2)").click()

            # Search 버튼 클릭
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

            # Showing entries 100으로 변경
            Common.refer_show_entries(100)

            # Not Assigned List > Job list의 결과 저장
            pages = Common.cnt_pages()
            job_date = []

            while pages > 0:
                time.sleep(1)
                request = driver.wait_for_request('.*/GetNotAssignedList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                if data != '':
                    for i in data:
                        temp_job_date = i[date_type[j][1]]
                        if temp_job_date.split()[0] not in job_date:
                            job_date.append(temp_job_date.split()[0])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1

            # Not Assigned List > Job list의 결과가 Today 인지 확인
            try:
                job_date = ' '.join(s for s in job_date)
                assert job_date == str(today.strftime('%Y-%m-%d')) or job_date == ''
            except:
                testResult = "failed"
                reason.append(j +" steps failed\n")

            # Not Assigned List > Job Date를 last 1~4 week으로 선택
            for n in range(2,7):
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
                driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(2) > th:nth-child("+str(n)+")").click()

                # Search 버튼 클릭
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

                # Showing entries 100으로 변경
                Common.refer_show_entries(100)
                
                # Not Assigned List > Job list의 결과 저장
                pages = Common.cnt_pages()
                job_date = []

                while pages > 0:
                    time.sleep(1)
                    request = driver.wait_for_request('.*/GetNotAssignedList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    if data != '':
                        for i in data:
                            temp_job_date = i[date_type[j][1]]
                            if temp_job_date.split()[0] not in job_date:
                                job_date.append(temp_job_date.split()[0])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

                # All Assigned List > Job list의 결과가 last 1~5week 인지 확인
                try:
                    for i in job_date:
                        assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or int(str(((today - timedelta(weeks=(n-1))) - datetime.strptime(i, '%Y-%m-%d'))).split()[0]) <= 0
                except:
                    testResult = "failed"
                    reason.append(j +" steps failed\n")

            # Not Assigned List > Job Date를 last 1~12 month으로 선택
            m = 0
            for n in range(2,7):
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").click()
                driver.find_element(By.CSS_SELECTOR, "body > div.datepicker.datepicker-dropdown.dropdown-menu.datepicker-orient-left.datepicker-orient-bottom > div.datepicker-days > table > tfoot > tr:nth-child(3) > th:nth-child("+str(n)+")").click()

                # Search 버튼 클릭
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

                # Showing entries 100으로 변경
                Common.refer_show_entries(100)
            
                # Not Assigned List > Job list의 결과 저장
                pages = Common.cnt_pages()
                job_date = []

                while pages > 0:
                    request = driver.wait_for_request('.*/GetNotAssignedList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    if data != '':
                        for i in data:
                            temp_job_date = i[date_type[j][1]]
                            if temp_job_date.split()[0] not in job_date:
                                job_date.append(temp_job_date.split()[0])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

                # Not Assigned List > Job list의 결과가 last 1~12 month 인지 확인
                try:
                    for i in job_date:
                        if n == 2:
                            assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or int(str((today - relativedelta(months=1)) - datetime.strptime(i, '%Y-%m-%d')).split()[0]) <= 0
                        else:
                            assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or int(str(((today - relativedelta(months=(3*m))) - datetime.strptime(i, '%Y-%m-%d'))).split()[0]) <= 0
                            
                except:
                    testResult = "failed"
                    reason.append(j +" steps failed\n")
                m = m + 1

        # 4 steps start! : All List 탭을 클릭한 후, Job list의 job date가 최근 1년의 데이터인지 확인한다.
        # All List 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # All List > Date Type의 Job Date 인지 확인
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[3]/div/a").get_property("textContent") != "Job Date":
            testResult = "4 steps failed\n"

        # All List > Date 기간이 오늘날짜부터 과거 1년으로 설정되어 있는지 확인
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[1]/input").get_property("value")
        end_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[4]/div/div[2]/input").get_property("value")
        if (datetime.strptime(start_date, '%Y-%m-%d') - datetime.strptime(end_date, '%Y-%m-%d')).days <= 365:
            testResult = '4 steps failed'
        
        # All List > Job list의 job date를 저장
        pages = Common.cnt_pages()
        job_date = []

        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            if data != '':
                for i in data:
                    temp_job_date = i['JobDTTMString']
                    if temp_job_date.split()[0] not in job_date:
                        job_date.append(temp_job_date.split()[0])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1
            
        # All List > Job list의 Job date가 최근 1년 이내의 job 인지 확인
        try:
            for i in job_date:
                assert int((today - datetime.strptime(i, '%Y-%m-%d')).days) >= 0 or int(str((today - relativedelta(years=1)) - datetime.strptime(i, '%Y-%m-%d')).split()[0]) <= 0
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # Job Date 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1603, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1603, testPlanID, buildName, 'p', "Job Date Passed")

    def Patient_Location():
        print("ITR-12: Search Filter > Patient Location")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Patient Location 조건을 InPatient로 선택한 후, Search 버튼을 클릭한다.
        # 2 steps start! : Patient Location 조건을 OutPatient로 선택한 후, Search 버튼을 클릭한다.
        # 3 steps start! : Patient Location 조건을 Emergency로 선택한 후, Search 버튼을 클릭한다.
        location_type = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[5]/div/div/ul/li[2]','I'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[5]/div/div/ul/li[3]','O'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[5]/div/div/ul/li[4]','E']]

        # All List 탭 클릭
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        for j in range(0,3):
            # Patient Location 버튼 클릭
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[5]/div/a").click()
            
            # Patient Location을 InPatient, OutPatient, Emergency 순서대로 선택
            driver.find_element(By.XPATH,location_type[j][0]).click()
            
            # Showing entries 100으로 변경
            Common.refer_show_entries(100)

            # Search All 버튼 클릭
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

            pages = Common.cnt_pages()
            while pages > 0:
                # All list > Job list에서 Patient Location 저장
                time.sleep(1)
                request = driver.wait_for_request('.*/GetAllList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]
                pat_location = []
            
                for i in data:
                    if i["PatientLocation"] not in pat_location:
                        pat_location.append(i["PatientLocation"])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1
            
            # 선택한 Patient Location과 Job list의 Patient Location이 일치하는지 확인
            try:
                for i in pat_location:
                    assert i == location_type[j][1]
            except:
                testResult = "failed"
                reason.append(j+ " steps failed\n")
        
        # Patient Location 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1608, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1608, testPlanID, buildName, 'p', "Patient Location Passed")

    def Patient_ID():
        print("ITR-13: Search Filter > Patient ID")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        
        # 1 steps start! : 임의의 Patient ID를 입력하고 Search 버튼을 클릭한다.
        # Test 병원을 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 Patient ID를 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]

        pat_id = ''
        while True:
            result_pat_id = []
            for i in range(0,3):
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, tab_list[i][0]).click()
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for j in data:
                        if j["PatientID"] not in result_pat_id:
                            result_pat_id.append(j["PatientID"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

            if pat_id == '':
                # Job list에서 임의의 Patient ID를 선택
                pat_id = random.choice(result_pat_id)

                # Search filter > Patient ID를 입력한 후, Search 버튼 클릭
                if pat_id != None:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[1]/div/div/input").send_keys(pat_id)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                # Patient ID가 모두 Null 인 경우
                else:
                    break
            else:
                break

        # 검색한 Patient ID와 Job list의 결과와 비교
        try:
            if pat_id != None:
                result_pat_id = ' '.join(s for s in result_pat_id)
            assert pat_id == result_pat_id or pat_id == None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : 임의의 Patient ID를 입력하고 Search All 버튼을 클릭한다.
        # Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # Job list의 Patient ID 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            result_pat_id = []

            for j in data:
                if j["PatientID"] not in result_pat_id:
                    result_pat_id.append(j["PatientID"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # 검색한 Patient ID와 Job list의 결과와 비교
        try:
            if pat_id != None:
                result_pat_id = ' '.join(s for s in result_pat_id)
            assert pat_id == result_pat_id or pat_id == None
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # Patient ID 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1615, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1615, testPlanID, buildName, 'p', "Patient ID Passed")

    def Patient_Name():
        print("ITR-14: Search Filter > Patient Name")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        
        # 1 steps start! : 임의의 Patient Name을 입력하고 Search 버튼을 클릭한다.
        # Test 병원을 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 Patient Name을 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]

        pat_name = ''
        while True:
            result_pat_name = []
            for i in range(0,3):
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, tab_list[i][0]).click()
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for j in data:
                        if j["PatientName"] not in result_pat_name:
                            result_pat_name.append(j["PatientName"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

            if pat_name == '':
                # Job list에서 임의의 Patient_Name을 선택
                pat_name = random.choice(result_pat_name)

                # Search filter > Patient_Name을 입력한 후, Search 버튼 클릭
                if pat_name != None:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[2]/div/div/input").send_keys(pat_name)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                # Patient_Name이 모두 Null 인 경우
                else:
                    break
            else:
                break

        # 검색한 Patient Name과 Job list의 결과와 비교
        try:
            if pat_name != None:
                result_pat_name = ' '.join(s for s in result_pat_name)
            assert pat_name == result_pat_name or pat_name == None
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 2 steps start! : 임의의 Patient Name을 입력하고 Search All 버튼을 클릭한다.
        # Search All 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()
        
        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # Job list의 Patient Name 저장
        pages = Common.cnt_pages()
        while pages > 0:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            result_pat_name = []

            for j in data:
                if j["PatientName"] not in result_pat_name:
                    result_pat_name.append(j["PatientName"])
            # Next 클릭
            next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
            if "disabled" not in next_btn.get_attribute("class"):
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
            pages = pages - 1

        # 검색한 Patient ID와 Job list의 결과와 비교
        try:
            if (pat_name) != None:
                result_pat_name = ' '.join(s for s in result_pat_name)
            assert pat_name == result_pat_name or (pat_name) == None
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # Patient Name 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1619, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1619, testPlanID, buildName, 'p', "Patient Name Passed")

    def Age():
        print("ITR-15: Search Filter > Age")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : Age 조건을 Year로 선택하고, 임의의 나이를 입력한 후, Search 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()
        
        # Search Filter > All Age를 Year로 변경
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[3]/div/a").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[3]/div/div/ul/li[2]").click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # Search Filter > end, start age를 랜덤으로 입력 후, Search 버튼 클릭
        start_age = random.randrange(0, 90)
        end_age = random.randrange(start_age, 96)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[4]/input").clear()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[4]/input").send_keys(start_age)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[5]/input").clear()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[5]/input").send_keys(end_age)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 age를 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]

        age = []
        for i in range(0,3):
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, tab_list[i][0]).click()
            pages = Common.cnt_pages()
            while pages > 0:
                request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]            

                for j in data:
                    if j["PatientAge"] not in age:
                        age.append(j["PatientAge"])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1

        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            for i in age:
                assert int(i) >= start_age or int(i) <= end_age
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Age 조건을 Month로 선택하고, 임의의 나이를 입력한 후, Search 버튼을 클릭한다.
        # Search Filter > All Age를 Month로 변경
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[3]/div/a").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[3]/div/div/ul/li[3]").click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # Search Filter > end, start age를 랜덤으로 입력 후, Search 버튼 클릭
        start_age = random.randrange(0, 90)
        end_age = random.randrange(start_age, 96)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[4]/input").clear()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[4]/input").send_keys(start_age*12)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[5]/input").clear()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[5]/input").send_keys(end_age*12)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 age를 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]
        
        age = []
        for i in range(0,3):
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, tab_list[i][0]).click()
            pages = Common.cnt_pages()
            while pages > 0:
                request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for j in data:
                    if j["PatientAge"] not in age:
                        age.append(j["PatientAge"])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1
        
        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            for i in age:
                assert int(i) >= start_age or int(i) <= end_age
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Age 조건을 Day로 선택하고, 임의의 나이를 입력한 후, Search 버튼을 클릭한다.
        # Search Filter > All Age를 Day로 변경
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[3]/div/a").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[3]/div/div/ul/li[4]").click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)

        # end, start age를 랜덤으로 입력 후, Search 버튼 클릭
        start_age = random.randrange(0, 90)
        end_age = random.randrange(start_age, 96)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[4]/input").clear()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[4]/input").send_keys(start_age*365)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[5]/input").clear()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[5]/input").send_keys(end_age*365)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 age를 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]
        
        age = []
        for i in range(0,3):
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, tab_list[i][0]).click()
            pages = Common.cnt_pages()
            while pages > 0:
                request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for j in data:
                    if j["PatientAge"] not in age:
                        age.append(j["PatientAge"])
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1

        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            for i in age:
                assert int(i) >= start_age or int(i) <= end_age
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # Age 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1623, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1623, testPlanID, buildName, 'p', "Age Passed")

    def Study_Description():
        print("ITR-16: Search Filter > Study Description")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : 임의의 Study Description을 입력한 후, Search 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 StudyDescription을 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]
        
        # Test 병원의 Job list에서 Study Description을 추출 후, 임의의 Study Description을 선택해서 검색
        study_desc = ''
        while True:
            result_study_desc = []
            for i in range(0,3):
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, tab_list[i][0]).click()
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for j in data:
                        if j["StudyDesc"] not in result_study_desc:
                            result_study_desc.append(j["StudyDesc"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

            if study_desc == '':
                # Job list에서 임의의 Study Description을 선택
                study_desc = random.choice(result_study_desc)

                # Search filter > Study Description을 입력한 후, Search 버튼 클릭
                if (study_desc) != None:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[1]/div/div/input").send_keys(study_desc)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                # Study Description이 모두 Null 인 경우
                else:
                    break
            else:
                break

        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            if (study_desc) != None:
                result_study_desc = ' '.join(s for s in result_study_desc)
            assert study_desc == result_study_desc or (study_desc) == None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # Study Description 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1629, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1629, testPlanID, buildName, 'p', "Study Description Passed")

    def Modality():
        print("ITR-17: Search Filter > Modality")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : 임의의 Modality를 입력한 후, Search 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 Modality를 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]
        
        modality = ''
        while True:
            result_modality = []
            for i in range(0,3):
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, tab_list[i][0]).click()
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    
                    for j in data:
                        if j["Modality"] not in result_modality:
                            result_modality.append(j["Modality"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1
            
            if modality == '':
                # Job list에서 임의의 Modality를 선택
                modality = random.choice(result_modality)

                # Search filter > Modality를 입력한 후, Search 버튼 클릭
                if (modality) != None:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[2]/div/div/input").send_keys(modality)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                # Modality가 모두 Null 인 경우
                else:
                    break
            else:
                break

        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            if (modality) != None:
                result_modality = ' '.join(s for s in result_modality)
            assert modality == result_modality or (modality) == None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Modality 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1632, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1632, testPlanID, buildName, 'p', "Modality Passed")

    def Bodypart():
        print("ITR-18: Search Filter > Bodypart")
        testResult = ''
        reason = list()
        
        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : 임의의 Bodypart를 입력한 후, Search 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 Bodypart를 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]

        bodypart = ''
        while True:
            result_bodypart = []
            for i in range(0,3):
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, tab_list[i][0]).click()
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for j in data:
                        if j["Bodypart"] not in result_bodypart:
                            result_bodypart.append(j["Bodypart"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1

            if bodypart == '':
                # Job list에서 임의의 Bodypart를 선택
                bodypart = random.choice(result_bodypart)

                # Search filter > Bodypart를 입력한 후, Search 버튼 클릭
                if (bodypart) != None:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[3]/div/div/input").send_keys(bodypart)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                # Bodypart가 모두 Null 인 경우
                else:
                    break
            else:
                break

        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            if (bodypart) != None:
                result_bodypart = ' '.join(s for s in result_bodypart)
            assert bodypart == result_bodypart or (bodypart) == None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Bodypart 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1635, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1635, testPlanID, buildName, 'p', "Bodypart Passed")

    def Department():
        print("ITR-19: Search Filter > Department")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : 임의의 Department를 입력한 후, Search 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 Department를 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]

        department = ''
        while True:
            result_department = []
            for i in range(0,3):
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, tab_list[i][0]).click()
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for j in data:
                        if j["Department"] not in result_department:
                            result_department.append(j["Department"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1      

            if department == '':
                # Job list에서 임의의 Department를 선택
                department = random.choice(result_department)

                # Search filter > Department를 입력한 후, Search 버튼 클릭
                if (department) != None:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[4]/div/div/input").send_keys(department)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                # Department가 모두 Null 인 경우
                else:
                    break
            else:
                break
                
        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            if (department) != None:
                result_department = ' '.join(s for s in result_department)
            assert department == result_department or (department) == None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # Department 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1638, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1638, testPlanID, buildName, 'p', "Department Passed")

    def Request_Name():
        print("ITR-20: Search Filter > Request_Name")
        testResult = ''
        reason = list()
        
        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : 임의의 Request Name을 입력한 후, Search 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 Request Name을 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]
        
        request_name = ''
        while True:
            result_request_name = []
            for i in range(0,3):
                time.sleep(1)
                del driver.requests
                driver.find_element(By.XPATH, tab_list[i][0]).click()
                pages = Common.cnt_pages()
                while pages > 0:
                    request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for j in data:
                        if j["StudyRequestName"] not in result_request_name:
                            result_request_name.append(j["StudyRequestName"])
                    # Next 클릭
                    next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                    if "disabled" not in next_btn.get_attribute("class"):
                        time.sleep(1)
                        driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                    pages = pages - 1    

            if request_name == '':
                # Job list에서 임의의 Request Name을 선택
                request_name = random.choice(result_request_name)

                # Search filter > Request Name을 입력한 후, Search 버튼 클릭
                if (request_name) != None:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[5]/div/div/input").send_keys(request_name)
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
                # Department가 모두 Null 인 경우
                else:
                    break
            else:
                break
            
        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            if (request_name) != None:
                result_request_name = ' '.join(s for s in result_request_name)
            assert request_name == result_request_name or (request_name) == None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Request Name 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1641, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1641, testPlanID, buildName, 'p', "Request Name Passed")

    def Search_All():
        print("ITR-21: Search Filter > Search All")
        testResult = ''
        reason = list()
        
        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        time.sleep(1)

        # 1 steps start! : 임의의 검색조건을 입력한 후, Search All 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Showing entries 100으로 변경
        Common.refer_show_entries(100)
        
        # All Assigned/Not Assigned/All List 탭을 순서대로 클릭하면서 Job list의 해당 조건을 가진 job이 있으면 저장
        tab_list = [['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]','GetAllAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]','GetNotAssignedList'],
        ['/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]','GetAllList']]

        # 검색할 항목을 리스트로 생성
        search_list = [['StudyDesc','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[1]/div/div/input'],
        ['Modality','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[2]/div/div/input'],
        ['Bodypart','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[3]/div/div/input'],
        ['Department','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[4]/div/div/input'],
        ['StudyRequestName','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[5]/div/div/input']]

        # Search list에서 임의의 Search 조건을 2개 선택
        search_item_1 = ''; search_item_2 = ''
        search_sample_1 = []; search_sample_2 = []; result_sample = []
        search_sample_list = random.sample(search_list, 2)
        
        # 아무런 조건없이 All Assigned/Not Assigned/All List 탭을 이동하면서 조건에 맞는 job list 저장
        for i in range(0,3):
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, tab_list[i][0]).click()
            pages = Common.cnt_pages()
            while pages > 0:
                request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for j in data:
                    if j[search_sample_list[0][0]] not in search_sample_1 and j[search_sample_list[0][0]] != None:
                        search_sample_1.append(j[search_sample_list[0][0]])
          
                # Next 클릭
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1
                
        # 저장된 job list에서 첫 번째 Search 조건에 해당하는 임의의 값을 선택
        search_item_1 = random.choice(search_sample_1)

        # Search filter > 임의의 Search condition에 첫 번째 Search 값을 입력한 후, Search All 버튼 클릭
        if (search_item_1) != None:
            driver.find_element(By.XPATH, search_sample_list[0][1]).send_keys(search_item_1)
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # 첫 번째 Search 조건에 해당하는 job list 저장
        for i in range(0,3):
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, tab_list[i][0]).click()
            pages = Common.cnt_pages()
            while pages > 0:
                request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for j in data:
                    if j[search_sample_list[1][0]] not in search_sample_2 and j[search_sample_list[1][0]] != None:
                        search_sample_2.append(j[search_sample_list[1][0]])

                # Next 클릭
                time.sleep(1)
                next_btn = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next")
                if "disabled" not in next_btn.get_attribute("class"):
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()
                pages = pages - 1
        
        # 조회 결과에서 두 번째 Search 조건에 해당하는 임의의 값을 선택
        search_item_2 = random.choice(search_sample_2)

        # Search filter > 임의의 Search condition에 두 번째 Search 값을 입력한 후, Search All 버튼 클릭
        if (search_item_2) != None:
            driver.find_element(By.XPATH, search_sample_list[1][1]).send_keys(search_item_2)
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[6]/button").click()

        # 첫 번째, 두 번째 Search 조건에 해당하는 job list 저장
        temp_search_1 = []
        temp_search_2 = []
        result_list = []
        for i in range(0,3):
            time.sleep(1)
            del driver.requests
            driver.find_element(By.XPATH, tab_list[i][0]).click()
            pages = Common.cnt_pages()
            while pages > 0:
                request = driver.wait_for_request('.*/'+tab_list[i][1]+'.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for j in data:
                    if j[search_sample_list[0][0]] not in temp_search_1 and j[search_sample_list[0][0]] != None:
                        temp_search_1.append(j[search_sample_list[0][0]])
                        result_list.append(temp_search_1)
                    if j[search_sample_list[1][0]] not in temp_search_2 and j[search_sample_list[1][0]] != None:
                        temp_search_2.append(j[search_sample_list[1][0]])
                        result_list.append(temp_search_2)
                pages = pages - 1
                          
        # 검색 조건과 Job list 결과가 일치하는지 확인
        try:
            result_list_1 = ' '.join(s for s in result_list[0])
            result_list_2 = ' '.join(s for s in result_list[1])
            assert (search_item_1, search_item_2) == (result_list_1, result_list_2)
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Search All 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1644, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1644, testPlanID, buildName, 'p', "Search All Passed")

    def RealTime():
        print("ITR-22: Search Filter > Real Time")
        testResult = ''
        reason = list()
        
        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : Real Time 토글 버튼을 On으로 변경한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # All List 탭으로 이동
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Show entries를 50개로 변경
        time.sleep(1)
        del driver.requests
        Common.refer_show_entries(50)

        # Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        # Ream Time 토글을 On으로 변경
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[2]/div/div[2]/label/span").click()
        status = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[2]/div/div[2]/label/input").get_property("checked")

        # 35초 대기(자동 새로고침 시간: 30초) 및 기존 데이터 삭제
        time.sleep(35)
        del driver.requests

        # Show entries를 10개로 변경
        Common.refer_show_entries(10)

        # Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        after_data_cnt = len(data)

        # Job list가 새로 고침되었는지 확인
        try:
            assert status == True and after_data_cnt == 10
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Real Time 토글 버튼을 Off로 변경한다.
        # Search 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]").click()
        
        # Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        
        # Ream Time 토글을 Off로 변경
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[2]/div/div[2]/label/span").click()

        # Show entries를 25개로 변경
        Common.refer_show_entries(25)
        
        # 35초 대기(자동 새로고침 시간: 30초) 및 기존 데이터 삭제
        time.sleep(35)
        del driver.requests

        # Job list가 새로 고침되었는지 확인. 새로고침을 안했다면, 새로운 job list가 없을테니 exception이 발생해야 함.
        try:
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            testResult = "failed"
            reason.append("2 steps failed\n")
        except:
            time.sleep(0.5)
        
        # Real Time 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1647, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1647, testPlanID, buildName, 'p', "Real Time Passed")

    def ShortCut():
        print("ITR-23: Search Filter > Short cut")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()
        
        # 1 steps start! : 임의의 검색조건을 입력한 후, Short cut 버튼을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        time.sleep(1)
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # 검색할 항목을 리스트로 생성
        search_list = [['StudyDesc','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[1]/div/div/input'],
        ['Modality','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[2]/div/div/input'],
        ['Bodypart','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[3]/div/div/input'],
        ['Department','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[4]/div/div/input']]
        search_item = random.choice(search_list)
        
        # All List 탭 클릭
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Job list에서 임의의 검색할 항목을 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        search_sample = []

        for i in data:
            if i[search_item[0]] not in search_sample and (i[search_item[0]]) != None:
                search_sample.append(i[search_item[0]])
        search_sample = random.choice(search_sample)

        # Job list에서 임의의 값으로 검색
        driver.find_element(By.XPATH, search_item[1]).send_keys(search_sample)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
        
        # Short cut 버튼 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        status = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside").get_attribute("class")

        # Short cut 창 팝업 확인
        try:
            assert status == 'right-sidebar open'
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # Short cut 창 닫기
        driver.find_element(By.XPATH, "/html/body/nav/div").click()

        # 2 steps start! : 임의의 Title을 작성한 후, Save 버튼을 클릭한다.
        # Short cut 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()

        # Title 작성 후, Save 버튼 클릭
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(str(test_shortcut_title))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        shortcut_title = []

        for i in data:
            if i["Title"] not in shortcut_title:
                shortcut_title.append(i["Title"])
        
        # Short cut이 생성되었는지 확인
        try:
            assert test_shortcut_title in shortcut_title
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Title을 작성하지 않은 상태에서 Save 버튼을 클릭한다.
        # Title 삭제
        driver.find_element(By.XPATH,"/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").clear()

        # Title이 없는 상태에서 Save 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # 팝업창 메시지 저장
        text = driver.find_element(By.XPATH, "/html/body/div[6]/h2").get_property("textContent")
        
        # 팝업창 메시지가 정상적으로 표시되는지 확인
        try:
            assert text == "Title 을 입력해주세요."
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")
        
        # 팝업창의 OK 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/div[6]/div[7]/div/button").click()

        # 4 steps start! : 임의의 Title을 작성하고 "Save Institution"을 체크한 후, Save 버튼을 클릭한다.
        # Short cut 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()

        # 임의의 Title을 입력
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(str(test_shortcut_title))

        # Save Insititution 체크 후, Save 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[3]/label").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        shortcut_title = []

        for i in data:
            temp_list = []
            temp_list.append(i["Title"])
            temp_list.append(i["InstitutionCode"])
            shortcut_title.append(temp_list)
        
        # Short cut이 생성되었는지 확인
        try:
            for i in shortcut_title:
                if i[0] == test_shortcut_title:
                    assert i[1] == '997'
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # 5 steps start! : 기존의 short cut에 등록된 동일한 title을 입력한 후, Save 버튼을 클릭한다.
        # Short cut list를 저장하기 위해 Short cut 생성
        time.sleep(1)
        del driver.requests
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(test_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        shortcut_title = []

        for i in data:
            if i["Title"] not in shortcut_title:
                shortcut_title.append(i["Title"])
        
        # 임의의 Short cut title 선택
        random_shortcut_title = random.choice(shortcut_title)
                
        # 기존에 저장된 short cut title 입력 후, Save 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(random_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut 추가 후, Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        new_shortcut_title = []

        for i in data:
            new_shortcut_title.append(i["Title"])

        # 동일한 short cut title이 생성되는지 확인
        try:
            cnt = 0
            for i in new_shortcut_title:
                if i == random_shortcut_title:
                    cnt = cnt + 1
            assert cnt >= 2
        except:
            testResult = "failed"
            reason.append("5 steps failed\n")

        # 동일한 short cut 삭제 (다음 테스트를 위해)
        index = new_shortcut_title.index(random_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]/span/button").click()
        
        # 6 steps start! : 이미 등록된 short cut을 클릭한 후, 다시 short cut 버튼을 클릭해서 Save 버튼을 클릭한다.
        # Short cut list를 저장하기 위해 Short cut 생성
        time.sleep(1)
        del driver.requests
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(test_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        shortcut_title = []

        for i in data:
            shortcut_title.append(i["Title"])

        # 임의의 Short cut 클릭
        random_shortcut_title = random.choice(shortcut_title)
        index = shortcut_title.index(random_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]").click()

        # Short cut 버튼 클릭
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        
        # Title에 이전에 선택했던 Short cut title이 있는지 확인 후, Save 버튼 클릭
        title = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").get_property("value")
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()
        
        # Search Condition 팝업창이 나타나는지 확인
        try:
            assert title == random_shortcut_title and driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[13]/div/div/div[1]/h4").get_property("textContent") == "Search Condition"
        except:
            testResult = "failed"
            reason.append("6 steps failed\n")

        # 7 steps start! : Search Condition 팝업창에서 Add를 클릭한다.
        # Search Condition > Add 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[13]/div/div/div[3]/button[1]").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        shortcut_title = []

        for i in data:
            shortcut_title.append(i["Title"])

        # Short cut 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        
        # 동일한 Short cut title이 추가되었는지 확인인
        try:
            cnt = 0
            for i in shortcut_title:
                if i == random_shortcut_title:
                    cnt = cnt + 1
            assert cnt >= 2
        except:
            testResult = "failed"
            reason.append("7 steps failed\n")
        
        # 동일한 short cut 삭제 (다음 테스트를 위해)
        index = shortcut_title.index(random_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]/span/button").click()
        
        # 8 steps start! : Search Condition 팝업창에서 Edit를 클릭한다.
        # Short cut > Clear 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li[1]").click()

        # Short cut 버튼 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()

        # Short cut list를 저장하기 위해 Short cut 생성
        time.sleep(1)
        del driver.requests
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(test_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        before_shortcut = []
        shortcut_title = []

        for i in data:
            temp = []
            temp_title = []
            temp_title.append(i["Title"])
            temp.append(i["Title"])
            temp.append(i["StudyDesc"])
            temp.append(i["Modality"])
            temp.append(i["Bodypart"])
            temp.append(i["Department"])
            shortcut_title.append(temp_title)
            before_shortcut.append(temp)

        # 임의의 Short cut 클릭
        time.sleep(1)
        del driver.requests
        random_shortcut_title = random.choice(shortcut_title)
        index = shortcut_title.index(random_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]").click()
        
        # 검색할 항목을 리스트로 생성
        search_list = [['StudyDesc','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[1]/div/div/input','1'],
        ['Modality','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[2]/div/div/input','2'],
        ['Bodypart','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[3]/div/div/input','3'],
        ['Department','/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div[4]/div/div/input','4']]
        choice_search_item = random.choice(search_list)
        index_search_item = search_list.index(choice_search_item) + 1

        # Short cut 창 닫기
        driver.find_element(By.XPATH, "/html/body/nav/div").click()

        # All List 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            if i[choice_search_item[0]] != None:
                if i[choice_search_item[0]] not in job_list:
                    job_list.append(i[choice_search_item[0]])
        search_item = random.choice(job_list)

        # 검색 조건에 입력 후, Search 버튼 클릭
        driver.find_element(By.XPATH, choice_search_item[1]).send_keys(search_item)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

        # Short cut 버튼 클릭 후, Save 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Search Condition > Edit 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[13]/div/div/div[3]/button[2]").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        after_shortcut = []
        random_shortcut_title = ' '.join(s for s in random_shortcut_title)
        choice_search_item = str(choice_search_item[0])

        for i in data:
            if i["Title"] == random_shortcut_title:
                temp = []
                temp.append(i["Title"])
                temp.append(i["StudyDesc"])
                temp.append(i["Modality"])
                temp.append(i["Bodypart"])
                temp.append(i["Department"])
                after_shortcut.append(temp)
        
        # Edit 시, 동일한 Short cut title에 저장되는지 확인
        try:
            for i in before_shortcut:
                if i[0] == random_shortcut_title:
                    assert i[index_search_item] != search_item
        except:
            testResult = "failed"
            reason.append("8 steps failed\n")

        # 9 steps start! : Search Condition 팝업창에서 Close를 클릭한다.
        # Short cut 버튼 클릭 후, Clear 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li[1]").click()

        # Short cut 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()

        # Short cut list를 저장하기 위해 Short cut 생성
        time.sleep(1)
        del driver.requests
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(test_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        shortcut_title = []

        for i in data:
            temp_title = []
            temp_title.append(i["Title"])
            shortcut_title.append(temp_title)

        # Short cut > 임의의 Short cut 클릭
        random_shortcut_title = random.choice(shortcut_title)
        index = shortcut_title.index(random_shortcut_title)
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]").click()

        # Short cut 버튼 클릭 후, Save 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()
        
        # Search Condition > Close 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[13]/div/div/div[3]/button[3]").click()

        # Short cut 생성 취소 확인
        try:
            request = driver.wait_for_request('.*/GetReferSearchCondition.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            testResult = "failed"
            reason.append("9 steps failed\n")
        except:
            time.sleep(0.5)

        # 10 steps start! : Short cut 리스트에서 "Clear"를 클릭한다.
        # Short cut 버튼 클릭 후, Clear 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li[1]").click()

        # 검색 조건 상태 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        search_filter = []
        search_filter.append(data["StudyDesc"])
        search_filter.append(data["Modality"])
        search_filter.append(data["Bodypart"])
        search_filter.append(data["Department"])

        # Short cut 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        
        # Title 입력값이 초기화 되었는지 확인
        try:
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").get_property("value") == '':
                for i in search_filter:
                    assert i == None
        except:
            testResult = "failed"
            reason.append("10 steps failed\n")

        # 11 steps start! : Short cut 리스트에서 임의의 short cut을 클릭한다.
        # Short cut list를 저장하기 위해 Short cut 생성
        time.sleep(1)
        del driver.requests
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(test_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        shortcut_title = []

        for i in data:
            temp = []
            temp.append(i["Title"])
            temp.append(i["StudyDesc"])
            temp.append(i["Modality"])
            temp.append(i["Bodypart"])
            temp.append(i["Department"])
            shortcut_title.append(temp)

        # Short cut > 임의의 Short cut 클릭
        random_shortcut_title = random.choice(shortcut_title)
        index = shortcut_title.index(random_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]").click()

        # 검색 조건 상태 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        search_filter = []
        search_filter.append(data["StudyDesc"])
        search_filter.append(data["Modality"])
        search_filter.append(data["Bodypart"])
        search_filter.append(data["Department"])

        # Short cut의 검색 조건과 검색 결과의 검색 조건이 동일한지 확인
        try:
            for i in shortcut_title:
                if i[0] == random_shortcut_title:
                    for n in range(1,4):
                        assert i[n] == search_filter[n-1]
        except:
            testResult = "failed"
            reason.append("11 steps failed\n")

        # 12 steps start! : Short cut 리스트에서 "-" 버튼을 클릭한다.
        # Short cut 버튼 클릭 후, Clear 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li[1]").click()

        # Short cut 버튼 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/ul/li/a/i").click()

         # Short cut list를 저장하기 위해 Short cut 생성
        time.sleep(1)
        del driver.requests
        test_shortcut_title = 'TEST' + str(random.randrange(0,1000))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[1]/div/input").send_keys(test_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/div[2]/button").click()

        # Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        before_shortcut_list = []

        for i in data:
            before_shortcut_list.append(i["Title"])
        
        # 추가한 short cut 삭제
        time.sleep(1)
        del driver.requests
        index = before_shortcut_list.index(test_shortcut_title)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]/span/button").click()

        # 삭제 후, Short cut list 저장
        request = driver.wait_for_request('.*/GetReferSearchCondition.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        after_shortcut_list = []

        for i in data:
            after_shortcut_list.append(i["Title"])

        # 정상적으로 Short cut이 삭제되었는지 확인
        try:
            assert test_shortcut_title not in after_shortcut_list
        except:
            testResult = "failed"
            reason.append("12 steps failed\n")

        # 13 steps start! : Short cut 리스트에서 Short cut에 마우스 오버한다.
        # 임의의 Short cut에 마우스 오버
        random_shortcut_title = random.choice(after_shortcut_list)
        index = after_shortcut_list.index(random_shortcut_title)
        webdriver.ActionChains(driver).move_to_element(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]")).perform()

        # 마우스 오버 시, 툴팁 정보 저장
        tooltip = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]").get_property("outerHTML")

        # 툴팁이 표시되는지 확인
        try:
            assert "aria-describedby" in tooltip
        except:
            testResult = "failed"
            reason.append("13 steps failed\n")

        # 14 steps start! : Short cut 리스트에서 Short cut에 마우스 오버한 후, "-" 버튼을 클릭한다.
        # 현재 리스트 개수 확인
        shortcut_list_cnt = len(after_shortcut_list) + 2

        # 현재 Short cut list의 툴팁에 있는 key 값 저장
        before_shortcut_key_list = []
        for n in range(2, shortcut_list_cnt):
            shortcut_key = (driver.find_element(By.CSS_SELECTOR, "#settings > div > div:nth-child(1) > ul > li:nth-child("+str(n)+")").get_property("dataset"))["key"]
            if shortcut_key not in before_shortcut_key_list:
                before_shortcut_key_list.append(shortcut_key)

        # 임의의 Short cut에 마우스 오버
        random_shortcut_title = random.choice(after_shortcut_list)
        index = after_shortcut_list.index(random_shortcut_title)
        webdriver.ActionChains(driver).move_to_element(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]")).perform()

        # 마우스 오버 시, 툴팁 정보 저장
        tooltip = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]").get_property("outerHTML")
        tooltip_key = (driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]").get_property("dataset"))["key"]

        # 임의의 Short cut 삭제
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/section/aside/div/div/div[1]/ul/li["+str(int(index)+2)+"]/span/button").click()
        
        # Short cut 삭제 후, Short cut list의 툴팁에 있는 key 값 저장
        time.sleep(1)
        after_shortcut_key_list = []
        for n in range(2, shortcut_list_cnt-1):
            shortcut_key = (driver.find_element(By.CSS_SELECTOR, "#settings > div > div:nth-child(1) > ul > li:nth-child("+str(n)+")").get_property("dataset"))["key"]
            if shortcut_key not in after_shortcut_key_list:
                after_shortcut_key_list.append(shortcut_key)

        # 삭제한 Short cut의 툴팁이 삭제되었는지 확인
        try:
            assert tooltip_key not in after_shortcut_key_list
        except:
            testResult = "failed"
            reason.append("14 steps failed\n")

        # Short cut 창 닫기
        driver.find_element(By.XPATH, "/html/body/nav/div").click()

        # Short cut 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else testResult)
        if testResult == 'failed':
            testlink.reportTCResult(1651, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1651, testPlanID, buildName, 'p', "Short cut Passed")

class Worklist:
    def All_Assigned_List():
        print("ITR-24: Worklist > All Assigned List")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # Refer 탭 클릭(화면 초기화)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 1 steps start! : All Assigned List 탭을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        time.sleep(1)
        del driver.requests
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # All Assigned List 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        # Job list 저장
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        # All Assigned List의 Job list를 가져오는지 확인
        try:
            assert data is not None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # All Assigned List 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1668, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1668, testPlanID, buildName, 'p', "All Assigned List Passed")

    def Not_Assigned_List():
        print("ITR-25: Worklist > Not Assigned List")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Not Assigned List 탭을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        time.sleep(1)
        del driver.requests
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Not Assigned List 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        # Job list 저장
        time.sleep(1)
        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        # Not Assigned List의 Job list를 가져오는지 확인
        try:
            assert data is not None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # Not Assigned List 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1671, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1671, testPlanID, buildName, 'p', "Not Assigned List Passed")

    def All_List():
        print("ITR-26: Worklist > All List")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : All List 탭을 클릭한다.
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        time.sleep(1)
        del driver.requests
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # All List 탭 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Job list 저장
        time.sleep(1)
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        # All List의 Job list를 가져오는지 확인
        try:
            assert data is not None
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # All List 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1674, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1674, testPlanID, buildName, 'p', "All List Passed")

    def Schedule():
        print("ITR-27: Worklist > Schedule")
        testResult = ''
        reason = list()

        del driver.requests
        time.sleep(1)

        # 새로고침
        driver.refresh()

        # 1 steps start! : Schedule 체크박스를 체크한다.
        # Refer 탭 클릭
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # 병원 리스트와 Schedule count 저장
        time.sleep(1)
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        schedule_list = []

        for i in data:
            if i["ScheduleTotalCount"] != 0:
                temp = []
                temp.append(i["InstitutionCode"])
                temp.append(i["ScheduleTotalCount"])
                schedule_list.append(temp)

        # Schedule이 있는 병원을 순서대로 클릭
        for i in schedule_list:
            del driver.requests
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "#list-institution-row-"+str(i[0])).click()
            driver.wait_for_request('.*/GetAllAssignedList.*')
            time.sleep(0.3)

            # Schedule 체크
            status = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[4]/a/input").get_property("checked")
            if status != True:
                del driver.requests
                time.sleep(1)
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[4]/a/label").click()
                driver.wait_for_request('.*/GetAllAssignedList.*')
                time.sleep(0.3)

            # All Assigned List 클릭
            del driver.requests
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()
            
            # All Assigned List의 scheduled job list 저장
            request = driver.wait_for_request('.*/GetAllAssignedList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            schedule_job_list = []

            for j in data:
                schedule_job_list.append(j)

            # Not Assigned List의 scheduled job list 저장
            time.sleep(0.5)
            del driver.requests
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()
            request = driver.wait_for_request('.*/GetNotAssignedList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for j in data:
                schedule_job_list.append(j)

            # Schedule Job list 개수 저장
            schedule_job_cnt = len(schedule_job_list)
            
            # 병원 리스트에 표시된 Schedule count와 scheduled list의 count가 일치하는지 확인
            try:
                assert i[1] == schedule_job_cnt
            except:
                testResult = "failed"
                reason.append("1 steps failed\n")

            # All Assigned List 클릭
            del driver.requests
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()
            driver.wait_for_request('.*/GetAllAssignedList.*')
            time.sleep(0.3)

        # 2 steps start! : Schedule 체크박스를 체크 해제한다.
        # 병원 탭 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[1]/ul/li[1]").click()

        # Schedule이 있는 병원의 Job count 저장
        request = driver.wait_for_request('.*/GetReferCountsByInstitution.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        schedule_list = []

        for i in data:
            if i["ScheduleTotalCount"] != 0:
                temp = []
                temp.append(i["InstitutionCode"])
                temp.append(i["JobCount"])
                schedule_list.append(temp)

        # Schedule이 있는 병원을 순서대로 클릭
        for i in schedule_list:
            driver.find_element(By.CSS_SELECTOR, "#list-institution-row-"+str(i[0])).click()

            # Schedule 체크 해제
            status = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[4]/a/input").get_property("checked")
            if status != False:
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[4]/a/label").click()

            # All Assigned List 탭 클릭
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

            # All Assigned List의 Job count 저장
            time.sleep(1)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
            temp_cnt = temp_cnt.split()
            list_cnt = 0
            list_cnt = int(temp_cnt[5])

            # Not Assigned List 탭 클릭
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()
            
            # Not Assigned List의 Job count 저장
            time.sleep(1)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
            temp_cnt = temp_cnt.split()
            list_cnt = int(list_cnt) + int(temp_cnt[5])

            # 병원 리스트의 Job count와 Job list의 job count가 일치하는지 확인
            try:
                assert int(i[1]) == int(list_cnt)
            except:
                testResult = "failed"
                reason.append("2 steps failed\n")

        # Schedule 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1677, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1677, testPlanID, buildName, 'p', "Schedule Passed")
        
    def Priority():
        print("ITR-28: Worklist > Priority")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Worklist에서 Priority가 일반인 의뢰 검사를 선택한 후, Priority 버튼을 클릭한다.
        # Refer 탭 클릭
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()
        
        # Show entries를 100개로 변경
        Common.refer_show_entries(100)
        
        # Not Assigned List 탭 클릭
        time.sleep(0.5)
        del driver.requests
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        # Not Assigned List > Job priority가 일반인 Job list 저장
        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        time.sleep(0.3)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            if i["JobPriority"] == 'N':
                job_list.append(i["JobKey"])

        # Not Assigned List > Priority가 일반인 임의의 job 체크
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()="+str(job_key)+"]").click()

        # Not Assigned List > Priority 버튼 클릭
        priority_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[1]/button[1]")
        if priority_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",priority_btn)

        # Not Assigned List 탭 클릭 후, Not Assigned List > Job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()
        
        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            if i["JobPriority"] == 'N':
                job_list.append(i["JobKey"])

        # 선택한 job의 priority가 응급으로 변경되었는지 확인
        try:
            assert job_key not in job_list
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # 2 steps start! : Worklist에서 Priority가 응급인 의뢰 검사를 선택한 후, Priority 버튼을 클릭한다.
        # Not Assigned List 탭 클릭 후, Priority가 응급인 job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            if i["JobPriority"] == 'E':
                job_list.append(i["JobKey"])

        # Not Assigned List > Priority가 응급인 job 체크
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Not Assigned List > Priority 버튼 클릭
        priority_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[1]/button[1]")
        if priority_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",priority_btn)

        # Not Assigned List 탭 클릭 후, Priority가 응급인 Job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            if i["JobPriority"] == 'E':
                job_list.append(i["JobKey"])

        # 선택한 job의 priority가 일반으로 변경되었는지 확인
        try:
            assert job_key not in job_list
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")
        
        # Priority 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1681, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1681, testPlanID, buildName, 'p', "Priority Passed")

    def Canceled():
        print("ITR-29: Worklist > Canceled")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Worklist에서 Job Status가 Canceled 이외의 의뢰 검사를 선택한 후, Cancel 버튼을 클릭한다.
        # Refer 탭 클릭
        time.sleep(1)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        
        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Not Assigned List 탭 클릭 후, Job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()
        
        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        before_job_list = []

        for i in data:
            before_job_list.append(i["JobKey"])

        # Not Assigned List > 임의의 Job 선택
        job_key = random.choice(before_job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Cancel 버튼 클릭
        cancel_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[1]/button[2]")
        if cancel_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",cancel_btn)
        
        # Request Cancel 팝업창이 나타나는지 확인
        try:
            assert driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[9]/div/div/div[1]/h4").get_property("textContent") == "Request Cancel"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # 2 steps start! : Request Cancel 팝업창에서 "OK"를 클릭한다.
        # Request Cancel > OK 버튼 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[9]/div/div/div[3]/button[1]").click()

        # Not Assigned List > Job list 저장
        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        after_job_list = []

        for i in data:
            after_job_list.append(i["JobKey"])

        # Not Assigned List > Job list에서 Cancel 한 job이 없는지 확인
        try:
            assert job_key not in after_job_list
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Request Cancel 팝업창에서 "Close"를 클릭한다.
        # Not Assigned List > 임의의 Job 선택
        job_key = random.choice(before_job_list)
        time.sleep(1.5)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Cancel 버튼 클릭
        cancel_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[1]/button[2]")
        if cancel_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",cancel_btn)

        # Request Cancel > Close 버튼 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[9]/div/div/div[3]/button[2]").click()

        # Net Assigned List 탭 클릭(job list 획득하기 위함)
        time.sleep(1)
        del driver.requests
        time.sleep(1)

        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]")))
        element = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]")
        driver.execute_script("arguments[0].click()",element)
        
        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        close_job_list = []

        for i in data:
            close_job_list.append(i["JobKey"])

        # Not Assgined List > Job list에서 Cancel 한 job이 있는지 확인
        try:
            assert job_key in close_job_list
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")    

        # Canceled 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1685, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1685, testPlanID, buildName, 'p', "Canceled Passed")

    def Refer():
        print("ITR-30: Worklist > Refer")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()
        
        # 1 steps start! : Worklist에서 임의의 의뢰 검사를 선택한 후, Refer 버튼을 클릭한다.
        # Configuration > Institutions로 이동 후, 테스트 병원 검색
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/button[4]").click()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys(test_hospital_code)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[3]/button").click()

        # Configuration > Institutions > Institutions Modify 팝업창 > Use Default Referring Comment 체크 해제
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#i_l_997").click()
        time.sleep(1)
        referring_comment = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[6]/div/div/input").get_property("checked")
        if referring_comment == True:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[6]/div/div/label").click()
         
        # Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[3]/div/button[2]").click()

        # 팝업창에서 Yes 클릭
        try:
            EC.element_attribute_to_include(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible")
            if (driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible").get_property("classList"))[2] == "visible":
                driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Refer 탭 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # Not Assigned List 탭 클릭 후, job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])

        # Not Assigned List > 임의의 job 선택
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Refer 버튼 클릭
        refer_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[1]")
        if refer_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",refer_btn)

        # Refer 창이 팝업됐는지 확인
        try:
            assert driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[1]/h4").get_property("textContent") == "Refer"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Search 입력란에 ID 또는 이름을 입력한다.
        # Refer 팝업창의 Reporter list 저장
        temp_list = ''
        time.sleep(1)
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        reporter_list = temp_list.split('\n')
        reporter_id_list = []
        reporter_name_list = []

        for i in reporter_list:
            reporter_id_list.append(i.split()[0])
            reporter_name_list.append(i.split()[2])

        # Refer 팝업창 > Search 필드에 임의의 Reporter ID를 입력
        random_reporter_id = random.choice(reporter_id_list)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/input").clear()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/input").send_keys(random_reporter_id)

        # Refer 팝업창 > 검색 결과 저장
        temp_list = ''
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        reporter_list = temp_list.split('\n')
        check_reporter_id_list = []

        for i in reporter_list:
            check_reporter_id_list.append(i.split()[0])

        # Refer 팝업창 > Reporter list에 검색한 Reporter가 표시되는지 확인
        try:
            assert random_reporter_id in check_reporter_id_list
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # Refer 팝업창 > Search 필드에 임의의 Reporter Name을 입력
        random_reporter_name = random.choice(reporter_name_list)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/input").clear()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/input").send_keys(random_reporter_name)

        # Refer 팝업창 > 검색 결과 저장
        temp_list = ''
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        reporter_list = temp_list.split('\n')
        check_reporter_name_list = []

        for i in reporter_list:
            check_reporter_name_list.append(i.split()[2])
        
        # Refer 팝업창 > Reporter list에 검색한 Reporter가 표시되는지 확인
        try:
            assert random_reporter_name in check_reporter_name_list
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")
        
        # 3 steps start! : Sort By Name에 체크한다.
        # Refer 팝업창 > Search 필드 초기화
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/input").clear()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/input").send_keys(" ")

        # Refer 팝업창 > Reporter list 저장 및 오름차순 정렬
        temp_list = ''
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        reporter_list = temp_list.split('\n')
        before_reporter_name_list = []

        for i in reporter_list:
            before_reporter_name_list.append(i.split()[2])
        before_reporter_name_list.sort()

        # Refer 팝업창 > Sort By Name 체크
        check = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[1]/input")
        if refer_btn.get_property("checked") != True:
            driver.execute_script("arguments[0].click()",check)

        # Refer 팝업창 > Reporter list 저장
        time.sleep(1)
        temp_list = ''
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        reporter_list = temp_list.split('\n')
        after_reporter_name_list = []

        for i in reporter_list:
            after_reporter_name_list.append(i.split()[2])

        # Reporter list가 Name으로 정렬되었는지 확인
        try:
            assert before_reporter_name_list == after_reporter_name_list
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : 리스트에서 임의의 판독의를 클릭한다.
        # Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(after_reporter_name_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                # n = count_list.pop(random.randrange(0, reporter_cnt))
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # Refer 팝업창 > 선택한 Reporter가 정상적으로 선택됐는지 확인
        try:
            assert select_reporter_list == selected_reporter_list
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # 5 steps start! : Comment를 입력한다.
        # Comment를 입력하고 Save 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/textarea").send_keys("Refer Comment Test")
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[3]/button[1]").click()

        # Refer 탭 클릭
        time.sleep(1)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()
        driver.refresh()

        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # All Assigned List > Refer 한 Job에서 마우스 우클릭
        time.sleep(1)
        # WebDriverWait(driver, 5).until(EC.presence_of_all_elements_located((By.XPATH, "//td[normalize-space()='"+str(job_key)+"']")))
        webdriver.ActionChains(driver).context_click(driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']")).perform()

        # Report View 창 팝업 확인
        try:
            assert driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[17]/div/div/div[1]/h3").get_property("textContent") == "Report View"
        except:
            testResult = "failed"
            reason.append("5 steps failed\n")

        # Report View 팝업창 > Refer Comment에 입력한 comment가 표시되는지 확인
        try:
            time.sleep(1)
            assert driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[17]/div/div/div[2]/div[5]/div[2]/div/textarea").get_property("value") == "Refer Comment Test"
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[17]/div/div/div[2]/div[12]/button").click()
        except:
            testResult = "failed"
            reason.append("5 steps failed\n")

        # 6 steps start! : Comment를 선택하고, 추가 Comment가 있다면 입력한다.
        # 새로 고침
        time.sleep(1)
        driver.refresh()

        # Configuration > Institutions로 이동 후, 테스트 병원 검색
        element = WebDriverWait(driver, 5).until(EC.presence_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/button[4]").click()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys(test_hospital_code)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[3]/button").click()

        # Configuration > Institutions > Institutions Modify 팝업창 > Use Default Referring Comment 체크
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#i_l_997").click()
        time.sleep(1)
        referring_comment = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[6]/div/div/input").get_property("checked")
        if referring_comment != True:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[6]/div/div/label").click()
         
        # Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[3]/div/button[2]").click()

        # 팝업창에서 Yes 클릭
        try:
            EC.element_attribute_to_include(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible")
            if (driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible").get_property("classList"))[2] == "visible":
                driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        except:
            testResult = "failed"
            reason.append("6 steps failed\n")

        # 새로 고침
        time.sleep(1)
        driver.refresh()

        # Refer 탭 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Not Assigned List 탭 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        # Not Assigned List > 임의의 job 선택
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        
        # Not Assigned List > Refer 버튼 클릭
        refer_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[1]")
        if refer_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",refer_btn)
        
        # Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(after_reporter_name_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # Refer 팝업창 > Comment dropbox list 저장
        comment_list = []
        comment_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select/option")

        # Refer 팝업창 > 임의의 Comment 선택
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select").click()
        select_comment = random.choice(comment_list)
        select_comment.click()

        # Refer 팝업창 > Comment 내용 저장
        comment = ''
        comment = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/textarea").get_property("value")

        # Refer 팝업창 > Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[3]/button[1]").click()

        # All Assigned List 탭 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        # All Assigned List 저장
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        before_all_assigned_job_list = []

        for i in data:
            temp = []
            temp.append(i["JobKey"])
            temp.append(i["PatientID"])
            temp.append(i["InstitutionCode"])
            temp.append(i["Modality"])
            before_all_assigned_job_list.append(temp)

        # All Assigned List > Refer 한 Job에서 마우스 우클릭
        time.sleep(1)
        webdriver.ActionChains(driver).context_click(driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']")).perform()

        # Report View 팝업창 > Refer Comment에 입력한 comment가 표시되는지 확인
        try:
            time.sleep(1)
            assert driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[17]/div/div/div[2]/div[5]/div[2]/div/textarea").get_property("value") == comment
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[17]/div/div/div[2]/div[12]/button").click()
        except:
            testResult = "failed"
            reason.append("6 steps failed\n")

        # 7 steps start! : With Releated Job에 체크한 후, Save 버튼을 클릭한다.
        # 새로고침
        time.sleep(1)
        driver.refresh()

        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()
        
        # Not Assigned List 탭 클릭 후, job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])

        # Not Assigned List > 임의의 job 선택
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Not Assigned List > Refer 버튼 클릭
        refer_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[1]")
        if refer_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",refer_btn)
        
        # Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(after_reporter_name_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # Refer 팝업창 > Comment dropbox list 저장
        comment_list = []
        comment_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select/option")

        # Refer 팝업창 > 임의의 Comment 선택
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select").click()
        select_comment = random.choice(comment_list)
        select_comment.click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select").click()

        # Refer 팝업창 > Comment 내용 저장
        comment = ''
        comment = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/textarea").get_property("value")

        # Refer 팝업창 > With Related Job 체크
        check = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/input")
        if check.get_property("checked") == False:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/label").click()
            # check.click()

        # Refer 팝업창 > Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[3]/button[1]").click()

        # All Assigned List 탭 클릭 및 job list 저장
        time.sleep(2)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        after_all_assigned_job_list = []

        for i in data:
            temp = []
            temp.append(i["JobKey"])
            temp.append(i["PatientID"])
            temp.append(i["InstitutionCode"])
            temp.append(i["Modality"])
            after_all_assigned_job_list.append(temp)
        
        # Refer 후, 추가된 job list 추출
        changes_job_list = []
        for i in after_all_assigned_job_list:
            if i not in before_all_assigned_job_list:
                changes_job_list.append(i)
        
        # Refer 한 job 찾기
        sample_list = []
        for i in after_all_assigned_job_list:
            if i[0] == job_key:
                temp = []
                temp.append(i[1])
                temp.append(i[2])
                temp.append(i[3])
                sample_list.append(temp)

        # Changes_job_list에서 job key만 제거
        if len(changes_job_list) != 1:
            for i in changes_job_list:
                del i[0]
        else:
            del changes_job_list[0][0]

        # 추가된 job list의 job이 Refer 한 job의 Patient ID, Institution Code, Modality가 동일한지 확인
        try:
            if len(changes_job_list) != 1:
                for i in changes_job_list:
                    print(i)
                    print(sample_list)
                    assert i == sample_list
            else:
                print(changes_job_list)
                print(sample_list)
                assert changes_job_list == sample_list
        except:
            testResult = "failed"
            reason.append("7 steps failed\n")

        # 8 steps start! : With Releated Job에 체크 해제한 후, Save 버튼을 클릭한다.
        # All Assigned List 탭 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        # All Assigned List 저장
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        before_all_assigned_job_list = []

        for i in data:
            temp = []
            temp.append(i["JobKey"])
            temp.append(i["PatientID"])
            temp.append(i["InstitutionCode"])
            temp.append(i["Modality"])
            before_all_assigned_job_list.append(temp)

        # Not Assigned List 탭 클릭 후, job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])

        # Not Assigned List > 임의의 job 선택
        job_key = random.choice(job_list)
        time.sleep(2)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Not Assigned List > Refer 버튼 클릭
        refer_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[1]")
        if refer_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",refer_btn)
        
        # Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(after_reporter_name_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # Refer 팝업창 > Comment dropbox list 저장
        comment_list = []
        comment_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select/option")

        # Refer 팝업창 > 임의의 Comment 선택
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select").click()
        select_comment = random.choice(comment_list)
        select_comment.click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select").click()

        # Refer 팝업창 > Comment 내용 저장
        comment = ''
        comment = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/textarea").get_property("value")

        # Refer 팝업창 > With Related Job 체크
        check = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/input")
        if check.get_property("checked") != False:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/label").click()

        # Refer 팝업창 > Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[3]/button[1]").click()

        # All Assigned List 탭 클릭 및 job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        after_all_assigned_job_list = []

        for i in data:
            temp = []
            temp.append(i["JobKey"])
            temp.append(i["PatientID"])
            temp.append(i["InstitutionCode"])
            temp.append(i["Modality"])
            after_all_assigned_job_list.append(temp)
        
        # Refer 후, 추가된 job list 추출
        changes_job_list = []
        for i in after_all_assigned_job_list:
            if i not in before_all_assigned_job_list:
                changes_job_list.append(i)
        
        # Refer 한 job 찾기
        sample_list = []
        for i in after_all_assigned_job_list:
            if i[0] == job_key:
                temp = []
                temp.append(i[1])
                temp.append(i[2])
                temp.append(i[3])
                sample_list.append(temp)

        # Changes_job_list에서 job key만 제거
        if len(changes_job_list) != 1:
            for i in changes_job_list:
                del i[0]
        else:
            del changes_job_list[0][0]

        # 추가된 job list의 job이 Refer 한 job의 Patient ID, Institution Code, Modality가 동일한지 확인
        try:
            assert len(changes_job_list) == 1 and changes_job_list == sample_list
        except:
            testResult = "failed"
            reason.append("8 steps failed\n")

        # 9 steps start! : Refer를 하지 않고 Close 버튼을 클릭한다.
        # Not Assigned List 탭 클릭 후, job list 저장
        time.sleep(1)
        del driver.requests
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        time.sleep(0.3)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])
        
        # Not Assigned List > 임의의 job 선택
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Not Assigned List > Refer 버튼 클릭
        refer_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[1]")
        if refer_btn.get_property("disabled") != True:
            driver.execute_script("arguments[0].click()",refer_btn)
        
        # Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(after_reporter_name_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # Refer 팝업창 > Comment dropbox list 저장
        comment_list = []
        comment_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select/option")

        # Refer 팝업창 > 임의의 Comment 선택
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select").click()
        select_comment = random.choice(comment_list)
        select_comment.click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[2]/div[3]/div/select").click()

        # Refer 팝업창 > Close 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[3]/div/div/div[3]/button[2]").click()

        # All Assigned List 탭 클릭 후, job list 저장
        # time.sleep(1)
        WebDriverWait(driver, 5).until(EC.presence_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]/a")))
        del driver.requests
        click = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]/a")
        driver.execute_script("arguments[0].click()",click)

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])

        # 선택한 job이 Refer 되지 않았는지 확인
        try:
            for i in job_list:
                assert i != job_key
        except:
            testResult = "failed"
            reason.append("9 steps failed\n")
        
        # Refer 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1690, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1690, testPlanID, buildName, 'p', "Refer Passed")

    def Refer_Cancel():
        print("ITR-31: Worklist > Refer Cancel")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : 판독의가 할당된 의뢰 검사를 선택한 후, Refer Cancel 버튼을 클릭한다.
        # Refer 탭 클릭
        time.sleep(1)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # All Assigned List 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        before_job_list = []

        for i in data:
            before_job_list.append(i["JobKey"])
        
        # All Assigned List > 임의의 job 선택
        job_key = random.choice(before_job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # All Assigned List > Refer Cancel 버튼 클릭
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[2]")
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[2]")))
        driver.execute_script("arguments[0].click()",btn)

        # All Assigned List > Refer Cancel 팝업창 확인
        popup_title = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[10]/div/div/div[1]/h4")
        try:
            assert popup_title.get_property("textContent") == "Refer Cancel"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Refer Cancel 팝업창에서 "Close"를 클릭한다.
        # Refer Cancel 팝업창 > Close 클릭
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#refer-cancel-close")))
        driver.find_element(By.CSS_SELECTOR, "#refer-cancel-close").click()

        # All Assigned List 탭 클릭 후, job list 저장
        
        while(1):
            try:
                del driver.requests
                time.sleep(1)

                WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]")))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()
                break
            except:
                # 새로고침
                driver.refresh()

                # 1 steps start! : 판독의가 할당된 의뢰 검사를 선택한 후, Refer Cancel 버튼을 클릭한다.
                # Refer 탭 클릭
                time.sleep(1)
                # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

                # Test 병원 선택
                hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                for i in hospital_list:
                    if (i.get_property("dataset"))["institutionName"] == test_hospital:
                        i.click()
                        break

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        time.sleep(0.3)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        after_job_list = []

        for i in data:
            after_job_list.append(i["JobKey"])

        # All Assigned List > Refer Cancel 한 job이 남아있는지 확인
        try:
            assert job_key in after_job_list
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Refer Cancel 팝업창에서 "OK"를 클릭한다.
        # All Assigned List > 임의의 job 선택
        job_key = random.choice(after_job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # All Assigned List > Refer Cancel 버튼 클릭
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[2]")
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[2]")))
        driver.execute_script("arguments[0].click()",btn)

        # Refer Cancel 팝업창 > OK 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[10]/div/div/div[3]/button[1]").click()

        # All Assigned List 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])

        # All Assigned List > 선택한 job이 사라졌는지 확인
        try:
            assert job_key not in job_list
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : 판독의가 할당되지 않은 의뢰 검사를 선택한 후, Refer Cancel 버튼을 클릭한다.
        # Not Assigned List 탭 클릭 후, job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        not_assigned_job_list = []

        for i in data:
            not_assigned_job_list.append(i["JobKey"])

        # Not Assigned List > 임의의 job 선택
        job_key = random.choice(not_assigned_job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Not Assigned List > Refer Cancel 버튼 상태 확인
        refer_cancel_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[2]")
        try:
            assert refer_cancel_btn.get_property("disabled") == True
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # 5 steps start! : 병원 리스트에서 임의의 판독의를 클릭한다.        
        # 선택한 병원의 Reporter list 저장
        time.sleep(1)
        reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
        reporter_cnt = len(reporter_list)
        select_reporter_list = []

        for i in reporter_list:
            select_reporter_list.append((i.get_property("dataset"))["reporterKey"])

        # 선택한 병원에서 임의의 Reporter 클릭
        time.sleep(1)
        reporter_key = (reporter_list[random.randrange(0,reporter_cnt)].get_property("dataset"))["reporterKey"]
        btn = driver.find_element(By.CSS_SELECTOR, "#institution_reporter_list_row_"+str(reporter_key))
        driver.execute_script("arguments[0].click()",btn)

        # Refer Cancel(All) 버튼이 표시되는지 확인
        try:
            btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[3]")
            assert btn.get_property("disabled") == False
        except:
            testResult = "failed"
            reason.append("5 steps failed\n")

        # 6 steps start! : 임의의 판독의를 클릭하고 Refer Cancel(All) 버튼을 클릭한다. 
        # Job list 저장
        request = driver.wait_for_request('.*/GetReferedListByReporter.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        before_job_list = []

        for i in data:
            before_job_list.append(i["JobKey"])

        # Refer Cancel(All) 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[3]").click()

        # Refer Cancel(All) 팝업창 > Close 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[11]/div/div/div[3]/button[2]").click()
        
        # 선택했던 Reporter 다시 클릭해서 job list 저장
        btn = driver.find_element(By.CSS_SELECTOR, "#institution_reporter_list_row_"+str(reporter_key))
        driver.execute_script("arguments[0].click()",btn)
        time.sleep(1)

        request = driver.wait_for_request('.*/GetReferedListByReporter.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        after_job_list = []

        for i in data:
            after_job_list.append(i["JobKey"])

        # Job list에 refer 된 job이 그대로 유지되는지 확인
        try:
            assert before_job_list == after_job_list
        except:
            testResult = "failed"
            reason.append("6 steps failed\n")

        # Refer Cancel(All) 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[3]").click()

        # Refer Cancel(All) 팝업창 > OK 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[11]/div/div/div[3]/button[1]").click()

        # 테스트 병원의 Report list 저장
        time.sleep(1)
        reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
        reporter_cnt = len(reporter_list)
        changes_reporter_list = []        
        
        for i in reporter_list:
            changes_reporter_list.append((i.get_property("dataset"))["reporterKey"])

        # 테스트 병원에서 선택했던 Reporter가 사라졌는지 확인
        try:
            assert reporter_key not in changes_reporter_list
        except:
            testResult = "failed"
            reason.append("6 steps failed\n")
        
        # Refer Cancel 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1701, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1701, testPlanID, buildName, 'p', "Refer Cancel Passed")

    def Refer_Cancel_And_Refer():
        print("ITR-32: Worklist > Refer Cancel and Refer")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : 판독의에게 할당된 임의의 의뢰 검사를 선택하고, Refer Cancel and Refer 버튼을 클릭한다.
        # Refer 탭 클릭
        time.sleep(1)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # 선택한 병원의 Reporter list 저장
        time.sleep(1)
        reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
        reporter_id_key_list = []

        for i in reporter_list:
            temp = []
            temp.append((i.get_property("dataset"))["reporterId"])
            temp.append((i.get_property("dataset"))["reporterKey"])
            reporter_id_key_list.append(temp)

        # All Assigned List 탭 클릭 후, job list 저장
        del driver.requests
        time.sleep(1)
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])

        # All Assigned List > 임의의 job 선택
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # All Assigned List > R.Cancel & Refer 클릭
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]")
        if btn.get_property("disabled") == False:
            driver.execute_script("arguments[0].click()",btn)

        # R.Cancel & Refer 팝업창 확인
        try:
            popup_title = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[1]/h4")
            assert popup_title.get_property("textContent") == "Refer Cancel & Refer"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # R.Cancel & Refer 팝업창 > Reporter list 저장
        time.sleep(1)
        temp_list = ''
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        
        reporter_list = temp_list.split('\n')
        reporter_id_list = []

        for i in reporter_list:
            reporter_id_list.append(i.split()[0])

        # R.Cancel & Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(reporter_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # R.Cancel & Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # 선택한 Reporter ID 저장
        selected_reporter_id_list = []
        for i in selected_reporter_list:
            selected_reporter_id_list.append(i.split()[0])

        # R.Cancel & Refer 팝업창 > Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[3]/button[1]").click()

        # 테스트 병원에서 선택한 Reporter를 순서대로 클릭하면서 refer 됐는지 확인
        for i in selected_reporter_id_list:
            for j in reporter_id_key_list:
                if j[0] == i:
                    del driver.requests
                    time.sleep(1)
                    btn = driver.find_element(By.CSS_SELECTOR, "#institution_reporter_list_row_"+str(j[1]))
                    driver.execute_script("arguments[0].click()",btn)
                    time.sleep(1)

                    request = driver.wait_for_request('.*/GetReferedListByReporter.*')
                    time.sleep(0.3)
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    after_job_list = []

                    for i in data:
                        after_job_list.append(i["JobKey"])
                    
                    try:
                        assert job_key in after_job_list
                    except:
                        testResult = "failed"
                        reason.append("1 steps failed\n")

        # 2 steps start! : Refer 된 Job와 Refer 되지 않은 Job을 함께 선택한다.
        # 테스트 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                driver.execute_script("arguments[0].click()",i)
                break

        driver.wait_for_request('.*/GetAllAssignedList.*')
        time.sleep(0.3)

        # All List 탭 클릭 후, job list 저장
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        request = driver.wait_for_request('.*/GetAllList.*')
        time.sleep(0.3)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        refer_job_list = []
        job_list = []

        for i in data:
            if i["ReferDate"] == None:
                job_list.append(i["JobKey"])
            else:
                refer_job_list.append(i["JobKey"])

        # Refer 된 job과 Refer 되지 않는 job을 함께 선택
        refer_job = random.choice(refer_job_list)
        not_refer_job = random.choice(job_list)

        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(refer_job)+"']").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "//td[normalize-space()='"+str(not_refer_job)+"']")))
        time.sleep(0.3)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(not_refer_job)+"']").click()

        # R.Cancel & Refer 버튼이 비활성화 상태인지 확인
        try:
            btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]")
            assert btn.get_property("disabled") == True
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")
        
        # 다음 테스트를 위해 선택 해제(새로고침)
        time.sleep(1)
        driver.refresh()

        # Test 병원 선택
        time.sleep(1)
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()
        
        del driver.requests
        time.sleep(1)

        # All List 탭 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        driver.wait_for_request('.*/GetAllList.*')
        time.sleep(0.3)

        # 3 steps start! : All Assigned/All List에서 Refer 된 Job을 선택한다.
        # All List > Refer 된 job 만 선택
        for i in range(0,3):
            refer_job_key = refer_job_list.pop(refer_job_list.index(random.choice(refer_job_list)))
            time.sleep(1)
            # driver.find_element(By.XPATH, "//td[normalize-space()='"+str(refer_job_key)+"']").click()
            element = driver.find_element(By.XPATH, "//label[@for='r_j_c_"+str(refer_job_key)+"']")
            driver.execute_script("arguments[0].click()",element)

        # R.Cancel & Refer 버튼이 활성화 상태인지 확인
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]")
        try:
            assert btn.get_property("disabled") == False
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 새로고침
        time.sleep(1)
        driver.refresh()
        del driver.requests

        # Test 병원 선택
        time.sleep(1)
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()
        
        # All Assigned List > job list 저장
        time.sleep(1)
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i["JobKey"])

        # 임의의 job 선택 후, R.Cancel & Refer 버튼이 활성화 상태인지 확인
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        time.sleep(1)

        try:
            assert driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]").get_property("disabled") == False
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : 임의의 의뢰 검사를 선택한 후, Refer Cancel & Refer 버튼을 클릭한다.
        # R.Cancel & Refer 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]").click()

        # R.Cancel & Refer 팝업창이 팝업되는지 확인
        try:
            popup_title = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[1]/h4")
            assert popup_title.get_property("textContent") == "Refer Cancel & Refer"
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # 5 steps start! : 판독의를 선택한 후, Save 버튼을 클릭한다.
        # R.Cancel & Refer 팝업창 > Reporter list 저장
        time.sleep(1)
        temp_list = ''
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        
        reporter_list = temp_list.split('\n')
        reporter_id_list = []

        for i in reporter_list:
            reporter_id_list.append(i.split()[0])

        # R.Cancel & Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(reporter_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # R.Cancel & Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # 선택한 Reporter ID 저장
        selected_reporter_id_list = []
        for i in selected_reporter_list:
            selected_reporter_id_list.append(i.split()[0])

        # R.Cancel & Refer 팝업창 > Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[3]/button[1]").click()

        # 테스트 병원에서 Refer 한 Reporter를 선택하고 refer 한 job이 job list에 있는지 확인
        for i in selected_reporter_id_list:
            for j in reporter_id_key_list:
                if j[0] == i:
                    del driver.requests
                    time.sleep(1)
                    btn = driver.find_element(By.CSS_SELECTOR, "#institution_reporter_list_row_"+str(j[1]))
                    try:
                        driver.execute_script("arguments[0].click()",btn)
                    except:
                        driver.find_element(By.CSS_SELECTOR, "#institution_reporter_list_row_"+str(j[1])).click()
                    time.sleep(1)

                    request = driver.wait_for_request('.*/GetReferedListByReporter.*')
                    time.sleep(0.3)
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    after_job_list = []

                    for i in data:
                        after_job_list.append(i["JobKey"])
                    
                    try:
                        assert job_key in after_job_list
                    except:
                        testResult = "failed"
                        reason.append("5 steps failed\n")

        # 6 steps start! : 판독의에게 할당된 임의의 의뢰 검사를 선택하고, Refer Cancel & Refer 버튼을 클릭한다.
        # 선택한 병원의 Reporter list 저장
        time.sleep(1)
        reporter_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-sub-item")
        reporter_cnt = len(reporter_list)
        select_reporter_list = []

        for i in reporter_list:
            select_reporter_list.append((i.get_property("dataset"))["reporterKey"])

        # 선택한 병원에서 임의의 Reporter 클릭
        time.sleep(1)
        del driver.requests
        time.sleep(1)
        reporter_key = (reporter_list[random.randrange(0,reporter_cnt)].get_property("dataset"))["reporterKey"]
        btn = driver.find_element(By.CSS_SELECTOR, "#institution_reporter_list_row_"+str(reporter_key))
        driver.execute_script("arguments[0].click()",btn)

        # Reporter의 refer 받은 job list 저장
        request = driver.wait_for_request('.*/GetReferedListByReporter.*')
        time.sleep(0.3)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        refer_job_list = []

        for i in data:
            refer_job_list.append(i["JobKey"])

        # 임의의 job 선택 후, R.Cancel & Refer 버튼 클릭
        job_key_list = []
        refer_job_cnt = len(refer_job_list)
        for i in range(0, len(refer_job_list) if refer_job_cnt < 2 else 2):
            job_key = refer_job_list.pop(refer_job_list.index(random.choice(refer_job_list)))
            time.sleep(1)
            driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
            job_key_list.append(job_key)
        time.sleep(1)

        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]").click()

        # R.Cancel & Refer 팝업창 > Reporter list 저장
        time.sleep(1)
        temp_list = ''
        temp_list = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul").get_property("outerText")
        
        reporter_list = temp_list.split('\n')
        reporter_id_list = []

        for i in reporter_list:
            reporter_id_list.append(i.split()[0])

        # R.Cancel & Refer 팝업창 > Reporter list에서 repoter의 수를 확인
        reporter_cnt = len(reporter_list)
        count_list = []
        if reporter_cnt > 1:
            for i in range(1, reporter_cnt+1):
                count_list.append(i)
        else:
            reporter_cnt = 1

        # R.Cancel & Refer 팝업창 > 임의의 Reporter를 임의의 숫자만큼 선택 후, reporter list 저장
        select_reporter_list = []
        selected_reporter_list = []
        if int(reporter_cnt) > 1:
            i = 0
            cnt = random.randrange(1, reporter_cnt+1)
            while i < int(cnt):
                n = count_list.pop(count_list.index(random.choice(count_list)))
                select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").get_property("textContent"))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li["+str(n)+"]").click()
                selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[2]/ul/li["+str(n)+"]").get_property("textContent"))
                i = i + 1
        else:
            select_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").click()
            selected_reporter_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div[2]/div[2]/div[1]/ul/li[1]").get_property("textContent"))

        # 선택한 Reporter ID 저장
        selected_reporter_id_list = []
        for i in selected_reporter_list:
            selected_reporter_id_list.append(i.split()[0])

        # R.Cancel & Refer 팝업창 > Save 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[3]/button[1]").click()

        # 테스트 병원에서 Refer 한 Reporter를 선택하고 refer 한 job이 job list에 있는지 확인
        for i in selected_reporter_id_list:
            for j in reporter_id_key_list:
                if j[0] == i:
                    del driver.requests
                    time.sleep(1)
                    btn = driver.find_element(By.CSS_SELECTOR, "#institution_reporter_list_row_"+str(j[1]))
                    driver.execute_script("arguments[0].click()",btn)
                    time.sleep(1)

                    request = driver.wait_for_request('.*/GetReferedListByReporter.*')
                    time.sleep(0.3)
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]
                    after_job_list = []

                    for i in data:
                        after_job_list.append(i["JobKey"])
                    
                    try:
                        for i in job_key_list:
                            assert i in after_job_list
                    except:
                        testResult = "failed"
                        reason.append("6 steps failed\n")

        # 7 steps start! : Not Assigned List로 이동한 후, 임의의 Job을 선택한다.
        # 다음 테스트를 위해 선택 해제(새로고침)
        time.sleep(1)
        driver.refresh()

        # Test 병원 선택
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Not Assigned List 탭 클릭 후, job list 저장
        time.sleep(1.5)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()

        request = driver.wait_for_request('.*/GetNotAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        not_assigned_job_list = []

        for i in data:
            not_assigned_job_list.append(i["JobKey"])

        # Not Assigned List > 임의의 job 선택
        job_key = random.choice(not_assigned_job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        
        # Not Assigned List > R.Cancel & Refer 버튼이 표시되지 않는지 확인
        try:
            btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[2]/button[4]")
            assert btn.get_property("disabled") == True
        except:
            testResult = "failed"
            reason.append("7 steps failed\n")

        # Refer Cancel and Refer 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1711, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1711, testPlanID, buildName, 'p', "Refer Cancel and Refer Passed")

    def Set_Schedule():
        print("ITR-34: Worklist > Set Schedule")
        testResult = ''
        reason = list()

        # 1 steps start! : Job stat이 Requested 인 임의의 의뢰 검사를 선택한 후, Schedule 버튼을 클릭한다.
        # 다음 테스트를 위해 선택 해제(새로고침)
        time.sleep(1)
        driver.refresh()

        # # Refer 탭 클릭
        # time.sleep(0.5)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # All Assigned List에서 schedule이 없는 job list 저장
        time.sleep(1)
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        before_assigned_job_list = []

        for i in data:
            if i["ScheduleDateDTTMString"] == "":
                before_assigned_job_list.append(i["JobKey"])

        # All Assigned List > 임의의 job 선택
        job_key = random.choice(before_assigned_job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # All Assigned List > Schedule 버튼 클릭
        schedule_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[1]")
        if schedule_btn.get_property("disabled") == False:
            for i in range(0,3):
                time.sleep(0.5)
                schedule_btn.click()

        # All Assigned List > Schedule 버튼 옆에 날짜와 시간 선택 기능이 표시되는지 확인
        input_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div")
        try:
            time.sleep(1)
            assert "display: inline-block" in input_date.get_attribute("style")
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : 임의의 날짜와 시간을 입력한 후, 확인 버튼을 클릭한다.
        # All Assigned List > Schedule 날짜는 기본값, 시간은 1030으로 입력 후, 체크 클릭
        input_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div/div/div[2]/div/div[1]/input").get_property("value")
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div/div/div[2]/div/div[2]/input").send_keys("1030")
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div/div/button").click()

        # Schedule 등록 완료 팝업창이 팝업되는지 확인
        try:
            popup_msg = driver.find_element(By.XPATH ,"/html/body/div[6]/h2")
            assert popup_msg.get_property("textContent") == "예약 환자가 등록되었습니다"
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # Schedule 팝업창 > 확인 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[6]/div[7]/div/button").click()

        # All Assigned List에서 schedule이 있는 job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        after_assigned_job_list = []

        for i in data:
            if i["ScheduleDateDTTMString"] != "":
                after_assigned_job_list.append(i)

        # 선택한 job의 Schedule 컬럼에 입력한 날짜와 시간이 표시되는지 확인
        try:
            for i in after_assigned_job_list:
                if i["JobKey"] == job_key:
                    check_date = i["ScheduleDateDTTMString"].split()[0]
                    check_time = i["ScheduleDateDTTMString"].split()[1]

            assert (check_date, check_time.replace(":", "")) == (input_date, "103000")
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Job stat이 Requested 인 임의의 의뢰 검사를 선택한 후, Schedule 버튼을 클릭한다.
        # All Assigned List > Schdule이 있는 임의의 job을 선택한 후, Schedule 버튼 클릭
        sample_job = random.choice(after_assigned_job_list)
        job_key = sample_job["JobKey"]
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        
        while(1):
            try:
                schedule_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[1]")
                webdriver.ActionChains(driver).move_to_element(schedule_btn).perform()
                WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[1]")))
                schedule_btn.click()
                break
            except:
                pass

        # All Assigned List > Schedule 버튼 옆에 날짜와 시간 선택 기능이 표시되는지 확인
        input_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div")
        try:
            time.sleep(1)
            assert "display: inline-block" in input_date.get_attribute("style")
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : 임의의 날짜와 시간을 입력한 후, 확인 버튼을 클릭한다.
        # All Assigned List > Schedule 날짜와 시간 입력 후, 체크 클릭
        check_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div/div/div[2]/div/div[1]/input")
        check_time = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div/div/div[2]/div/div[2]/input")
        input_date = (today + relativedelta(months=1)).strftime('%Y-%m-%d') 
        check_date.clear()
        check_date.send_keys(input_date)
        check_time.send_keys("1100")
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/div/div/button").click()

        # Schedule 팝업창이 팝업되는지 확인
        try:
            time.sleep(1)
            popup_msg = driver.find_element(By.XPATH ,"/html/body/div[6]/h2")
            assert popup_msg.get_property("textContent") == "예약 정보가 변경되었습니다"
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # Schedule 팝업창 > 확인 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[6]/div[7]/div/button").click()

        # All Assigned List의 job list 저장
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        change_assigned_job_list = []

        for i in data:
            change_assigned_job_list.append(i)

        # 선택한 job의 Schedule 컬럼에 입력한 날짜와 시간이 표시되는지 확인
        try:
            for i in change_assigned_job_list:
                if i["JobKey"] == job_key:
                    check_date = i["ScheduleDateDTTMString"].split()[0]
                    check_time = i["ScheduleDateDTTMString"].split()[1]
            assert (check_date, check_time.replace(":", "")) == ((today + relativedelta(months=1)).strftime('%Y-%m-%d'), "110000")
        except:
            testResult = "failed"
            reason.append("5 steps failed\n")

        # Set Schedule 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1718, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1718, testPlanID, buildName, 'p', "Set Schedule Passed")        

    def Schedule_Cancel():
        print("ITR-35: Worklist > Cancel Schedule")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Schedule이 없는 임의의 의뢰 job을 선택한 후, Schedule Cancel 버튼을 클릭한다.
        # Refer 탭 클릭
        time.sleep(0.5)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # All Assigned List에서 schedule이 없는 job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        not_schedule_job_list = []

        for i in data:
            if i["ScheduleDate"] == None:
                not_schedule_job_list.append(i)

        # All Assigned List > Schedule이 없는 임의의 job 선택
        sample_job = random.choice(not_schedule_job_list)
        job_key = sample_job["JobKey"]
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # All Assigned List > S.Cancel 클릭
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[2]")
        if btn.get_property("disabled") == False:
            driver.execute_script("arguments[0].click()",btn)

        # S.Cancel 팝업창 확인
        time.sleep(1)
        popup = driver.find_element(By.XPATH, "/html/body/div[6]/h2")
        try:
            assert popup.get_property("textContent") == "예약건만 취소 가능합니다"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # OK 버튼 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[6]/div[7]/div/button").click()

        # 2 steps start! : Schedule이 있는 임의의 의뢰 job을 선택한 후, Schedule Cancel 버튼을 클릭한다.
        # All Assigned List에서 schedule이 있는 job list 저장
        while(1):
            try:
                del driver.requests
                time.sleep(1)

                WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]")))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()
                break
            except:
                # 새로고침
                driver.refresh()

                # 1 steps start! : 판독의가 할당된 의뢰 검사를 선택한 후, Refer Cancel 버튼을 클릭한다.
                # Refer 탭 클릭
                time.sleep(1)
                # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

                # Test 병원 선택
                hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
                for i in hospital_list:
                    if (i.get_property("dataset"))["institutionName"] == test_hospital:
                        i.click()
                        break

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        time.sleep(0.3)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        schedule_job_list = []

        for i in data:
            if i["ScheduleDate"] != None:
                schedule_job_list.append(i)

        # All Assigned List > Schedule이 있는 임의의 job 선택
        sample_job = random.choice(schedule_job_list)
        job_key = sample_job["JobKey"]
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # All Assigned List > S.Cancel 클릭
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[2]")
        if btn.get_property("disabled") == False:
            driver.execute_script("arguments[0].click()",btn)

        # S.Cancel 팝업창 확인
        time.sleep(1)
        popup = driver.find_element(By.XPATH, "/html/body/div[6]/h2")
        try:
            assert popup.get_property("textContent") == "예약이 취소되었습니다"
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # OK 버튼 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[6]/div[7]/div/button").click()

        # All Assigned List > Schedule이 없는 job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        not_schedule_job_list = []

        for i in data:
            if i["ScheduleDate"] != None:
                not_schedule_job_list.append(i)

        # schedule 컬럼에서 S.Cancel 했던 job의 정보가 표시되지 않는지 확인
        try:
            for i in not_schedule_job_list:
                if i["JobKey"] == job_key:
                    assert i["ScheduleDateDTTMString"] == ""
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : 임의의 의뢰 검사를 선택한 후, Schedule 버튼을 클릭한다.
        # All Assigned List > job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()

        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        schedule_job_list = []
        non_schedule_job_list = []

        for i in data:
            if i["ScheduleDate"] != None:
                schedule_job_list.append(i)
            else:
                non_schedule_job_list.append(i)

        # All Assigned List > Schedule 있는 job과 Schedule이 없는 job을 함께 선택
        schedule_job = (random.choice(schedule_job_list))["JobKey"]
        non_schedule_job = (random.choice(non_schedule_job_list))["JobKey"]
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(schedule_job)+"']").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(non_schedule_job)+"']").click()

        # All Assigned List > Schedule 버튼 클릭
        time.sleep(1)
        del driver.requests
        time.sleep(1)

        while(1):
            try:
                schedule_btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[1]")
                webdriver.ActionChains(driver).move_to_element(schedule_btn).perform()
                WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[1]")))
                schedule_btn.click()
                break
            except:
                pass
        
        # Schedule 팝업창 확인
        popup = driver.find_element(By.XPATH, "/html/body/div[6]/h2")
        try:
            assert popup.get_property("textContent") == "동일한 예약상태가 아닌 경우 수정이 불가합니다"
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # OK 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/div[6]/div[7]/div/button").click()

        # 4 steps start! : 임의의 의뢰 검사를 선택한 후, Schedule Cancel 버튼을 클릭한다.
        # All Assigned List > S.Cancel 클릭
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[2]")
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[4]/button[2]")))
        btn.click()
        

        # S.Cancel 팝업창 확인
        time.sleep(1)
        popup = driver.find_element(By.XPATH, "/html/body/div[6]/h2")
        try:
            assert popup.get_property("textContent") == "동일한 예약상태가 아닌 경우 취소가 불가합니다"
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # S.Cancel 팝업창 > OK 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[6]/div[7]/div/button").click()
        
        # Schedule 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1724, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1724, testPlanID, buildName, 'p', "Schedule Passed")    

    def Revised():
        print("ITR-36: Worklist > Revised")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Job Status가 Completed 상태인 의뢰 검사를 선택한 후, Revised 버튼을 클릭한다.
        # Configuration > Institutions > 테스트 병원 선택
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/button[4]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys("997")
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys(Keys.RETURN)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#i_l_997").click()
        
        # Configuration > Institutions > Institution Modify > Enable Revised 체크
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[1]/h3")
        revised = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[7]/div/div/input")
        time.sleep(1)
        try:
            if popup.get_property("textContent") == "Institutions Modify":
                if revised.get_property("checked") == False:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[7]/div/div/label").click()
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[3]/div/button[2]").click()
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
            time.sleep(1.5)
            driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Refer 탭 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # All List 탭 클릭 후, job list 저장
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i)

        # Search Condition > Job status를 Completed로 선택 후, Search 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        time.sleep(0.25)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[5]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()

        # All List > Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        search_job_list = []

        for i in data:
            search_job_list.append(i)

        # All List > 검색 결과 중 임의의 job 선택
        try:
            sample_job = random.choice(search_job_list)
            job_key = sample_job["JobKey"]
            time.sleep(1)
            driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        except IndexError:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Revised 클릭
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[1]")
        if btn.get_property("disabled") == False:
            driver.execute_script("arguments[0].click()",btn)
        
        # Update Request Status 팝업창 확인
        time.sleep(0.5)
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[1]/h4")
        try:
            assert popup.get_property("textContent") == "Update Request Status"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Update Request Status 팝업창 > Close 클릭
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[2]").click()

        # 다시 Revised 클릭
        if btn.get_property("disabled") == False:
            driver.execute_script("arguments[0].click()",btn)

        # Update Request Status 팝업창 > OK 클릭
        time.sleep(0.5)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[1]").click()

        # All List > job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        change_job_list = []

        for i in data:
            change_job_list.append(i)

        # Completed job list에서 Revised 한 job이 사라졌는지 확인
        try:
            for i in change_job_list:
                assert i["JobKey"] != job_key
        except IndexError:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Revised 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1730, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1730, testPlanID, buildName, 'p', "Revised Passed")    

    def Discard():
        print("ITR-37: Worklist > Discard")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : 임의의 의뢰 검사를 선택한 후, Discard 버튼을 클릭한다.
        # Configuration > Institutions > 테스트 병원 선택
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/button[4]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys("997")
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys(Keys.RETURN)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#i_l_997").click()
        
        # Configuration > Institutions > Institution Modify > Enable Discard 체크
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[1]/h3")
        discard = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[8]/div/div/input")
        time.sleep(1)
        try:
            if popup.get_property("textContent") == "Institutions Modify":
                if discard.get_property("checked") == False:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[8]/div/div/label").click()
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[3]/div/button[2]").click()
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
            time.sleep(1.5)
            driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Refer 탭 클릭
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # All Assigend List > job list 저장
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i)

        # All Assigend List > 임의의 job 선택
        sample_job = random.choice(job_list)
        job_key = sample_job["JobKey"]
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # All Assigend List > Discard 클릭
        time.sleep(1)
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[2]")
        if btn.get_property("disabled") == False:
            driver.execute_script("arguments[0].click()",btn)

        # Discard 팝업창 확인
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[1]/h4")
        try:
            assert popup.get_property("textContent") == "Update Request Status"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # Discard 팝업창 > Close 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[2]").click()

        # All Assigend List > job list 저장
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[1]").click()
        time.sleep(1)
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        close_job_list = []

        for i in data:
            close_job_list.append(i)

        # Discard 이전의 job list와 비교
        try:
            assert len(job_list) == len(close_job_list)
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # All Assigend List > 임의의 job 선택
        sample_job = random.choice(job_list)
        job_key = sample_job["JobKey"]
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        
        # All Assigend List > Discard 클릭
        time.sleep(1)
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[2]")
        if btn.get_property("disabled") == False:
            driver.execute_script("arguments[0].click()",btn)

        # Discard 팝업창 > OK 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[1]").click()

        # All Assigend List > job list 저장
        request = driver.wait_for_request('.*/GetAllAssignedList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        discard_job_list = []

        for i in data:
            discard_job_list.append(i)

        # Discard 후, 이전의 job list에서 해당 job이 사라졌는지 확인
        try:
            assert job_key not in discard_job_list
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! :Job Stauts가 DiscardRequest 인 의뢰 검사를 선택한 후, Discard 버튼을 클릭한다.
        # All List 탭 클릭
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Search filter > Job status를 DiscardRequest로 선택 후, Search 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[12]").click()
        time.sleep(0.5)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
        time.sleep(1)

        # 조회 결과의 job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        discard_job_list = []

        for i in data:
            discard_job_list.append(i)

        # All List > 임의의 job 선택
        sample_job = random.choice(discard_job_list)
        job_key = sample_job["JobKey"]
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()

        # Discard 버튼이 비활성화 상태인지 확인
        try:
            btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[2]")
            assert btn.get_property("disabled") == True
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")
        
        # Discard 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1733, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1733, testPlanID, buildName, 'p', "Discard Passed")    

    def Retry_Request():
        print("ITR-38: Worklist > Retry Request")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Job Status가 Reported, Completed, Recalled 이외의 상태인 의뢰 검사를 선택한 후, Retry Request 버튼을 클릭한다.
        # Configuration > Institutions > 테스트 병원 선택
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[5]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/button[4]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys("997")
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[1]/div[2]/div/div[1]/div/div/input").send_keys(Keys.RETURN)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#i_l_997").click()
        
        # Configuration > Institutions > Institution Modify > Enable Request 체크
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[1]/h3")
        discard = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[9]/div/div/input")
        time.sleep(1)
        try:
            if popup.get_property("textContent") == "Institutions Modify":
                if discard.get_property("checked") == False:
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[9]/div/div/label").click()
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[3]/div/button[2]").click()
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
            time.sleep(1.5)
            driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Refer 탭 클릭
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Show entries를 100개로 변경
        Common.refer_show_entries(100)

        # All List 탭 클릭
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Search condition > Job Status를 All로 선택하고, Search 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div").click()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[1]/div[2]/div/div/ul/li[1]").click()
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div[6]/button").click()
        time.sleep(1)

        # All List > Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            if i["StatDescription"] in ("Requested","Canceled2","DiscardCompleted"):
                job_list.append(i)

        # Job status가 Reported, Completed, Recalled 외의 임의의 job을 선택
        try:
            sample_job = random.choice(job_list)
            job_key = sample_job["JobKey"]
            time.sleep(1)
            driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")
        
        # Retry Request 클릭
        time.sleep(2)
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[3]")
        driver.execute_script("arguments[0].click()",btn)

        # Retry Request 팝업창 확인
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[1]/h4")
        try:
            popup.get_property("textContent") == "Update Request Status"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # Retry Request 팝업창 > Close 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[2]").click()

        # All List > Retry Request 클릭
        time.sleep(1.5)
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[3]")
        driver.execute_script("arguments[0].click()",btn)

        # Retry Request 팝업창 > OK 클릭
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[1]").click()

        # All List > Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i)
    
        # All List > Job list에서 선택했던 job의 job status가 RetryRequest로 변경되었는지 확인
        try:
            for i in job_list:
                if i["JobKey"] == job_key:
                    assert i["StatDescription"] == "RetryRequest"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Job status가 DiscardCompleted 인 임의의 job을 선택한 후, Retry Request 버튼을 클릭한다.
        # Job status가 DiscardCompleted 인 임의의 job을 선택 후, Retry Request 클릭
        job_list = []
        for i in data:
            if i["StatDescription"] =="DiscardCompleted":
                job_list.append(i)

        # Job status가 DiscardCompleted 인 임의의 job을 선택
        try:
            sample_job = random.choice(job_list)
            job_key = sample_job["JobKey"]
            time.sleep(3)
            driver.find_element(By.XPATH, "//td[normalize-space()='"+str(job_key)+"']").click()
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # Retry Request 클릭
        time.sleep(1)
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[3]")
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[3]")))
        btn.click()

        # Retry Request 팝업창 확인
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[1]/h4")
        try:
            popup.get_property("textContent") == "Update Request Status"
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # Retry Request 팝업창 > Close 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[2]").click()

        # All List > Retry Request 클릭
        time.sleep(1)
        btn = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[3]/button[3]")
        driver.execute_script("arguments[0].click()",btn)

        # Retry Request 팝업창 > OK 클릭
        time.sleep(0.5)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[14]/div/div/div[3]/button[1]").click()

        # All List > Job list 저장
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []

        for i in data:
            job_list.append(i)
    
        # All List > Job list에서 선택했던 job의 job status가 RetryRequest로 변경되었는지 확인
        try:
            for i in job_list:
                if i["JobKey"] == job_key:
                    assert i["StatDescription"] == "RetryRequest"
        except:
            testResult = "failed"
            reason.append("2 steps failed\n") 

        # Retry Request 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1737, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1737, testPlanID, buildName, 'p', "Retry Request Passed")    

    def Columns():
        print("ITR-39: Worklist > Columns")
        testResult = ''
        reason = list()

        # 1 steps start! : Columns 버튼을 클릭한다.
        # 새로고침
        time.sleep(1)
        driver.refresh()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # All Assigned List > Column list 저장
        column_list = []
        columns = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr").get_property("outerText")
        column_list = columns.split('\t')
        del column_list[0]

        # Columns 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[5]/div[1]/button").click()

        # Columns 팝업창 확인
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[1]/h4")
        try:
            popup.get_property("textContent") == "Display Column Setting"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n") 

        # 2 steps start! : Not Display Column과 Display Column에 컬럼들을 위치시키고 Save 버튼을 클릭한다.
        # Columns 팝업창 > Display Column의 column list 저장
        time.sleep(1)
        diplay_column_list = []
        display_column_index_list = []
        display_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/select/option")
        for i in display_column:
            temp = []
            temp.append(i.text)
            temp.append(i.get_attribute("value"))
            display_column_index_list.append(i.text)
            diplay_column_list.append(temp)

        # Columns 팝업창 > Display Column에서 임의의 Column을 선택해서 Not Display Column으로 변경
        select_column = random.choice(display_column_index_list)
        for i in diplay_column_list:
            if i[0] == select_column:
                driver.find_element(By.CSS_SELECTOR, "#job-column-setting-selected-"+str(i[1])).click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[2]/button[2]").click()

        # Columns 팝업창 > Display Column의 column list 저장
        time.sleep(1)
        diplay_column_list = []
        display_column_index_list = []
        display_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/select/option")
        for i in display_column:
            temp = []
            temp.append(i.text)
            temp.append(i.get_attribute("value"))
            display_column_index_list.append(i.text)
            diplay_column_list.append(temp)

        # Save 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[3]/button[1]").click()

        # All Assigned List > Column list 저장
        time.sleep(4)
        column_list = []
        columns = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr").get_property("outerText")
        column_list = columns.split('\t')
        del column_list[0]

        # Display Column의 column list와 All Assigned List의 Column list 비교
        try: 
            assert column_list == display_column_index_list
        except:
            testResult = "failed"
            reason.append("2 steps failed\n") 

        # 3 steps start! : Display Column에서 임의의 column을 선택하고, Up 버튼을 클릭한 후, Save 버튼을 클릭한다.
        # Columns 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[5]/div[1]/button").click()

        # Display Column에서 임의의 column을 선택하고, Up 버튼 클릭
        time.sleep(1)
        select_column = random.choice(display_column_index_list)
        for i in diplay_column_list:
            if i[0] == select_column:
                driver.find_element(By.CSS_SELECTOR, "#job-column-setting-selected-"+str(i[1])).click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/div/button[1]").click()

        # Columns 팝업창 > Display Column의 column list 저장
        time.sleep(1)
        diplay_column_list = []
        display_column_index_list = []
        display_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/select/option")
        for i in display_column:
            temp = []
            temp.append(i.text)
            temp.append(i.get_attribute("value"))
            display_column_index_list.append(i.text)
            diplay_column_list.append(temp)

        # Save 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[3]/button[1]").click()

        # All Assigned List > Column list 저장
        time.sleep(4)
        column_list = []
        columns = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr").get_property("outerText")
        column_list = columns.split('\t')
        del column_list[0] 

        # Display Column의 column list와 All Assigned List의 Column list 비교
        try:
            assert column_list == display_column_index_list
        except:
            testResult = "failed"
            reason.append("3 steps failed\n") 

        # 4 steps start! : Display Column에서 임의의 column을 선택하고, Down 버튼을 클릭한 후, Save 버튼을 클릭한다.
        # Columns 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[5]/div[1]/button").click()

        # Display Column에서 임의의 column을 선택하고, Down 버튼 클릭
        time.sleep(1)
        select_column = random.choice(display_column_index_list)
        for i in diplay_column_list:
            if i[0] == select_column:
                driver.find_element(By.CSS_SELECTOR, "#job-column-setting-selected-"+str(i[1])).click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/div/button[2]").click()

        # Columns 팝업창 > Display Column의 column list 저장
        time.sleep(1)
        display_column_index_list = []
        display_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/select/option")
        for i in display_column:
            temp = []
            temp.append(i.text)
            temp.append(i.get_attribute("value"))
            display_column_index_list.append(i.text)

        # Save 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[3]/button[1]").click()

        # All Assigned List > Column list 저장
        time.sleep(3)
        column_list = []
        columns = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr").get_property("outerText")
        column_list = columns.split('\t')
        del column_list[0] 

        # Display Column의 column list와 All Assigned List의 Column list 비교
        try:
            assert column_list == display_column_index_list
        except:
            testResult = "failed"
            reason.append("4 steps failed\n") 

        # 5 steps start! : Reset 버튼을 클릭한다.
        # Columns 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[5]/div[1]/button").click()

        # Reset 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[1]/div/button").click()

        # Columns 팝업창 > Display Column의 column list 저장
        time.sleep(1)
        diplay_column_list = []
        display_column_index_list = []
        display_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/select/option")
        for i in display_column:
            temp = []
            temp.append(i.text)
            temp.append(i.get_attribute("value"))
            display_column_index_list.append(i.text)
            diplay_column_list.append(temp)

        # Save 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[3]/button[1]").click()

        # All Assigned List > Column list 저장
        time.sleep(3)
        column_list = []
        columns = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr").get_property("outerText")
        column_list = columns.split('\t')
        del column_list[0] 

        # Display Column의 column list와 All Assigned List의 Column list 비교
        try:
            assert column_list == display_column_index_list
        except:
            testResult = "failed"
            reason.append("5 steps failed\n") 

        # 6 steps start! : Column의 상태를 임의대로 변경한 후, Cancel 버튼을 클릭한다.
        # Columns 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[5]/div[1]/button").click()

        # Display Column에서 임의의 column을 선택하고, Up 버튼 클릭
        time.sleep(1)
        select_column = random.choice(display_column_index_list)
        for i in diplay_column_list:
            if i[0] == select_column:
                driver.find_element(By.CSS_SELECTOR, "#job-column-setting-selected-"+str(i[1])).click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/div/button[1]").click()

        # Display Column에서 임의의 column을 선택하고, Down 버튼 클릭
        time.sleep(1.5)
        select_column = random.choice(display_column_index_list)
        for i in diplay_column_list:
            if i[0] == select_column:
                driver.find_element(By.CSS_SELECTOR, "#job-column-setting-selected-"+str(i[1])).click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/div/button[2]").click()

        # Columns 팝업창 > Display Column의 column list 저장
        time.sleep(1)
        display_column_index_list = []
        display_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[2]/div/div/div[3]/select/option")
        for i in display_column:
            temp = []
            temp.append(i.text)
            temp.append(i.get_attribute("value"))
            display_column_index_list.append(i.text)
        
        # Cancel 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[18]/div/div/div[3]/button[2]").click()

        # All Assigned List > Column list 저장
        time.sleep(3)
        column_list = []
        columns = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr").get_property("outerText")
        column_list = columns.split('\t')
        del column_list[0]

        # Display Column의 column list와 All Assigned List의 Column list 비교
        try:
            assert column_list != display_column_index_list
        except:
            testResult = "failed"
            reason.append("6 steps failed\n") 
        
        # Columns 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1741, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1741, testPlanID, buildName, 'p', "Columns Passed")    

    def Show_Entries():
        print("ITR-40: Worklist > Show entries")
        testResult = ''
        reason = list()
        
        # 새로고침
        driver.refresh()

        # 1 steps start! : Show entries의 개수를 10으로 변경한다.
        # Refer 탭 클릭
        time.sleep(0.5)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # All List 탭 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()

        # Show entries를 10으로 변경
        Common.refer_show_entries(10)

        # Showing entries 값 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3]

        # All List > Job list의 개수가 10개로 표시되는지 확인
        try:
            if int(temp_cnt[5]) > 10:
                assert int(list_cnt) == 10
        except:
            testResult = "failed"
            reason.append("1 steps failed\n") 

        # 2 steps start! : Show entries의 개수를 25으로 변경한다.
        # Show entries를 25로 변경
        Common.refer_show_entries(25)

        # Showing entries 값 저장
        time.sleep(1)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3]

        # All List > Job list의 개수가 25개로 표시되는지 확인
        try:
            if int(temp_cnt[5]) > 25:
                assert int(list_cnt) == 25
        except:
            testResult = "failed"
            reason.append("2 steps failed\n") 

        # 3 steps start! : Show entries의 개수를 50으로 변경한다.
        # Show entries를 50으로 변경
        Common.refer_show_entries(50)

        # Showing entries 값 저장
        time.sleep(1)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3]

        # All List > Job list의 개수가 50개로 표시되는지 확인
        try:
            if int(temp_cnt[5]) > 50:
                assert int(list_cnt) == 50
        except:
            testResult = "failed"
            reason.append("3 steps failed\n") 

        # 4 steps start! : Show entries의 개수를 100으로 변경한다.
        # Show entries를 100로 변경
        Common.refer_show_entries(100)

        # Showing entries 값 저장
        time.sleep(1)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[1]/div/div[2]/div[1]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3]

        # All List > Job list의 개수가 100개로 표시되는지 확인
        try:
            if int(temp_cnt[5]) > 100:
                assert int(list_cnt) == 100
        except:
            testResult = "failed"
            reason.append("4 steps failed\n") 
        
        # Show entries 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1749, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1749, testPlanID, buildName, 'p', "Show entries Passed")  

    def Use_Related_Worklist():
        print("ITR-224: Worklist > Use Related Worklist")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # 1 steps start! : Use Related Worklist에 체크한 후, worklist에서 임의의 의뢰 검사를 선택한다.
        # Refer 탭 클릭
        time.sleep(0.5)
        # driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[3]").click()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # Use Related Worklist 체크
        time.sleep(1)
        check = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[5]/div[3]/input")
        if check.get_property("checked") == False:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[1]/div[5]/div[3]/label").click()

        # All List 탭 클릭 후, job list 저장
        time.sleep(1)
        del driver.requests
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()
        
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        job_list = []
        temp = []
        
        # All List > job list에서 동일한 Patient ID가 2개 이상인 P.ID를 찾기
        for i in data:
            if i["PatientID"] not in temp:
                temp.append(i["PatientID"])
            else:
                job_list.append(i["JobKey"])

        # All List > 해당 P.ID의 job 선택
        job_key = random.choice(job_list)
        time.sleep(1)
        driver.find_element(By.XPATH, "//td[normalize-space()="+str(job_key)+"]").click()

        # All List > Job list에서 Related worklist가 표시되는지 확인
        try:
            assert driver.find_element(By.CSS_SELECTOR, "#refer-related-list_wrapper").get_property("id") == "refer-related-list_wrapper"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n") 
        
        # Use Related Worklist 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(3074, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(3074, testPlanID, buildName, 'p', "Use Related Worklist Passed")  

    def Sort_By():
        print("ITR-41: Worklist > Sort By")
        testResult = ''
        reason = list()

        signInOut.admin_sign_in()

        # 1 steps start! : 정렬 가능한 컬럼을 확인한다.
        # 새로고침
        driver.refresh()

        # Test 병원 선택
        time.sleep(1)
        del driver.requests
        hospital_list = driver.find_elements(By.CLASS_NAME, "list-group-item.list-institution")
        for i in hospital_list:
            if (i.get_property("dataset"))["institutionName"] == test_hospital:
                i.click()

        # All Assigend List > 정렬이 가능한 컬럼 저장
        time.sleep(1)
        columns = driver.find_elements(By.XPATH,"/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr/th")
        column_list = []
        for i in columns:
            if "sort" in i.get_attribute("aria-label"):
                column_list.append(i.get_property("textContent"))

        # All Assigend List > 정렬 가능한 컬럼이 맞는지 확인
        sort_column_list = ["E","I.CNT","P.ID","P.Name","Study Date","Job Date","Upload Date","Mod","Bodypart","Study Desc","Request Name","Department","Schedule","Emer Date","AI Vendor","AI Complex Score","AI Finding Cnt","AI Probability","AI Disease NM","AI Service","Emer Modifier ","Refer Date "]
        try:
            # assert column_list.sort() in sort_column_list.sort() or column_list.sort() == sort_column_list.sort()
            for i in column_list:
                assert i in sort_column_list
        except:
            testResult = "failed"
            reason.append("1 steps failed\n") 

        # Not Assigend List > 정렬이 가능한 컬럼 저장
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[2]").click()
        time.sleep(1)
        columns = driver.find_elements(By.XPATH,"/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/thead/tr/th")
        column_list = []
        for i in columns:
            if "sort" in i.get_attribute("aria-label"):
                column_list.append(i.get_property("textContent"))

        # 정렬 가능한 컬럼이 맞는지 확인
        sort_column_list = ["E","I.CNT","P.ID","P.Name","Study Date","Job Date","Upload Date","Mod","Bodypart","Study Desc","Request Name","Department","Schedule","Emer Date","AI Vendor","AI Complex Score","AI Finding Cnt","AI Probability","AI Disease NM","AI Service","Emer Modifier ","Refer Date "]
        try:
            for i in column_list:
                assert i in sort_column_list
        except:
            testResult = "failed"
            reason.append("1 steps failed\n") 
        
        # All List > 정렬이 가능한 컬럼 저장
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[1]/ul/li[3]").click()
        time.sleep(1)
        columns = driver.find_elements(By.CSS_SELECTOR,"#refer-assigned-list_wrapper > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th")
        column_list = []

        for i in columns:
            temp_list = []
            temp = i.get_attribute("class")
            temp_list = temp.split()
            if "sorting" in temp_list:
                column_list.append(i.get_property("textContent"))

        # 정렬 가능한 컬럼이 맞는지 확인
        sort_column_list = ["Job Date"]
        try:
            assert column_list == sort_column_list
        except:
            testResult = "failed"
            reason.append("1 steps failed\n") 

        # Sort By 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1755, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1755, testPlanID, buildName, 'p', "Sort By Passed")  

class Statistics:
    def SearchFilter_Date():
        print("ITR-44: Statistics > Search Filter > Date")
        testResult = ''
        reason = list()

        # 새로고침
        driver.refresh()

        # DB 접속
        os.putenv('NLS_LANG', '.UTF8')
        cx_Oracle.init_oracle_client(lib_dir=r"D:\app\user\instantclient_21_7")
        connection = cx_Oracle.connect("pantheon","pantheon","211.43.8.73:1521/spectra", encoding="UTF-8")
        cursor = connection.cursor()

        # 1 steps start! : Date를 Study Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # Statistics 탭 클릭
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[1]/ul/li[4]").click()

        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # Study Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # 임의의 병원 선택
        time.sleep(1)
        temp_hospital_cnt_list = []
        hospital_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/ul/li")
        hospital_cnt = len(hospital_list) - 1

        for i in range(2, hospital_cnt):
            temp_hospital_cnt_list.append(i)

        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        result_list = []
        pat_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)
        
        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        sql = f"""
            select patient_id from MVIEWINSTSTAT 
            where study_dttm >= to_date('{start_date}', 'YYYY-MM-DD') and study_dttm <= to_date('{end_date}', 'YYYY-MM-DD')
            and institution_code in ('{inst_code}')
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)
        
        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Date를 Request Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()

        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Date를 Requested Date로 선택
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]")))
        driver.find_element(By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[1]/div/div/ul/li[2]").click()

        # Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        time.sleep(1)
        result_list = []
        pat_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)

        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        sql = f"""
            select patient_id from MVIEWINSTSTAT 
            where job_dttm >= to_date('{start_date}', 'YYYY-MM-DD') and job_dttm <= to_date('{end_date}', 'YYYY-MM-DD')
            and institution_code in ('{inst_code}')            
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)

        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Date를 Report Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()
        
        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Date를 Report Date로 선택
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]")))
        driver.find_element(By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[1]/div/div/ul/li[3]").click()

        # Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        time.sleep(1)
        result_list = []
        pat_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
            
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)

        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        sql = f"""
            select patient_id from MVIEWINSTSTAT 
            where report_dttm >= to_date('{start_date}', 'YYYY-MM-DD') and report_dttm <= to_date('{end_date}', 'YYYY-MM-DD')
            and institution_code in ('{inst_code}')            
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)

        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : Date를 Completed Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()
        
        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Date를 Completed Date로 선택
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]")))
        driver.find_element(By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[1]/div/div/ul/li[4]").click()

        # Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        time.sleep(1)
        result_list = []
        pat_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)

        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        sql = f"""
            select patient_id from MVIEWINSTSTAT 
            where completed_dttm >= to_date('{start_date}', 'YYYY-MM-DD') and completed_dttm <= to_date('{end_date}', 'YYYY-MM-DD')
            and institution_code in ('{inst_code}')   
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)

        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # 5 steps start! : Date를 Bill Month로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()
        
        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Date를 Bill Month로 선택
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]")))
        driver.find_element(By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[1]/div[1]/div[1]").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[1]/div/div/ul/li[5]").click()

        # Date 선택
        time.sleep(2)
        close_year = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[3]/div[1]/div/a").get_property("textContent")
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[3]/div[2]/div/a").click()
        close_month = int(today.strftime('%m')) - 2
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[3]/div[2]/div/div/ul/li["+str(close_month)+"]").click()
        time.sleep(1)

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        time.sleep(1)
        result_list = []
        pat_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)

        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        if len(str(close_month)) < 2:
            close_month = '0' + str(close_month)
        sql = f"""
            select patient_id from closedbill 
            where closed_year = '{close_year}'
            and closed_month = '{close_month}'
            and closed_stat = 'Y'
            and institution_code in ('{inst_code}')
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)

        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("5 steps failed\n")

        # DB 연결 해제
        cursor.close()
        connection.close()
        
        # Search Filter > Date 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1772, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1772, testPlanID, buildName, 'p', "Search Filter > Date Passed")  

    def SearchFilter_Hospital():
        print("ITR-45: Statistics > Search Filter > Hospital")
        testResult = ''
        reason = list()

        # DB 접속
        os.putenv('NLS_LANG', '.UTF8')
        cx_Oracle.init_oracle_client(lib_dir=r"D:\app\user\instantclient_21_7")
        connection = cx_Oracle.connect("pantheon","pantheon","211.43.8.73:1521/spectra", encoding="UTF-8")
        cursor = connection.cursor()

        # 1 steps start! : Date를 Study Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()

        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # Study Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # 임의의 병원 선택
        time.sleep(1)
        temp_hospital_cnt_list = []
        hospital_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/ul/li")
        hospital_cnt = len(hospital_list) - 1

        for i in range(2, hospital_cnt):
            temp_hospital_cnt_list.append(i)

        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        result_list = []
        pat_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)
        
        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        sql = f"""
            select patient_id from MVIEWINSTSTAT 
            where study_dttm >= to_date('{start_date}', 'YYYY-MM-DD') and study_dttm <= to_date('{end_date}', 'YYYY-MM-DD')
            and institution_code in ('{inst_code}')
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)
        
        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # DB 연결 해제
        cursor.close()
        connection.close()
        
        # Search Filter > Hospital 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1779, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1779, testPlanID, buildName, 'p', "Search Filter > Hospital Passed")  

    def SearchFilter_Reporter():
        print("ITR-46: Statistics > Search Filter > Reporter")
        testResult = ''
        reason = list()

        # DB 접속
        os.putenv('NLS_LANG', '.UTF8')
        cx_Oracle.init_oracle_client(lib_dir=r"D:\app\user\instantclient_21_7")
        connection = cx_Oracle.connect("pantheon","pantheon","211.43.8.73:1521/spectra", encoding="UTF-8")
        cursor = connection.cursor()

        # 1 steps start! : Date를 Study Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()

        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # Study Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # 임의의 병원 선택
        time.sleep(1)
        temp_hospital_cnt_list = []
        hospital_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/ul/li")
        hospital_cnt = len(hospital_list) - 1

        for i in range(2, hospital_cnt):
            temp_hospital_cnt_list.append(i)
        
        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#statistics-search-hospital")))
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        result_list = []
        pat_list = []
        reporter_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
                if i.get_property("outerText").split('\t')[1] not in reporter_list:
                    reporter_list.append(i.get_property("outerText").split('\t')[1])
            WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institution-interpretation-list_next > a")))
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)
        
        # 조회 결과 내에서 임의의 Reporter 선택
        select_reporter = random.choice(reporter_list)

        # 새로고침
        driver.refresh()

        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Study Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # 이전에 찾았던 병원 선택
        time.sleep(2)
        driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
        time.sleep(1)
        hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
        hospital.click()

        # Search filter에 임의의 Reporter ID 입력 후, Search 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html[1]/body[1]/section[1]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/div[2]/div[2]/div[1]").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[2]/div/ul/li/input").send_keys(select_reporter)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[2]/div/ul/li/input").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

        # Showing entry 결과 저장
        time.sleep(4)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]
        list_cnt = list_cnt.replace(",","")

        # 조회 결과 저장
        time.sleep(4)
        result_list = []
        pat_list = []
        reporter_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            # result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
                reporter_list.append(i.get_property("outerText").split('\t')[1])
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)

        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        sql = f"""
            select patient_id from MVIEWINSTSTAT 
            where study_dttm >= to_date('{start_date}', 'YYYY-MM-DD') and study_dttm <= to_date('{end_date}', 'YYYY-MM-DD')
            and institution_code in ('{inst_code}')
            and reporter_id = '{select_reporter}'
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)
        
        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # DB 연결 해제
        cursor.close()
        connection.close()

        # Search Filter > Reporter 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else testResult)
        if testResult == 'failed':
            testlink.reportTCResult(1782, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1782, testPlanID, buildName, 'p', "Search Filter > Reporter Passed")  

    def SearchFilter_Modality():
        print("ITR-47: Statistics > Search Filter > Modality")
        testResult = ''
        reason = list()

        # DB 접속
        os.putenv('NLS_LANG', '.UTF8')
        cx_Oracle.init_oracle_client(lib_dir=r"D:\app\user\instantclient_21_7")
        connection = cx_Oracle.connect("pantheon","pantheon","211.43.8.73:1521/spectra", encoding="UTF-8")
        cursor = connection.cursor()

        # 1 steps start! : Date를 Study Date로 선택하고, 임의의 기간을 입력한 후, Search 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()

        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # Study Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # 임의의 병원 선택
        time.sleep(1)
        temp_hospital_cnt_list = []
        hospital_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/ul/li")
        hospital_cnt = len(hospital_list) - 1

        for i in range(2, hospital_cnt):
            temp_hospital_cnt_list.append(i)
        
        # 조회 결과가 0이 아닐 때까지 임의의 병원을 찾아서 조회
        inst_code = []
        while list_cnt == '0':
            # 임의의 병원 선택
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#statistics-search-hospital")))
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()
            index = (hospital.get_attribute("for")).split('-')[2]
            inst_code.append(driver.find_element(By.CSS_SELECTOR, "#hospital-index-"+str(index)+"-view").get_attribute("value"))

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]
            list_cnt = list_cnt.replace(",","")
        inst_code = "','".join(s for s in inst_code)

        # 조회 결과 저장
        result_list = []
        pat_list = []
        modality_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
                if i.get_property("outerText").split('\t')[1] not in modality_list:
                    modality_list.append(i.get_property("outerText").split('\t')[8])
            WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institution-interpretation-list_next > a")))
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)
        
        # 조회 결과 내에서 임의의 Modality 선택
        select_modality = random.choice(modality_list)

        # 새로고침
        driver.refresh()

        # Show entries 100 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Study Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # 이전에 찾았던 병원 선택
        time.sleep(2)
        driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
        time.sleep(1)
        hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
        hospital.click()

        # Search filter에 임의의 Modality 입력 후, Search 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[3]/div").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[3]/div/ul/li/input").send_keys(select_modality)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[3]/div/ul/li/input").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

        # Showing entry 결과 저장
        time.sleep(4)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]
        list_cnt = list_cnt.replace(",","")

        # 조회 결과 저장
        time.sleep(4)
        result_list = []
        pat_list = []
        modality_list = []
        result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
        pages = math.ceil(int(list_cnt) / 100)
        
        for page in range(1, pages +1):
            result_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table/tbody/tr")
            WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[2]/table")))
            for i in result_list:
                pat_list.append(i.get_property("outerText").split('\t')[2])
                modality_list.append(i.get_property("outerText").split('\t')[1])
            driver.find_element(By.CSS_SELECTOR, "#institution-interpretation-list_next > a").click()
            time.sleep(2)

        # DB에서 선택한 병원을 동일한 조건으로 조회
        end_date = str(today.strftime('%Y%m%d'))
        sql = f"""
            select patient_id from MVIEWINSTSTAT 
            where study_dttm >= to_date('{start_date}', 'YYYY-MM-DD') and study_dttm <= to_date('{end_date}', 'YYYY-MM-DD')
            and institution_code in ('{inst_code}')
            and modality = '{select_modality}'
            """

        # DB 조회 결과 저장
        cursor.execute(sql)
        row = cursor.fetchall()
        db_pat_id = []
        for i in row:
            db_pat_id.append(i)
        
        # DB 조회 결과와 Admin 조회 결과 비교
        try:
            assert db_pat_id.sort() == pat_list.sort()
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # DB 연결 해제
        cursor.close()
        connection.close()

        # Search Filter > Modality 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else result)
        if testResult == 'failed':
            testlink.reportTCResult(1785, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1785, testPlanID, buildName, 'p', "Search Filter > Modality Passed")  

    def Columns():
        print("ITR-42: Statistics > Columns")
        testResult = ''
        reason = list()

        # 1 steps start! : Columns 버튼을 클릭한다.
        # 페이지 초기화
        driver.refresh()

        # Columns 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[2]/button").click()

        # Columns 팝업창 팝업 확인
        popup = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[1]/h4")
        try:
            assert popup.get_property("textContent") == "Column Show/Hide"
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : 임의의 컬럼을 체크 또는 언체크하고, Apply 버튼을 클릭한다.
        # Columns 팝업창 > 임의의 컬럼을 체크 또는 언체크
        columns = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li")
        columns_cnt = len(columns)
        column_index = []
        
        for i in range(1, columns_cnt+1):
            column_index.append(i)

        for i in range(0,3):
            select_column = column_index.pop(column_index.index(random.choice(column_index)))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(select_column)+"]/label").click()
            time.sleep(1)

        # 선택한 column list 저장
        checked_column_list = []
        unchecked_column_list = []
        
        for i in range(1, columns_cnt+1):
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(i)+"]/input").get_property("checked") == True:
                checked_column_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(i)+"]").get_property("textContent"))

        # Columns 팝업창 > Apply 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[3]/button[3]").click()

        # Statistics > column list 저장
        time.sleep(2)
        static_column_list = []
        static_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[1]/div/table/thead/tr/th")
        for i in static_column:
            static_column_list.append(i.get_property("textContent"))

        # Columns 팝업창의 column list와 Statistics column list와 비교
        try:
            assert checked_column_list.sort() == static_column_list.sort()
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : 임의의 컬럼을 체크 또는 언체크하고, Cancel 버튼을 클릭한다.
        # Columns 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[2]/button").click()

        # Columns 팝업창 > 임의의 컬럼을 체크 또는 언체크
        for i in range(0,3):
            select_column = column_index.pop(column_index.index(random.choice(column_index)))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(select_column)+"]/label").click()
            time.sleep(1)

        # 선택한 column list 저장
        checked_column_list = []
        unchecked_column_list = []
        
        for i in range(1, columns_cnt+1):
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(i)+"]/input").get_property("checked") == True:
                checked_column_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(i)+"]").get_property("textContent"))

        # Columns 팝업창 > Cancel 버튼 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[3]/button[2]").click()

        # Statistics > column list 저장
        time.sleep(2)
        static_column_list = []
        static_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[1]/div/table/thead/tr/th")
        for i in static_column:
            static_column_list.append(i.get_property("textContent"))

        # Columns 팝업창의 column list와 Statistics column list와 비교
        try:
            assert checked_column_list.sort() == static_column_list.sort()
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : 임의의 컬럼을 체크 또는 언체크하고, Reset 버튼을 클릭한다.
        # Columns 클릭
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[2]/button").click()

        # Columns 팝업창 > Reset 버튼 클릭 후, Apply 클릭
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[3]/button[1]").click()
        time.sleep(0.5)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[3]/button[3]").click()

        # 선택한 column list 저장
        checked_column_list = []
        unchecked_column_list = []
        
        for i in range(1, columns_cnt+1):
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(i)+"]/input").get_property("checked") == True:
                checked_column_list.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[4]/div/div/div[2]/div/ul/li["+str(i)+"]").get_property("textContent"))

        # Statistics > column list 저장
        time.sleep(2)
        static_column_list = []
        static_column = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[3]/div[1]/div/table/thead/tr/th")
        for i in static_column:
            static_column_list.append(i.get_property("textContent"))

        # Columns 팝업창의 column list와 Statistics column list와 비교
        try:
            assert checked_column_list.sort() == static_column_list.sort()
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")
        
        # Columns 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else testResult)
        if testResult == 'failed':
            testlink.reportTCResult(1759, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1759, testPlanID, buildName, 'p', "Columns Passed")  

    def Show_Entries():
        print("ITR-43: Statistics > Show entries")
        testResult = ''
        reason = list()

        # 1 steps start! : Show entries의 개수를 10으로 변경한다.
        # 페이지 초기화
        driver.refresh()

        # Showing entry 결과 저장
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[5]

        # Study Date 선택
        time.sleep(2)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").click()
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[4]/div[1]/table/tfoot/tr[2]/th[2]").click()
        start_date = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[2]/div[1]/input").get_property("value")
        start_date = start_date.replace("-","")

        # 임의의 병원 선택
        time.sleep(1)
        temp_hospital_cnt_list = []
        hospital_list = driver.find_elements(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/ul/li")
        hospital_cnt = len(hospital_list) - 1

        for i in range(2, hospital_cnt):
            temp_hospital_cnt_list.append(i)
        
        # 조회 결과가 100개를 초과할 때까지 임의의 병원을 찾아서 조회
        while int(list_cnt) < 100:
            # 임의의 병원 선택
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#statistics-search-hospital")))
            driver.find_element(By.CSS_SELECTOR, "#statistics-search-hospital").click()
            time.sleep(1)
            select_hospital = temp_hospital_cnt_list.pop(temp_hospital_cnt_list.index(random.choice(temp_hospital_cnt_list)))
            hospital = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[2]/div[1]/div/div/ul/li["+str(select_hospital)+"]/label")
            hospital.click()

            # Searh 클릭
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[1]/div/div/div[1]/div[4]/button").click()

            # Showing entry 결과 저장
            time.sleep(4)
            temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
            temp_cnt = temp_cnt.split()
            list_cnt = temp_cnt[5]

        # Show entries 10으로 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(10))

        # Showing entry 결과 저장
        time.sleep(4)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3] 

        # 조회결과 리스트가 10개 단위로 표시되는지 확인
        try:
            assert list_cnt == '10'
        except:
            testResult = "failed"
            reason.append("1 steps failed\n")

        # 2 steps start! : Show entries의 개수를 25로 변경한다.
        # Show entries 25로 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(25))

        # Showing entry 결과 저장
        time.sleep(4)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3] 

        # 조회결과 리스트가 25개 단위로 표시되는지 확인
        try:
            assert list_cnt == '25'
        except:
            testResult = "failed"
            reason.append("2 steps failed\n")

        # 3 steps start! : Show entries의 개수를 50으로 변경한다.
        # Show entries 50으로 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(50))

        # Showing entry 결과 저장
        time.sleep(4)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3] 

        # 조회결과 리스트가 50개 단위로 표시되는지 확인
        try:
            assert list_cnt == '50'
        except:
            testResult = "failed"
            reason.append("3 steps failed\n")

        # 4 steps start! : Show entries의 개수를 100으로 변경한다.
        # Show entries 100으로 변경
        select = Select(driver.find_element(By.CSS_SELECTOR,"#institution-interpretation-list_length > label > select"))                
        select.select_by_value(str(100))

        # Showing entry 결과 저장
        time.sleep(4)
        temp_cnt = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div[3]/div/div[4]").text
        temp_cnt = temp_cnt.split()
        list_cnt = temp_cnt[3] 

        # 조회결과 리스트가 100개 단위로 표시되는지 확인
        try:
            assert list_cnt == '100'
        except:
            testResult = "failed"
            reason.append("4 steps failed\n")

        # Show entries 결과 전송
        result = ' '.join(s for s in reason)
        print("Test Result: Pass" if testResult != "failed" else testResult)
        if testResult == 'failed':
            testlink.reportTCResult(1765, testPlanID, buildName, 'f', result)
        else:
            testlink.reportTCResult(1765, testPlanID, buildName, 'p', "Show entries Passed")  

class UserManagement:
    def SearchFilter_Class():
        print("ITR-49: Configuration > User Management > Search Filter > Class")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        
        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        select_class = data[0]["ClassCode"]

        del driver.requests
        time.sleep(1)
        
        # Select Class Search #1
        driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > a > span").click()
        for n in range(1,7):
            if driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text == select_class:
                driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                break
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()

        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range(0, len(data)):
            if (data[n]["ClassCode"] != select_class or
                driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(4)").text != data[n]["ClassCode"]):
                testResult = False
                Result_msg += "#1 "

        # SearchFilter_Class결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1797, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1797, testPlanID, buildName, 'p', "SearchFilter_Class Test Passed")

    def SearchFilter_Institution():
        print("ITR-50: Configuration > User Management > Search Filter > Institution")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        
        request = driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        select_insti = ""
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(1, len(data)+1):
                del driver.requests
                time.sleep(1)
                    
                # Select
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
                driver.wait_for_request('.*/GetUserModifyData.*')
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
                if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != "None":
                    select_insti = driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text
                    # Close
                    element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                    driver.execute_script("arguments[0].click()",element)
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    # Yes
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                    break
                # Close
                element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                driver.execute_script("arguments[0].click()",element)
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # Yes
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            if (a+1 == total or
                select_insti != ""):
                break

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#user-list_next > a").click()

        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        del driver.requests
        time.sleep(1)

        # Select Institution Search #1
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user_search_institution_chosen > a > span")))
        driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > a > span").click()
        child = driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul").get_property("childElementCount")
        for n in range(1, child+1):
            if driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul > li:nth-child("+str(n)+")").text == select_insti:
                driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul > li:nth-child("+str(n)+")").click()
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#user_search_institution_chosen > a > span"), select_insti))
                break
        element = driver.find_element(By.CSS_SELECTOR, "#user-search")
        driver.execute_script("arguments[0].click()",element)

        request = driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range(1, len(data)+1):
            del driver.requests
            time.sleep(1)

            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
            driver.wait_for_request('.*/GetUserModifyData.*')
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))

            if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != select_insti:
                testResult = False
                Result_msg += "#1 "
                # Close
                element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                driver.execute_script("arguments[0].click()",element)
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # Yes
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                break

            # Close
            element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # Yes
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # SearchFilter_Institution결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1800, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1800, testPlanID, buildName, 'p', "SearchFilter_Institution Test Passed")

    def SearchFilter_UserID():
        print("ITR-51: Configuration > User Management > Search Filter > User ID")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        
        request = driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        select_insti = ""
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(1, len(data)+1):
                del driver.requests
                time.sleep(1)
                    
                # Select
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
                driver.wait_for_request('.*/GetUserModifyData.*')
                time.sleep(0.5)
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
                if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != "None":
                    select_user = driver.find_element(By.CSS_SELECTOR, "#user-add-id").get_property("value")
                    select_class = driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").text
                    select_insti = driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text
                    # Close
                    element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                    driver.execute_script("arguments[0].click()",element)
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    # Yes
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                    break
                # Close
                element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                driver.execute_script("arguments[0].click()",element)
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # Yes
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            if (a+1 == total or
                select_insti != ""):
                break

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#user-list_next > a").click()

        del driver.requests
        time.sleep(1)

        # User ID Search #1
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(select_user)
        element = driver.find_element(By.CSS_SELECTOR, "#user-search")
        driver.execute_script("arguments[0].click()",element)

        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range (0, len(data)):
            if (select_user not in data[n]["UserID"] or
                data[n]["UserID"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(2)").get_property("textContent")):
                testResult = False
                break

        del driver.requests
        time.sleep(1)

        if testResult == True:
            # class
            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > a > span").click()
            child = driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul").get_property("childElementCount")
            for n in range(1, child+1):
                if driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text == select_class:
                    driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#user-search").click()

            request = driver.wait_for_request('.*/GetUserList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(0, len(data)):
                if (select_user not in data[n]["UserID"] or
                    data[n]["UserID"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(2)").get_property("textContent") or
                    data[n]["ClassCode"] != select_class or 
                    data[n]["ClassCode"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(4)").text):
                    testResult = False
                    break

            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child(1)").click()
           
        del driver.requests
        time.sleep(1)

        if testResult == True:
            # institution
            driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > a > span").click()
            child = driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul").get_property("childElementCount")
            for n in range(1, child+1):
                if driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul > li:nth-child("+str(n)+")").text == select_insti:
                    driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#user-search").click()

            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(0, len(data)):
                if (select_user not in data[n]["UserID"] or
                    data[n]["UserID"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(2)").get_property("textContent")):                    
                    testResult = False
                    break

            if testResult == True:
                for n in range(1, len(data)+1):
                    del driver.requests
                    time.sleep(1)

                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
                    driver.wait_for_request('.*/GetUserModifyData.*')
                    WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))

                    if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != select_insti:
                        testResult = False
                        # Close
                        element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                        driver.execute_script("arguments[0].click()",element)
                        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                        # Yes
                        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                        break

                    # Close
                    element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                    driver.execute_script("arguments[0].click()",element)
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    # Yes
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        if testResult == True:
            # class & institution
            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > a > span").click()
            child = driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul").get_property("childElementCount")
            for n in range(1, child+1):
                if driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text == select_class:
                    driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#user-search").click()

            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(0, len(data)):
                if (select_user not in data[n]["UserID"] or
                    data[n]["UserID"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(2)").get_property("textContent") or
                    data[n]["ClassCode"] != select_class or 
                    data[n]["ClassCode"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(4)").text):
                    testResult = False
                    break

            if testResult == True:
                for n in range(1, len(data)+1):
                    del driver.requests
                    time.sleep(1)

                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
                    driver.wait_for_request('.*/GetUserModifyData.*')
                    WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))

                    if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != select_insti:
                        testResult = False
                        # Close
                        element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                        driver.execute_script("arguments[0].click()",element)
                        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                        # Yes
                        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                        break

                    # Close
                    element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                    driver.execute_script("arguments[0].click()",element)
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    # Yes
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        if testResult == False:
            Result_msg += "#1 "

        # SearchFilter_UserID결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1803, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1803, testPlanID, buildName, 'p', "SearchFilter_UserID Test Passed")

    def SearchFilter_UserName():
        print("ITR-52: Configuration > User Management > Search Filter > User Name")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        
        request = driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        select_insti = ""
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(1, len(data)+1):
                del driver.requests
                time.sleep(1)
                    
                # Select
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
                driver.wait_for_request('.*/GetUserModifyData.*')
                time.sleep(0.5)
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
                if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != "None":
                    select_user = driver.find_element(By.CSS_SELECTOR, "#user-add-name").get_property("value")
                    select_class = driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").text
                    select_insti = driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text
                    # Close
                    element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                    driver.execute_script("arguments[0].click()",element)
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    # Yes
                    time.sleep(0.5)
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                    break
                # Close
                element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                driver.execute_script("arguments[0].click()",element)
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # Yes
                time.sleep(0.5)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            if (a+1 == total or
                select_insti != ""):
                break

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#user-list_next > a").click()

        del driver.requests
        time.sleep(1)

        # User ID Search #1
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-name").send_keys(select_user)
        element = driver.find_element(By.CSS_SELECTOR, "#user-search")
        driver.execute_script("arguments[0].click()",element)

        request = driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range (0, len(data)):
            if (select_user not in data[n]["UserName"] or
                data[n]["UserName"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(3)").get_property("textContent")):
                testResult = False
                break

        del driver.requests
        time.sleep(1)

        if testResult == True:
            # class
            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > a > span").click()
            child = driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul").get_property("childElementCount")
            for n in range(1, child+1):
                if driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text == select_class:
                    driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#user-search").click()

            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(0, len(data)):
                if (select_user not in data[n]["UserName"] or
                    data[n]["UserName"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(3)").get_property("textContent") or
                    data[n]["ClassCode"] != select_class or 
                    data[n]["ClassCode"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(4)").text):
                    testResult = False
                    break

            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child(1)").click()
           
        del driver.requests
        time.sleep(1)

        if testResult == True:
            # institution
            driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > a > span").click()
            child = driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul").get_property("childElementCount")
            for n in range(1, child+1):
                if driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul > li:nth-child("+str(n)+")").text == select_insti:
                    driver.find_element(By.CSS_SELECTOR, "#user_search_institution_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#user-search").click()

            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(0, len(data)):
                if (select_user not in data[n]["UserName"] or
                    data[n]["UserName"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(3)").get_property("textContent")):                    
                    testResult = False
                    break

            if testResult == True:
                for n in range(1, len(data)+1):
                    del driver.requests
                    time.sleep(1)

                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
                    driver.wait_for_request('.*/GetUserModifyData.*')
                    time.sleep(0.5)
                    WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))

                    if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != select_insti:
                        testResult = False
                        # Close
                        element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                        driver.execute_script("arguments[0].click()",element)
                        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                        # Yes
                        time.sleep(0.5)
                        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                        break

                    # Close
                    element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                    driver.execute_script("arguments[0].click()",element)
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    # Yes
                    time.sleep(0.5)
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        if testResult == True:
            # class & institution
            driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > a > span").click()
            child = driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul").get_property("childElementCount")
            for n in range(1, child+1):
                if driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text == select_class:
                    driver.find_element(By.CSS_SELECTOR, "#user_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#user-search").click()

            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(0, len(data)):
                if (select_user not in data[n]["UserName"] or
                    data[n]["UserName"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(3)").get_property("textContent") or
                    data[n]["ClassCode"] != select_class or 
                    data[n]["ClassCode"] != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(4)").text):
                    testResult = False
                    break

            if testResult == True:
                for n in range(1, len(data)+1):
                    del driver.requests
                    time.sleep(1)

                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").click()
                    driver.wait_for_request('.*/GetUserModifyData.*')
                    time.sleep(0.5)
                    WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))

                    if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != select_insti:
                        testResult = False
                        # Close
                        element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                        driver.execute_script("arguments[0].click()",element)
                        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                        # Yes
                        time.sleep(0.5)
                        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                        break

                    # Close
                    element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
                    driver.execute_script("arguments[0].click()",element)
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    # Yes
                    time.sleep(0.5)
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        if testResult == False:
            Result_msg += "#1 "

        # SearchFilter_UserName결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1806, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1806, testPlanID, buildName, 'p', "SearchFilter_UserName Test Passed")

    def SearchFilter_ShowWithMappingID():
        print("ITR-53: Configuration > User Management > Search Filter > Show With Mapping ID")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)

        # Show With Mapping ID #1
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(5) > div > label").click()
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()

        request = driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        check = False
        for a in range (0, total):
            request = driver.wait_for_request('.*/GetUserList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(0, len(data)):
                if data[n]["IsMappingID"] == "Y":
                    if driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(7)").text == "Y":
                        check = True
                        break

            if (check == True or 
                a+1 == total):
                break

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#user-list_next > a").click()

        if check == False:
            testResult = False
            Result_msg += "#1 "

        # SearchFilter_ShowWithMappingID결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1809, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1809, testPlanID, buildName, 'p', "SearchFilter_ShowWithMappingID Test Passed")

    def UserRegistartion_Add():
        print("ITR-54: Configuration > User Management > User Registration > Add")
        testResult = True
        Result_msg = "failed at "
        class_check = True
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)

        # Add #1
        driver.find_element(By.CSS_SELECTOR, "#user-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        try:
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3"), "User Registration"))
        except:
            testResult = False
            Result_msg += "#1 "

        # Validation #2
        check = ""
        for i in range(0, 30):
            test_id = add_test_id+str(random.randrange(0,100000))
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(test_id)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
            driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            check = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if check == "User ID is available!":
                break
        if check != "User ID is available!":
            testResult = False
            Result_msg += "#2 "

        # < 5 Validation #3
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys("55555")
        if driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#3 "

        # Only Number Validation #4
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys("555555")
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
        driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "User ID로 숫자만 사용할 수 없습니다.":
            testResult = False
            Result_msg += "#4 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        # Korean Validation #5
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys("한글1234")
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
        driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "User ID로 한글은 사용할 수 없습니다.":
            testResult = False
            Result_msg += "#5 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Already Validation #6
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(adminID)
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
        driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "User ID is Exist!":
            testResult = False
            Result_msg += "#6 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Input
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(test_id)
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
        driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Short Password #8
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys("Ser12!@")
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "Password는 8자 이상이여야 합니다.":
            testResult = False
            Result_msg += "#8 "
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3")))

        # Single Password #9
        check = True
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys("qwerasdf")
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "Password의 영문 대 소문자, 숫자, 특수문자를 혼용하여 사용하여야 합니다.":
            check = False
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3")))

        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys("12345678")
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "Password의 영문 대 소문자, 숫자, 특수문자를 혼용하여 사용하여야 합니다.":
            check = False
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3")))

        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys("!@#$%^&*")
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "Password의 영문 대 소문자, 숫자, 특수문자를 혼용하여 사용하여야 합니다.":
            check = False
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3")))

        if check == False:
            testResult = False
            Result_msg += "#9 "

        # Password input
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys(wk_pw_2)

        # Non User Name Save #10
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "User Name를 입력해주세요.":
            testResult = False
            Result_msg += "#10 "
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3")))

        # Right PW Save, Right User Name Save, Class, E-mail, Phone, License, Administrator, Select Authority, Unselect Authority  #7 11 12 15 16 17 18 23 24
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").send_keys(test_id)

        driver.find_element(By.CSS_SELECTOR, "#user-add-email").send_keys("EmailTest")
        driver.find_element(By.CSS_SELECTOR, "#user-add-phone").send_keys("PhoneTest")
        driver.find_element(By.CSS_SELECTOR, "#user-add-license").send_keys("LicenseTest")

        if (driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-view").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-view").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-create").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-create").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-delete").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-delete").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("willValidate") == False):
            testResult = False
            Result_msg += "#18 "

        driver.find_element(By.CSS_SELECTOR, "#add-user-popup > div > div > div.modal-body > div:nth-child(10) > div > div.col-lg-9.col-xs-9 > div > div > label:nth-child(2)").click()
        if driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-display").get_property("checked") == False:
            testResult = False
            Result_msg += "#23 "

        if "#23" not in Result_msg:
            driver.find_element(By.CSS_SELECTOR, "#add-user-popup > div > div > div.modal-body > div:nth-child(10) > div > div.col-lg-9.col-xs-9 > div > div > label:nth-child(2)").click()
            if driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-display").get_property("checked") == True:
                testResult = False
                Result_msg += "#24"

        # save
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3").text
        # save
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
       
        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()

        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        del driver.requests
        time.sleep(1)

        idx = -1
        for n in data:
            if n["UserID"] == test_id:
                idx = data.index(n) + 1
                break

        if (idx == -1 or 
            msg != "등록하시겠습니까?" or 
            no_msg != "User Registration"):
            testResult = False
            Result_msg += "#7 "

        if "#7" not in Result_msg:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()

            driver.wait_for_request('.*/GetUserModifyData.*')
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-save-btn")))

            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").text != "Administrator":
                class_check = False
            if driver.find_element(By.CSS_SELECTOR, "#user-add-email").get_property("value") != "EmailTest":
                testResult = False
                Result_msg += "#15 "
            if driver.find_element(By.CSS_SELECTOR, "#user-add-phone").get_property("value") != "PhoneTest":
                testResult = False
                Result_msg += "#16 "
            if driver.find_element(By.CSS_SELECTOR, "#user-add-license").get_property("value") != "LicenseTest":
                testResult = False
                Result_msg += "#17 "

            # close
            driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Center, Class, SubAdministrator #12 13 19
        # add
        driver.find_element(By.CSS_SELECTOR, "#user-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3"), "User Registration"))
        # input
        while(1):
            test_id = add_test_id+str(random.randrange(0,100000))
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(test_id)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
            driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            check = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if check == "User ID is available!":
                break
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys(wk_pw_2)
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").click()
        child = driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul").get_property("childElementCount")
        for n in range(1, child+1):
            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").text == "SubAdministrator":
                driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").click()
                break
        # center
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user_add_center_chosen > a > span")))
        driver.find_element(By.CSS_SELECTOR, "#user_add_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#user_add_center_chosen > div > div > input[type=text]").send_keys(search_center)
        driver.find_element(By.CSS_SELECTOR, "#user_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)

        # subadministrator
        if (driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-delete").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-delete").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-view").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-view").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-create").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-config-create").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("willValidate") == False):
            testResult = False
            Result_msg += "#19 "

        # save
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
       
        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()

        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        del driver.requests
        time.sleep(1)

        idx = -1
        for n in data:
            if n["UserID"] == test_id:
                idx = data.index(n) + 1
                break

        if idx != -1:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()

            driver.wait_for_request('.*/GetUserModifyData.*')
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-save-btn")))

            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").text != "SubAdministrator":
                class_check = False
            if driver.find_element(By.CSS_SELECTOR, "#user_add_center_chosen > a > span").text != search_center:
                testResult = False
                Result_msg += "#13 "

            # close
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
            driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        else:
            testResult = False
            Result_msg += "#13 "
            class_check = False

        # Class, Reporter #12 20
        # add
        driver.find_element(By.CSS_SELECTOR, "#user-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3"), "User Registration"))
        # input
        while(1):
            test_id = add_test_id+str(random.randrange(0,100000))
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(test_id)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
            driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            check = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if check == "User ID is available!":
                break
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys(wk_pw_2)
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").click()
        child = driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul").get_property("childElementCount")
        for n in range(1, child+1):
            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").text == "Reporter":
                driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").click()
                break

        # reporter
        if (driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-upload-job").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-upload-job").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-download-job").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-download-job").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-download-module").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-download-module").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-create").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-create").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-delete").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-delete").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("checked") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("willValidate") == True ):
            testResult = False
            Result_msg += "#20 "

        # save
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
       
        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()

        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        del driver.requests
        time.sleep(1)

        idx = -1
        for n in data:
            if n["UserID"] == test_id:
                idx = data.index(n) + 1
                break

        if idx != -1:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()

            driver.wait_for_request('.*/GetUserModifyData.*')
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-save-btn")))

            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").text != "Reporter":
                class_check = False

            # close
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
            element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        else:
            class_check = False

        # Institution, Class, Requester #12 14 21
        # add
        driver.find_element(By.CSS_SELECTOR, "#user-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3"), "User Registration"))
        # input
        while(1):
            test_id = add_test_id+str(random.randrange(0,100000))
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(test_id)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
            driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            check = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if check == "User ID is available!":
                break
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys(wk_pw_2)
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").click()
        child = driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul").get_property("childElementCount")
        for n in range(1, child+1):
            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").text == "Requester":
                driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").click()
                break

        # institution
        driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)


        # requester
        if (driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-display").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-display").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-edit").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-edit").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-delete").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-delete").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-upload-job").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-file-upload-job").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-view-image").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("checked") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("willValidate") == True ):
            testResult = False
            Result_msg += "#21 "

        # save
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
       
        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()

        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        del driver.requests
        time.sleep(1)

        idx = -1
        for n in data:
            if n["UserID"] == test_id:
                idx = data.index(n) + 1
                break

        if idx != -1:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()

            driver.wait_for_request('.*/GetUserModifyData.*')
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-save-btn")))

            if driver.find_element(By.CSS_SELECTOR, "#user_add_institution_chosen > a > span").text != search_institution_3:
                testResult = False
                Result_msg += "#14 "
            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").text != "Requester":
                class_check = False

            # close
            driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        else:
            class_check = False

        # Class, Product #12 22
        # add
        driver.find_element(By.CSS_SELECTOR, "#user-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3"), "User Registration"))
        # input
        while(1):
            test_id = add_test_id+str(random.randrange(0,100000))
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(test_id)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
            driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            check = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if check == "User ID is available!":
                break
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys(wk_pw_2)
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").click()
        child = driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul").get_property("childElementCount")
        for n in range(1, child+1):
            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").text == "Product":
                driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").click()
                break

        # product
        if (driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-delete").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-job-delete").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-report-display").get_property("willValidate") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("checked") == True or
            driver.find_element(By.CSS_SELECTOR, "#user-add-authority-admin-advanced-result").get_property("willValidate") == True ):
            testResult = False
            Result_msg += "#22 "

        # save
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
       
        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()

        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        del driver.requests
        time.sleep(1)

        idx = -1
        for n in data:
            if n["UserID"] == test_id:
                idx = data.index(n) + 1
                break

        if idx != -1:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()

            driver.wait_for_request('.*/GetUserModifyData.*')
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-save-btn")))

            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a > span").text != "Product":
                class_check = False

            # close
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
            element = driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        else:
            class_check = False

        if class_check ==  False:
            testResult = False
            Result_msg += "#12 "

        # UserRegistartion_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1813, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1813, testPlanID, buildName, 'p', "UserRegistartion_Add Test Passed")

    def UserRegistration_Modify_Entry(target):
        print("ITR-55: Configuration > User Management > User Registration > Modify")
        testResult = True

        driver.find_element(By.CSS_SELECTOR, "#mapping-userid-list_length > label > select").click()
        child = driver.find_element(By.CSS_SELECTOR, "#mapping-userid-list_length > label > select").get_property("childElementCount")
        for n in range(1, child + 1):
            if driver.find_element(By.CSS_SELECTOR, "#mapping-userid-list_length > label > select > option:nth-child("+str(n)+")").text == str(target):
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-list_length > label > select > option:nth-child("+str(n)+")").click()
                break

        request = driver.wait_for_request('.*/GetUserMappingList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)

        if data["Length"] != target:
            testResult = False

        del driver.requests
        time.sleep(1)

        return testResult

    def UserRegistartion_Modify():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownalodControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        time.sleep(0.5)

        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[1]/h3")))
        # User
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-user-remove-btn")))
        # Institution
        driver.find_element(By.CSS_SELECTOR, "#add_sel_institution_search").send_keys(search_institution_3)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[2]/div[1]/div[2]/div/div/div[1]/select/option[1]").click()
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-remove-btn")))
        # Save
        driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # Yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # Ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        del driver.requests
        time.sleep(1)

        # UserManagement
        driver.find_element(By.CSS_SELECTOR, "#user-btn").click()
        driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)

        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()
        request = driver.wait_for_request('.*/GetUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        # Select
        idx = -1
        for n in range(0, len(data)):
            if data[n]["UserID"] == wk_id_2:
                idx = n+1
                select_user = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").text
                break
        # User ID Click #1
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-save-btn")))
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3").text != "User Modify":
            testResult = False
            Result_msg += "#1 "

        if testResult == True:
            # Modify ID #2
            if driver.find_element(By.CSS_SELECTOR, "#user-add-id").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#2 "

            # Download User ID #3
            driver.find_element(By.CSS_SELECTOR, "#user-modify-download-userid-btn > span").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[1]/h3")))
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[1]/h3").text != "User Mapping":
                testResult = False
                Result_msg += "#3 "

            if "#3" not in Result_msg:
                # Institution #4
                driver.find_element(By.CSS_SELECTOR, "#download_userid_select_institution_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_select_institution_chosen > div > ul").get_property("childElementCount")
                check = False
                for n in range(1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_select_institution_chosen > div > ul > li:nth-child("+str(n)+")").text == search_institution_3:
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_select_institution_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        check = True
                        break
                if check == False:
                    testResult = False
                    Result_msg += "#4 "

                # Already Mapping Validation #6
                driver.find_element(By.CSS_SELECTOR, "#user-modify-download-userid-popup > div > div > div.modal-body > div:nth-child(2) > div > div.col-lg-6.col-xs-6.switch.panel-switch-btn > label > span").click()
                driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id").send_keys(wk_id_2)
                driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id-validation-btn > span").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "User ID is Exist!":
                    testResult = False
                    Result_msg += "#6 "
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

                # Mapping Validation #5
                check = False
                for i in range(0, 30):
                    test_id = add_test_id+str(random.randrange(0,100000))
                    driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id").clear()
                    driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id").send_keys(test_id)
                    driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id-validation-btn > span").click()
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text == "User ID is available!":
                        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                        check = True
                        break
                if check == False:
                    testResult = False
                    Result_msg += "#5 "

                # Save
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-save-btn").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # Yes
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
                # Ok
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-download-userid-popup > div > div > div.modal-body > div:nth-child(2) > div > div.col-lg-6.col-xs-6.switch.panel-switch-btn > label > span")))

                # Second Save #9
                driver.find_element(By.CSS_SELECTOR, "#user-modify-download-userid-popup > div > div > div.modal-body > div:nth-child(2) > div > div.col-lg-6.col-xs-6.switch.panel-switch-btn > label > span").click()
                while (1):
                    test_id = add_test_id+str(random.randrange(0,100000))
                    driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id").clear()
                    driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id").send_keys(test_id)
                    driver.find_element(By.CSS_SELECTOR, "#download-userid-add-id-validation-btn > span").click()
                    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                    if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text == "User ID is available!":
                        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                        break
                # save
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-save-btn").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # yes
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))

                if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "선택한 병원에 등록된 Mapping ID가 존재합니다.":
                    testResult = False
                    Result_msg += "#9 "

                # ok
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

                # Close #10
                # close
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-close-btn").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
                # no
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#mapping-userid-close-btn")))
                no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[1]/h3").text
                # close
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-close-btn").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # yes
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
                yes_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[3]/div/div/div[1]/h3").text
                if (msg != "설정을 종료하시겠습니까?" or
                    no_msg != "User Mapping" or
                    yes_msg != "User Modify"):
                    testResult = False
                    Result_msg += "#10 "

            # Download User ID
            driver.find_element(By.CSS_SELECTOR, "#user-modify-download-userid-btn > span").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[1]/h3")))
            
            del driver.requests
            time.sleep(1)

            if "#3" not in Result_msg:
                # Institution None Search #11
                driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul").get_property("childElementCount")
                for n in range (1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").text == "Institution":
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        break

                driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > div > ul").get_property("childElementCount")
                for n in range (1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > div > ul > li:nth-child("+str(n)+")").text == "None":
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        break
                
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-search-btn").click()
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]
                remember_id = data[0]["InstitutionUserID"]

                for n in range(0, len(data)):
                    if (data[n]["InstitutionName"] != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[1]").text or
                        data[n]["InstitutionUserID"] != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[2]").text):
                        testResult = False
                        Result_msg += "#11 "
                        break

                del driver.requests
                time.sleep(1)

                # Institution Select Search #12
                driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul").get_property("childElementCount")
                for n in range (1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").text == "Institution":
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        break

                driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > div > ul").get_property("childElementCount")
                for n in range (1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > div > ul > li:nth-child("+str(n)+")").text == search_institution_3:
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_search_select_institution_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        break

                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-search-btn").click()
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                time.sleep(1)
                for n in range(0, len(data)):
                    if (data[n]["InstitutionName"] != search_institution_3 or
                        search_institution_3 != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[1]").text or
                        data[n]["InstitutionUserID"] != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[2]").text):
                        testResult = False
                        Result_msg += "#12 "
                        break

                del driver.requests
                time.sleep(1)

                # Blank Mapping ID Search #13
                driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul").get_property("childElementCount")
                for n in range (1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").text == "Mapping ID":
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        break

                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-search-btn").click()
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in range(0, len(data)):
                    if (data[n]["InstitutionName"] != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[1]").text or
                        data[n]["InstitutionUserID"] != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[2]").text):
                        testResult = False
                        Result_msg += "#13 "
                        break

                del driver.requests
                time.sleep(1)

                # Input Mapping ID Search #14
                driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul").get_property("childElementCount")
                for n in range (1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").text == "Mapping ID":
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        break

                driver.find_element(By.CSS_SELECTOR, "#download-userid-search-mapping-id-input").send_keys(remember_id)

                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-search-btn").click()
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in range(0, len(data)):
                    if (data[n]["InstitutionUserID"] != remember_id or
                        remember_id != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[2]").text or
                        data[n]["InstitutionName"] != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(n+1)+"]/td[1]").text):
                        testResult = False
                        Result_msg += "#14 "
                        break

                del driver.requests
                time.sleep(1)

                # Other Input Mapping ID Search #15
                driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > a > span").click()
                child = driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul").get_property("childElementCount")
                for n in range (1, child+1):
                    if driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").text == "Mapping ID":
                        driver.find_element(By.CSS_SELECTOR, "#download_userid_select_search_type_chosen > div > ul > li:nth-child("+str(n)+")").click()
                        break

                driver.find_element(By.CSS_SELECTOR, "#download-userid-search-mapping-id-input").clear()
                driver.find_element(By.CSS_SELECTOR, "#download-userid-search-mapping-id-input").send_keys(wk_id_2)

                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-search-btn").click()
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                if len(data) != 0:
                    testResult = False 
                    Result_msg += "#15 "

                del driver.requests
                time.sleep(1)

                # Clear
                driver.find_element(By.CSS_SELECTOR, "#download-userid-search-mapping-id-input").clear()
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-search-btn").click()
                driver.wait_for_request('.*/GetUserMappingList.*')
                del driver.requests
                time.sleep(1)

                # Entries 25 #17
                temp = UserManagement.UserRegistration_Modify_Entry(25)
                if temp == False:
                    testResult = False
                    Result_msg += "#17 "

                # Entries 10 #16
                temp = UserManagement.UserRegistration_Modify_Entry(10)
                if temp == False:
                    testResult = False
                    Result_msg += "#16 "

                # Entries 50 #18
                temp = UserManagement.UserRegistration_Modify_Entry(50)
                if temp == False:
                    testResult = False
                    Result_msg += "#18 "

                # Entries 100 #19
                temp = UserManagement.UserRegistration_Modify_Entry(100)
                if temp == False:
                    testResult = False
                    Result_msg += "#19 "

                # Institution Sort #20
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[1]").click()
                check = True
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)

                before = data["OrderType"]
                if (data["OrderColumn"] != "InstitutionName" or 
                    before != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[1]").get_property("ariaSort").split('ending')[0]):
                    check = False

                if check == False:
                    testResult = False
                    Result_msg += "#20 "
                else:
                    del driver.requests
                    time.sleep(1)

                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[1]").click()
                    request = driver.wait_for_request('.*/GetUserMappingList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)
                    after = data["OrderType"]
                    if (data["OrderColumn"] != "InstitutionName" or 
                    after != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[1]").get_property("ariaSort").split('ending')[0] or
                    before == after ):
                        check = False

                if check == False:
                    testResult = False
                    Result_msg += "#20 "

                del driver.requests
                time.sleep(1)

                # User ID Sort #21
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[2]").click()
                check = True
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)

                before = data["OrderType"]
                if (data["OrderColumn"] != "InstitutionUserID" or 
                    before != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[2]").get_property("ariaSort").split('ending')[0]):
                    check = False

                if check == False:
                    testResult = False
                    Result_msg += "#21 "
                else:
                    del driver.requests
                    time.sleep(1)

                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[2]").click()
                    request = driver.wait_for_request('.*/GetUserMappingList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)
                    after = data["OrderType"]
                    if (data["OrderColumn"] != "InstitutionUserID" or 
                    after != driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/thead/tr/th[2]").get_property("ariaSort").split('ending')[0] or
                    before == after ):
                        check = False

                if check == False:
                    testResult = False
                    Result_msg += "#21 "

                del driver.requests
                time.sleep(1)

                # Delete #22
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-search-btn").click()
                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                idx = -1
                for n in data:
                    if n["InstitutionUserID"] == remember_id:
                        idx = data.index(n) + 1
                        break

                del driver.requests
                time.sleep(1)

                # delete
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(idx)+"]/td[3]/a/i").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
                # no
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#mapping-userid-close-btn")))
                no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[1]/h3").text
                # delete
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(idx)+"]/td[3]/a/i")))
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[4]/div/div/div[2]/div[9]/div/table/tbody/tr["+str(idx)+"]/td[3]/a/i").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # yes
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
                # ok
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

                request = driver.wait_for_request('.*/GetUserMappingList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                if (msg != "삭제하시겠습니까?" or 
                    no_msg != "User Mapping"):
                    testResult = False
                    Result_msg += "#22 "
                else:
                    for n in data:
                        if n["InstitutionUserID"] == remember_id:
                            testResult = False
                            Result_msg += "#22 "

                # Close
                driver.find_element(By.CSS_SELECTOR, "#mapping-userid-close-btn").click()
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
                # Yes
                time.sleep(1)
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-modify-close-btn")))
            # Close
            driver.find_element(By.CSS_SELECTOR, "#user-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # Yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-search")))

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#download-search-user-id").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()
        request = driver.wait_for_request('.*/GetDownloadControlList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        
        idx = -1
        for n in data:
            if n["UserID"] == wk_id_2 :
                idx = data.index(n) + 1
                break

        # Click
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr["+str(idx)+"]/td[1]/label").click()
        # Delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # Yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # UserRegistartion_Modify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1839, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1839, testPlanID, buildName, 'p', "UserRegistartion_Modify Test Passed")

    def UserRegistartion_Delete():
        print("ITR-218: Configuration > User Management > User Registration > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        driver.wait_for_request('.*/GetUserList.*')

        # None Select Delete #1
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(add_test_id)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()
        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        # Select Delete #2
        # select
        for n in range(0, len(data)):
            if data[n]["UserID"].split(add_test_id)[1].isdigit() == True :
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n+1)+"]/td[1]/label").click()
                select_user = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr["+str(n+1)+"]/td[2]/a").text
                break

        del driver.requests
        time.sleep(1)

        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/div[1]/a[2]")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[1]/div[1]/h4").text
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").send_keys(select_user)
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()
        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in data:
            if n["UserID"] == select_user:
                testResult = False
                Result_msg += "#2 "

        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#user-search-user-id").clear()
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()
        request = driver.wait_for_request('.*/GetUserList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        if total < 2:
            testResult = False
            Result_msg += "#3 #4 "
        else:
            # Delete Other Tab #3
            del driver.requests
            time.sleep(1)
            
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#user-list_next > a").click()

            driver.wait_for_request('.*/GetUserList.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#3 "

            # Delete Other Tab > 2
            del driver.requests
            time.sleep(1)
            
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#user-list_previous > a").click()

            driver.wait_for_request('.*/GetUserList.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#4 "

        # UserRegistartion_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2864, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2864, testPlanID, buildName, 'p', "UserRegistartion_Delete Test Passed")

class Specialty:
    def SpecialtyList_Search():
        print("ITR-56: Configuration > Specialty > Specialty list > Search")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  

        del driver.requests
        time.sleep(1)

        # Code Search #1
        driver.find_element(By.CSS_SELECTOR, "#specialty-search-code").send_keys(specialty)
        driver.find_element(By.CSS_SELECTOR, "#specialty-search").click()
        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range(0, len(data)):
            if (specialty not in data[n]["SpecialtyCode"] or 
                data[n]["SpecialtyCode"] != driver.find_element(By.CSS_SELECTOR, "#specialty-code-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(2)").get_property("textContent")):
                testResult = False
                Result_msg += "#1 "

        del driver.requests
        time.sleep(1)

        # Description Search #2
        driver.find_element(By.CSS_SELECTOR, "#specialty-search-code").clear()
        driver.find_element(By.CSS_SELECTOR, "#specialty-search-desc").send_keys(specialty)
        driver.find_element(By.CSS_SELECTOR, "#specialty-search").click()
        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range(0, len(data)):
            if (specialty not in data[n]["SpecialtyDescription"] or 
                data[n]["SpecialtyDescription"] != driver.find_element(By.CSS_SELECTOR, "#specialty-code-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(3)").get_property("textContent")):
                testResult = False
                Result_msg += "#2 "

        # SpecialtyList_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1865, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1865, testPlanID, buildName, 'p', "SpecialtyList_Search Test Passed")

    def SpecialtyList_Add():
        print("ITR-57: Configuration > Specialty > Specialty list > Add")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # Add #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[1]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3")))
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3").text != "Specialty Registration":
            testResult = False
            Result_msg += "#1 "

        # Input Save #2
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-specialty-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-specialty-desc").send_keys(specialty_add)
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3").text
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#specialty-search-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-search").click()
        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["SpecialtyCode"] == specialty_add:
                idx = data.index(n)
                break

        if (msg != "등록하시겠습니까?" or
            no_msg != "Specialty Registration" or
            idx == -1):
            testResult = False
            Result_msg += "#2 "

        del driver.requests
        time.sleep(1)

        # Already Save #3
        # add
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[1]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3")))
        # input
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-specialty-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-specialty-desc").send_keys(specialty_add)
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3").text
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["SpecialtyCode"] == specialty_add:
                idx = data.index(n)
                break

        if (msg != "등록하시겠습니까?" or
            no_msg != "Specialty Registration" or
            idx == -1):
            testResult = False
            Result_msg += "#3 "

        # SpecialtyList_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1869, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1869, testPlanID, buildName, 'p', "SpecialtyList_Add Test Passed")

    def SpecialtyList_Delete():
        print("ITR-58: Configuration > Specialty > Specialty list > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # Nonclick Delete #1
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]").value_of_css_property('cursor') != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#specialty-search-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-search").click()
        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["SpecialtyCode"] == specialty_add:
                idx = data.index(n)
                break

        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/tbody/tr["+str(idx+1)+"]/td[1]/label").click()

        del driver.requests
        time.sleep(1)

        # Delete #2
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]")))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#specialty-tab-name").text
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["SpecialtyCode"] == specialty_add:
                idx = data.index(n)
                break

        if (msg != "삭제하시겠습니까?" or 
            no_msg != "Specialty List" or
            idx != -1):
            testResult = False
            Result_msg += "#2 "

        del driver.requests
        time.sleep(1)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        # Other Tab Delete #3
        if total < 2:
            testResult = False
            Result_msg += "#3 #4 "
        else:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#specialty-code-list_next > a").click()

            driver.wait_for_request('.*/GetSpecialtyList.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#3 "

            # Other Tab Delete > 2 #4
            del driver.requests
            time.sleep(1)

            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#specialty-code-list_previous > a").click()

            driver.wait_for_request('.*/GetSpecialtyList.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#4 "

        # SpecialtyList_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1874, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1874, testPlanID, buildName, 'p', "SpecialtyList_Delete Test Passed")

    def SpecialtyList_Modify():
        print("ITR-59: Configuration > Specialty > Specialty list > Modify")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # Add
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[1]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[3]/div/div/div[1]/h3")))
        # Input
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-specialty-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-specialty-desc").send_keys(specialty_add)
        # Save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # Yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # Ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#specialty-search-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-search").click()
        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["SpecialtyCode"] == specialty_add:
                idx = data.index(n)
                break

        # Specialty Code Click #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/tbody/tr["+str(idx+1)+"]/td[2]/a").click()
        driver.wait_for_request('.*/GetSpecialtyItemList.*')
        try:
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[1]/h3"), "Specialty Rule Setting"))
        except:
            testResult = False
            Result_msg += "#1 "

        # Select Save #2
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_request_code_chosen > a > span").click()
        code = driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_request_code_chosen > div > ul > li:nth-child(1)").text
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_request_code_chosen > div > ul > li:nth-child(1)").click()

        # save
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[1]/h3").text
        # save
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        del driver.requests
        time.sleep(1)

        # specialty code click
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/tbody/tr["+str(idx+1)+"]/td[2]/a").click()
        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = False
        idx = 0
        for n in data:
            if n["RequestCodeVal"] == code:
                idx = data.index(n)
                if driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list > tbody > tr:nth-child("+str(idx+1)+") > td:nth-child(3)").text == code:
                    check = True
                break
        if (msg != "등록하시겠습니까?" or
            no_msg != "Specialty Rule Setting" or
            check == False):
            testResult = False
            Result_msg += "#2 "

        # Select Close #3
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_request_code_chosen > a > span").click()
        code = driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_request_code_chosen > div > ul > li:nth-child(1)").text
        driver.find_element(By.CSS_SELECTOR, "#specialty_rulesetting_request_code_chosen > div > ul > li:nth-child(1)").click()

        # close
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[1]/h3").text
        # close
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-code-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#specialty-tab-name").text

        if (msg != "등록을 취소하시겠습니까?" or 
            no_msg != "Specialty Rule Setting" or
            yes_msg != "Specialty List"):
            testResult = False
            Result_msg += "#3 "

        # Specialty Code Search #4
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/table/tbody/tr["+str(idx+1)+"]/td[2]/a").click()
        driver.wait_for_request('.*/GetSpecialtyItemList.*')

        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search_btn").click()
        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in data:
            if specialty_add not in n["SpecialtyCode"]:
                testResult = False
                Result_msg += "#4 "
                break

        # Request Code Search #5
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search_index_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search_index_chosen > div > ul > li:nth-child(2)").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search").send_keys(code.split(':')[0])
        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search_btn").click()

        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in data:
            if code not in n["RequestCodeVal"]:
                testResult = False
                Result_msg += "#5 "
                break

        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search").clear()
        driver.find_element(By.CSS_SELECTOR, "#specialty_specialty_rule_search_btn").click()
        driver.wait_for_request('.*/GetSpecialtyItemList.*')

        # Entries 25 #7
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select > option:nth-child(2)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 25:
            testResult = False
            Result_msg += "#7 "
        # Entries 10 #6
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select > option:nth-child(1)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 10:
            testResult = False
            Result_msg += "#6 "

        # Entries 50 #8
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select > option:nth-child(3)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 50:
            testResult = False
            Result_msg += "#8 "

        # Entries 100 #9
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-rule-list_length > label > select > option:nth-child(4)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 100:
            testResult = False
            Result_msg += "#9 "

        # Delete #10
        del driver.requests
        time.sleep(1)
        #delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[2]/div/div[2]/div[2]/div/table/tbody/tr[1]/td[4]/a/i").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-rulesetting-close-btn")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[1]/h3").text

        del driver.requests
        time.sleep(1)

        #delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[4]/div/div/div[2]/div/div[2]/div[2]/div/table/tbody/tr[1]/td[4]/a/i").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        if (msg != "삭제하시겠습니까?" or
            no_msg != "Specialty Rule Setting"):
            testResult=False
            Result_msg+="#10 "
        
        if "#10" not in Result_msg:
            for n in data:
                if n["RequestCodeVal"] == code:
                    testResult = False
                    Result_msg += "#10 "

        # Close
        driver.find_element(By.CSS_SELECTOR, "#specialty-rulesetting-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        del driver.requests
        time.sleep(1)

        # Deletion
        #driver.find_element(By.CSS_SELECTOR, "#specialty-search-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-search").click()
        request = driver.wait_for_request('.*/GetSpecialtyList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in data:
            if n["SpecialtyCode"] == specialty_add:
                idx = data.index(n) + 1
                break

        driver.find_element(By.CSS_SELECTOR, "#specialty-code-list > tbody > tr:nth-child("+str(idx)+") > td:nth-child(1) > label").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # SpecialtyList_Modify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1880, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1880, testPlanID, buildName, 'p', "SpecialtyList_Modify Test Passed")

    def InstitutionList_Search():
        print("ITR-60: Configuration > Specialty > Institution list > Search")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # InstitutionList
        driver.find_element(By.CSS_SELECTOR, "#tab-specialty-institution-list > a").click()
        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        rnd_insti = data[0]["InstitutionName"]

        del driver.requests
        time.sleep(1)

        # Search #1
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search-name").send_keys(rnd_insti)
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search").click()

        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range (0, len(data)):
            if (rnd_insti not in data[n]["InstitutionName"] or 
                data[n]["InstitutionName"] != driver.find_element(By.CSS_SELECTOR, "#specialty-institution-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(2)").get_property("textContent")):
                testResult = False
                Result_msg += "#1 "

        # InstitutionList_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1893, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1893, testPlanID, buildName, 'p', "InstitutionList_Search Test Passed")

    def InstitutionList_Add():
        print("ITR-61: Configuration > Specialty > Institution list > Add")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # InstitutionList
        driver.find_element(By.CSS_SELECTOR, "#tab-specialty-institution-list > a").click()
        driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)

        # Add #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/div[1]/a[1]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3")))
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3").text != "Specialty Registration":
            testResult = False
            Result_msg += "#1 "

        # Input Save #2
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > a > span")))
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > a > span").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > div > div > input[type=text]")))
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-specialty-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-specialty-desc").send_keys(specialty_add)
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3").text
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search-name").send_keys(search_institution_3)
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search").click()
        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["InstitutionName"] == search_institution_3:
                idx = data.index(n)
                break

        if (msg != "Specialty Rule을 등록하시겠습니까?" or
            no_msg != "Specialty Registration" or
            idx == -1):
            testResult = False
            Result_msg += "#2 "

        del driver.requests
        time.sleep(1)

        # Already Save #3
        # add
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3")))
        # input
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-specialty-code").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-specialty-desc").send_keys(specialty_add)  
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3").text
        # save
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["InstitutionName"] == search_institution_3:
                idx = data.index(n)
                break

        if (msg != "Specialty Rule을 등록하시겠습니까?" or
            no_msg != "Specialty Registration" or
            idx == -1):
            testResult = False
            Result_msg += "#3 "

        # NonInput Save #4
        # add
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3")))
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_add_request_code_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)

        if driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-save-btn").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#4 "

        # Close #5
        # close
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[5]/div/div/div[1]/h3").text
        # close
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-close-btn")))
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-add-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_all_elements_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-tab-name").text

        if (msg != "Specialty Rule 등록을 취소하시겠습니까?" or 
            no_msg != "Specialty Registration" or 
            yes_msg != "Institution List"):
            testResult = False
            Result_Msg += "#5 "

        # InstitutionList_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1896, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1896, testPlanID, buildName, 'p', "InstitutionList_Add Test Passed")

    def InstitutionList_Delete():
        print("ITR-64: Configuration > Specialty > Institution list > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # InstitutionList
        driver.find_element(By.CSS_SELECTOR, "#tab-specialty-institution-list > a").click()
        driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)

        # Nonclick Delete #1
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/div[1]/a[2]").value_of_css_property('cursor') != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search-name").send_keys(search_institution_3)
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search").click()
        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["InstitutionName"] == search_institution_3:
                idx = data.index(n)
                break

        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/table/tbody/tr["+str(idx+1)+"]/td[1]/label").click()

        del driver.requests
        time.sleep(1)

        ## Delete #2
        ## delete
        #driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/div[1]/a[2]").click()
        #WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        #msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        ## no
        #time.sleep(1)
        #driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        #WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[1]/div/div[1]/a[2]")))
        #no_msg = driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-tab-name").text
        ## delete
        #driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/div[1]/a[2]").click()
        #WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        ## yes
        #driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        #WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        ## ok
        #driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        #request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        #body = request.response.body.decode('utf-8')
        #data = json.loads(body)["data"]

        #idx = -1
        #for n in data:
        #    if n["InstitutionName"] == search_institution_3:
        #        idx = data.index(n)
        #        break

        #if (msg != "Institution에 할당된 Specialty를 삭제하시겠습니까?" or 
        #    no_msg != "Specialty List" or
        #    idx != -1):
        #    testResult = False
        #    Result_msg += "#2 "

        #del driver.requests
        #time.sleep(1)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')
        time.sleep(0.5)

        # InstitutionList
        driver.find_element(By.CSS_SELECTOR, "#tab-specialty-institution-list > a").click()
        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        # Other Tab Delete #3
        if total < 2:
            testResult = False
            Result_msg += "#3 #4 "
        else:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#specialty-institution-list_next > a").click()

            driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#3 "

            # Other Tab Delete > 2 #4
            del driver.requests
            time.sleep(1)

            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#specialty-institution-list_previous > a").click()

            driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#4 "

        # InstitutionList_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1912, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1912, testPlanID, buildName, 'p', "InstitutionList_Delete Test Passed")

    def InstitutionList_Modify():
        print("ITR-65: Configuration > Specialty > Institution list > Modify")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # InstitutionList
        driver.find_element(By.CSS_SELECTOR, "#tab-specialty-institution-list > a").click()
        driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search-name").send_keys(search_institution_3)
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search").click()
        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["InstitutionName"] == search_institution_3:
                idx = data.index(n)
                break

        # Institution Name Click #1
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/table/tbody/tr["+str(idx+1)+"]/td[2]/a").click()
        driver.wait_for_request('.*/GetSpecialtyItemList.*')
        try:
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[1]/h3"), "Specialty Rule Setting"))
        except:
            testResult = False
            Result_msg += "#1 "

        # Select Save #2
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_specialty_code_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_specialty_code_chosen > div > div > input[type=text]").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_specialty_code_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_request_code_chosen > a > span").click()
        code = driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_request_code_chosen > div > ul > li:nth-child(1)").text
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_request_code_chosen > div > ul > li:nth-child(1)").click()

        # save
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[1]/h3").text
        # save
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        del driver.requests
        time.sleep(1)

        # institution name click
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/table/tbody/tr["+str(idx+1)+"]/td[2]/a").click()
        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = False
        idx = 0
        for n in data:
            if n["RequestCodeVal"] == code:
                idx = data.index(n)
                if driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list > tbody > tr:nth-child("+str(idx+1)+") > td:nth-child(2)").text == code:
                    check = True
                break
        if (msg != "Specialty Rule을 등록하시겠습니까?" or
            no_msg != "Specialty Rule Setting" or
            check == False):
            testResult = False
            Result_msg += "#2 "

        # Select Close #3
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_specialty_code_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_specialty_code_chosen > div > div > input[type=text]").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_specialty_code_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_request_code_chosen > a > span").click()
        code = driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_request_code_chosen > div > ul > li:nth-child(1)").text
        driver.find_element(By.CSS_SELECTOR, "#specialty_institution_rulesetting_modify_request_code_chosen > div > ul > li:nth-child(1)").click()

        # close
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[1]/h3").text
        # close
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-institution-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-tab-name").text

        if (msg != "Specialty Rule 등록을 취소하시겠습니까?" or 
            no_msg != "Specialty Rule Setting" or
            yes_msg != "Institution List"):
            testResult = False
            Result_msg += "#3 "

        # InstitutionList_Modify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1918, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1918, testPlanID, buildName, 'p', "InstitutionList_Modify Test Passed")

    def InstitutionList_Modify_Search():
        print("ITR-68: Configuration > Specialty > Institution list > Modify - Search")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Specialty
        driver.find_element(By.CSS_SELECTOR, "#specialty-btn").click()
        driver.wait_for_request('.*/GetSpecialtyList.*')  
        time.sleep(0.5)

        # InstitutionList
        driver.find_element(By.CSS_SELECTOR, "#tab-specialty-institution-list > a").click()
        driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search-name").send_keys(search_institution_3)
        driver.find_element(By.CSS_SELECTOR, "#specialtyInstitution-search").click()
        request = driver.wait_for_request('.*/GetInstitutionListAssignedSpecialty.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["InstitutionName"] == search_institution_3:
                idx = data.index(n)
                break

        del driver.requests
        time.sleep(1)

        # Institution Name Click
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[2]/div[2]/div/table/tbody/tr["+str(idx+1)+"]/td[2]/a").click()
        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[1]/h3"), "Specialty Rule Setting"))

        code = ""
        for a in range (0, total):
            driver.wait_for_request('.*/GetSpecialtyItemList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for b in data:
                if b["SpecialtyCode"] == specialty_add:
                    code = b["RequestCodeVal"]
                    break

            if (code != "" or 
                a+1 == total):
                break

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_next > a").click()

        del driver.requests
        time.sleep(1)

        # Specialty Code Search #1
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search_btn").click()

        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range (0, len(data)):
            if (specialty_add not in data[n]["SpecialtyCode"] or 
                data[n]["SpecialtyCode"] != driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(1)").text):
                testResult = False
                Result_msg += "#1 "
        
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search").clear()

        del driver.requests
        time.sleep(1)

        # Request Code Search #2
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search_index_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search_index_chosen > div > ul > li:nth-child(2)").click()
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search").send_keys(code.split(':')[0])
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search_btn").click()
        
        driver.wait_for_request('.*/GetSpecialtyItemList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range (0, len(data)):
            if (code.split(':')[0] not in data[n]["RequestCode"] or 
                data[n]["RequestCode"] not in driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list > tbody > tr:nth-child("+str(n+1)+") > td:nth-child(2)").text):
                testResult = False
                Result_msg += "#2 "

        # Entries 25 #4
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select > option:nth-child(2)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 25:
            testResult = False
            Result_msg += "#4 "
        # Entries 10 #3
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select > option:nth-child(1)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 10:
            testResult = False
            Result_msg += "#3 "

        # Entries 50 #5
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select > option:nth-child(3)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 50:
            testResult = False
            Result_msg += "#5 "

        # Entries 100 #6
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-list_length > label > select > option:nth-child(4)").click()
        request = driver.wait_for_request('.*/GetSpecialtyItem.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        if data["Length"] != 100:
            testResult = False
            Result_msg += "#6 "

        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search").clear()
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search_index_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search_index_chosen > div > ul > li:nth-child(1)").click()
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search").send_keys(specialty_add)
        driver.find_element(By.CSS_SELECTOR, "#institution_specialty_rule_search_btn").click()

        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        idx = -1
        for n in data:
            if n["SpecialtyCode"] == specialty_add:
                idx = data.index(n) + 1
                break
        
        # Delete #7
        #delete
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[2]/div/div[2]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[3]/a/i").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-close-btn")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[1]/h3").text
        #delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[6]/div/div/div[2]/div/div[2]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[3]/a/i").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

        del driver.requests
        time.sleep(1)

        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        request = driver.wait_for_request('.*/GetSpecialtyItemList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        if (msg != "Specialty Rule을 삭제하시겠습니까?" or
            no_msg != "Specialty Rule Setting"):
            testResult=False
            Result_msg+="#7 "
        
        if "#7" not in Result_msg:
            for n in data:
                if n["RequestCodeVal"] == code:
                    testResult = False
                    Result_msg += "#7 "

        # Close
        driver.find_element(By.CSS_SELECTOR, "#specialty-institution-rulesetting-modify-close-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # Yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        # InstitutionList_Modify_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1931, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1931, testPlanID, buildName, 'p', "InstitutionList_Modify_Search Test Passed")


class DownloadControl:
    def User_SearchFilter_Class_Search(num):
        print("ITR-69: Configuration > Download Control > User > Search Filter - Class")
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+(str(num))+")").click()
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()

        request = driver.wait_for_request('.*/GetDownloadControlList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = True
        for n in range(1, len(data)+1):
            if (driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(2)").get_property("textContent") != data[n-1]["UserID"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").get_property("textContent") != data[n-1]["UserName"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").get_property("textContent") != (data[n-1]["Institution"].replace('<br />', '')).replace('&nbsp;', ' ')):
                check = False
                break
            
        return check
    # Render 확인
    def User_SearchFilter_Class():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        for a in range (2,6):
            temp = DownloadControl.User_SearchFilter_Class_Search(a)
            if temp == False:
                testResult = False
                Result_msg += "#1 "
                break

        # User_SearchFilter_Class결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1942, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1942, testPlanID, buildName, 'p', "User_SearchFilter_Class Test Passed")

    def User_SearchFilter_Institution_Search(num):
        print("ITR-70: Configuration > Download Control > User > Search Filter - Institution")
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(num)+")")))
        check_insti = driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(num)+")").get_property("outerText")
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(num)+")").click()
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()

        request = driver.wait_for_request('.*/GetDownloadControlList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        time.sleep(1)
        check = True
        for n in range(1, len(data)+1):
            insti = (data[n-1]["Institution"].replace('<br />', '')).replace('&nbsp;', ' ')
            if (driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(2)").get_property("textContent") != data[n-1]["UserID"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").get_property("textContent") != data[n-1]["UserName"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").get_property("textContent") != insti or 
                insti != check_insti):
                check = False
                break
            
        return check

    def User_SearchFilter_Institution():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        del driver.requests
        time.sleep(1)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
        child = driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul").get_property("childElementCount")
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child(1)").click()

        if child > 50:
            for a in range(2, 50):
                temp = DownloadControl.User_SearchFilter_Institution_Search(a)
                if temp == False:
                    testResult = False
                    Result_msg += "#1 "
                    break
        else:
            for a in range(2, child+1):
                temp = DownloadControl.User_SearchFilter_Institution_Search(a)
                if temp == False:
                    testResult = False
                    Result_msg += "#1 "
                    break

        # User_SearchFilter_Institution결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1945, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1945, testPlanID, buildName, 'p', "User_SearchFilter_Institution Test Passed")

    # target 1 = id / 2 = name
    def User_SearchFilter_Filter(target):
        rnd_id = driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child(1) > td:nth-child("+str(target+1)+")").get_property("textContent")
        rnd_insti = driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child(1) > td.align-center.download-control-institution").get_property("innerHTML")

        # User Management
        driver.find_element(By.CSS_SELECTOR, "#user-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[1]/div[1]"), "User Management List"))
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(5) > div > label").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[1]/div[2]/div/div["+str(target+2)+"]/div/div/input").send_keys(rnd_id)

        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()
        driver.wait_for_request('.*/GetUserList')
        rnd_class = driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr > td:nth-child(4)").get_property("textContent")

        del driver.requests
        time.sleep(1)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        request = driver.wait_for_request('.*/GetInstitutionList')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        for n in data:
            if n["InstitutionName"] == rnd_insti.split('<br>')[0]:
                insti_num = data.index(n) + 2
                break

        del driver.requests
        time.sleep(1)

        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[2]/div/div["+str(target+2)+"]/div/div/input").send_keys(rnd_id)
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()

        request = driver.wait_for_request('.*/GetDownloadControlList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = True
        for n in range(1, len(data)+1):
            if (rnd_id not in data[n-1]["UserID"] or
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(2)").get_property("textContent") != data[n-1]["UserID"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").get_property("textContent") != data[n-1]["UserName"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").get_property("textContent") != (data[n-1]["Institution"].replace('<br />', '')).replace('&nbsp;', ' ')):
                check = False
                break

        if check == True:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
            for n in range(2,7):
                if rnd_class == driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text:
                    driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#download-search").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            if rnd_id != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr > td:nth-child(2)").get_property("textContent"):
                check = False
            
        if check == True:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child(1)").click()

            driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(insti_num)+")").click()

            driver.find_element(By.CSS_SELECTOR, "#download-search").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            if rnd_id != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr > td:nth-child(2)").get_property("textContent"):
                check = False

        if check == True:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
            for n in range(2,7):
                if rnd_class == driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text:
                    driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#download-search").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            if rnd_id != driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr > td:nth-child(2)").get_property("textContent"):
                check = False

        return check

    def User_SearchFilter_UserID():
        print("ITR-71: Configuration > Download Control > User > Search Filter - UserID")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        temp = DownloadControl.User_SearchFilter_Filter(target=1)

        if temp == False:
            testResult = False
            Result_msg += "#1 "

        # User_SearchFilter_UserID결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1948, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1948, testPlanID, buildName, 'p', "User_SearchFilter_UserID Test Passed")

    def User_SearchFilter_UserName():
        print("ITR-72: Configuration > Download Control > User > Search Filter - User Name")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        temp = DownloadControl.User_SearchFilter_Filter(target=2)

        if temp == False:
            testResult = False
            Result_msg += "#1 "

        # User_SearchFilter_UserName결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1951, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1951, testPlanID, buildName, 'p', "User_SearchFilter_UserName Test Passed")

    def User_Add_DeletionSetup(insti_position):
        # Deletion
        driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr > td:nth-child(1) > label").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn")))
        # delete
        driver.find_element(By.CSS_SELECTOR, "#download-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-contol-add-save-btn"), "Save"))

        # User right
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-user-remove-btn")))

        # Institution right 
        driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-add-btn")))
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-remove-btn")))

    def User_Add():
        print("ITR-73: Configuration > Download Control > User > Add")
        testResult = True
        Result_msg = "failed at "
        #####request code, request name
        request_name = "Chest PA"
        #####
        
        Common.ReFresh()

        del driver.requests
        time.sleep(0.5)

        # Get info from list
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.wait_for_request(".*/GetAllAssignedList.*")

        del driver.requests
        time.sleep(0.5)

        driver.find_element(By.CSS_SELECTOR, "#tab_all_list > a").click()
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        target_modal = ""
        target_date = ""
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["Modality"] != None:
                    target_modal = n["Modality"]
                if n["JobDTTMString"] != "":
                    target_date = n["JobDTTMString"]
                if target_modal != "" and target_date != "":
                    break

            del driver.requests
            time.sleep(1)

            if (a+1 == total or
                (target_modal != "" and target_date != "")):
                break

            driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-contol-add-save-btn"), "Save"))

        # User right #1
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-user-remove-btn")))
        if wk_id_2 not in driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_selected_user_chosen > a > span").text:
            testResult = False
            Result_msg += "#1 "

        # User left #2
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-user-remove-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#sel_available_download_control_add_selected_user_chosen > a > span"),"Select an Option"))
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(Keys.ENTER)
        if wk_id_2 not in driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > a > span").text:
            testResult = False
            Result_msg += "#2 "

        # User right
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-user-remove-btn")))

        if "#1" not in Result_msg:
            # Institution right #3
            left_insti_count = driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution").get_property("childElementCount")
            for n in range (1, left_insti_count+1):
                if driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(n)+")").text == search_institution_3:
                    insti_position = n
                    driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
                    break
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-add-btn")))
            driver.find_element(By.CSS_SELECTOR, "#download-config-add-institution-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-remove-btn")))
            right_insti_count = driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-selected-institution").get_property("childElementCount")
            if driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-selected-institution > option:nth-child("+str(right_insti_count)+")").text != search_institution_3:
                testResult = False
                Result_msg += "#3 "

            # Institution left #4
            driver.find_element(By.CSS_SELECTOR, "#download-config-add-institution-remove-btn").click()
            try:
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")"), search_institution_3))
            except:
                testResult = False
                Result_msg += "#4 "

            # Institution right 
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-add-btn")))
            driver.find_element(By.CSS_SELECTOR, "#download-config-add-institution-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-remove-btn")))

            # Emergency only, Save #5 #12
            # not emergency only off
            driver.find_element(By.CSS_SELECTOR, "#download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[1]/h3")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[1]/h3").text
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            
            del driver.requests
            time.sleep(1)   

            # search
            driver.find_element(By.CSS_SELECTOR, "#download-search-user-id").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#download-search").click()
            driver.wait_for_request('.*/GetDownloadControlList.*')

            if (msg != "등록하시겠습니까?" or 
                no_msg != "Download Control Registration" or 
                driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr > td:nth-child(2)").get_property("textContent") != wk_id_2):
                testResult = False
                Result_msg += "#12 "
            
            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])
            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] != "E":
                            testResult = False
                            Result_msg += "#5 "
                            break
                    elif n["JobPriority"] != "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#5 "
                        break

                if ("#5" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.User_Add_DeletionSetup(insti_position)

            # Not Emergency Only #6
            # emergency only off
            driver.find_element(By.CSS_SELECTOR, "#download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] == "E":
                            testResult = False
                            Result_msg += "#6 "
                            break
                    elif n["JobPriority"] == "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#6 "
                        break

                if ("#6" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.User_Add_DeletionSetup(insti_position)

            # Both on #7
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])
            
            emergency_check = False
            normal_check = False
            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["JobPriority"] == "E" and emergency_check == False:
                        emergency_check = True
                    if n["JobPriority"] != "E" and normal_check == False:
                       normal_check = True

                if ((emergency_check == True and normal_check == True) or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()
            if emergency_check == False or normal_check == False:
                testResult = False
                Result_msg += "#7 "

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.User_Add_DeletionSetup(insti_position)

            # Both off #8
            driver.find_element(By.CSS_SELECTOR, "#download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        testResult = False
                        Result_msg += "#8 "
                        break
                    elif wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#8 "
                        break

                if ("#8" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.User_Add_DeletionSetup(insti_position)

            # Modality #9
            request = driver.wait_for_request('.*/GetModalityList')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            for n in data:
                if n["ModalityCode"] == target_modal:
                    temp_modal = n["ModalityDesc"]
                    break
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_modality_chosen > ul > li > input").click()
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_modality_chosen > ul > li > input").send_keys(temp_modal)
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_modality_chosen > ul > li > input").send_keys(Keys.ENTER)
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if target_modal != n["Modality"]:
                            testResult = False
                            Result_msg += "#9 "
                            break
                    elif target_modal != n["Modality"] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#9 "
                        break

                if ("#9" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.User_Add_DeletionSetup(insti_position)

            # Date(Job date) #10
            driver.find_element(By.CSS_SELECTOR, "#download-control-add-starting-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[4]/div/div[2]/button[4]")))
            target_date = target_date.split(' ')[0]
            year = target_date.split('-')[0]
            month_list = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC']
            month = target_date.split('-')[1]
            for n in range (1, 13):
                if int(month) == n:
                    month = month_list[n-1]
                    break
            day = target_date.split('-')[2]
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[4]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[4]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[4]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[4]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[4]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#download-control-add-starting-date"), target_date))

            driver.find_element(By.CSS_SELECTOR, "#download-control-add-ending-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[5]/div/div[2]/button[4]")))
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[5]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[5]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[5]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[5]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[5]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#download-control-add-ending-date"), target_date))

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if target_date != (n["JobDateDTTMString"].split(' '))[0]:
                            testResult = False
                            Result_msg += "#10 "
                            break
                    elif target_date != (n["JobDateDTTMString"].split(' '))[0] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#10 "
                        break

                if ("#10" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.User_Add_DeletionSetup(insti_position)

            # Specialty #11
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_specialty_chosen > ul > li > input").send_keys(specialty)
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_specialty_chosen > ul > li > input").send_keys(Keys.ENTER)

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if request_name != n["RequestName"]:
                            testResult = False
                            Result_msg += "#11 "
                            break
                    elif request_name != n["RequestName"] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#11 "
                        break

                if ("#11" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.User_Add_DeletionSetup(insti_position)

            # Close #13
            # close
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[1]/h3")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[1]/h3").text
            # close
            driver.find_element(By.CSS_SELECTOR, "#download-contol-add-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if (msg != "등록을 취소하시겠습니까?" or 
                no_msg != "Download Control Registration" or 
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[1]/h4").text != "Download Control List"):
                testResult = False
                Result_msg += "#13 "

        # DownloadControl_User_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1954, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1954, testPlanID, buildName, 'p', "User_Add Test Passed")

    def User_Delete():
        print("ITR-74: Configuration > Download Control > User > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-contol-add-save-btn"), "Save"))

        # User right
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-user-remove-btn")))
        
        # Institution right
        left_insti_count = driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution").get_property("childElementCount")
        for n in range (1, left_insti_count+1):
            if driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(n)+")").text == search_institution_3:
                insti_position = n
                driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
                break
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-add-btn")))
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-remove-btn")))

        # Save
        driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # Yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # Ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Nonclick Delete #1
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        # Search
        driver.find_element(By.CSS_SELECTOR, "#download-search-user-id").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-list > tbody > tr > td:nth-child(2)"), wk_id_2))
        
        # Click Delete #2
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr/td[1]/label").click()
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[1]/h4").text
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        if (msg != "삭제하시겠습니까?" or
            no_msg != "Download Control List" or 
            yes_msg != "삭제하였습니다."):
            testResult = False
            Result_msg += "#2 "

        del driver.requests
        time.sleep(1)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        for n in driver.requests:
            if "GetDownloadControlList?UserID=&UserName" in n.url:
                request = n
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        if total > 1:
            del driver.requests
            time.sleep(1)

            # Select Other Tab #3
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#download-list_next > a").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#3 "

            del driver.requests
            time.sleep(1)

            # Select Other Tab > 2 #4
            element = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[1]/label")
            driver.execute_script("arguments[0].click()",element)
            driver.find_element(By.CSS_SELECTOR, "#download-list_previous > a").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#4 "
        else:
            testResult = False
            Result_msg += "#3 #4 "

        # User_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1969, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1969, testPlanID, buildName, 'p', "User_Delete Test Passed")

    def User_Modify():
        print("ITR-75: Configuration > Download Control > User > Modify")
        testResult = True
        Result_msg = "failed at "
        #####request code, request name
        request_name = "Chest PA"
        #####
        
        Common.ReFresh()

        del driver.requests
        time.sleep(0.5)

        # Get info from list
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.wait_for_request(".*/GetAllAssignedList.*")

        del driver.requests
        time.sleep(0.5)

        driver.find_element(By.CSS_SELECTOR, "#tab_all_list > a").click()
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        target_modal = ""
        target_date = ""
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["Modality"] != None:
                    target_modal = n["Modality"]
                if n["JobDTTMString"] != "":
                    target_date = n["JobDTTMString"]
                if target_modal != "" and target_date != "":
                    break

            del driver.requests
            time.sleep(1)

            if (a+1 == total or
                (target_modal != "" and target_date != "")):
                break

            driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-contol-add-save-btn"), "Save"))

        # User right #1
        driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_add_user_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, '#sel_available_download_control_add_user_chosen > div > div > input[type=text]').send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-user-remove-btn")))
        
        # Institution right
        left_insti_count = driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution").get_property("childElementCount")
        for n in range (1, left_insti_count+1):
            if driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(n)+")").text == search_institution_3:
                insti_position = n
                driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
                break
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-add-btn")))
        driver.find_element(By.CSS_SELECTOR, "#download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-add-institution-remove-btn")))

        # Save
        driver.find_element(By.CSS_SELECTOR, "#download-contol-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # Yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # Ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Search
        driver.find_element(By.CSS_SELECTOR, "#download-search-user-id").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-list > tbody > tr > td:nth-child(2)"), wk_id_2))

        # User ID Click #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
        request = driver.wait_for_request('.*/GetModifyInstitutionList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)

        if (wk_id_2 not in driver.find_element(By.CSS_SELECTOR, "#download-control-modify-user-name").get_property("textContent") or
            data[0]["InstitutionName"] != search_institution_3 or
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[6]/div/div/div[2]/div[2]/div/div/div[3]/select/option[1]").get_property("text") != search_institution_3 or 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-check-emergency-only").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-check-not-emergency-only").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-modality").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-starting-date").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-ending-date").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_specialty_chosen > ul > li > input").get_property("disabled") != True ):
            testResult = False
            Result_msg += "#1 "

        if "#1" not in Result_msg:
            # Institution right #2
            left_insti_count = driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-all-institution").get_property("childElementCount")
            for n in range (1, left_insti_count+1):
                if driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-all-institution > option:nth-child("+str(n)+")").text == search_institution_3:
                    insti_position = n
                    driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-all-institution > option:nth-child("+str(insti_position)+")").click()
                    break

            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-add-btn")))
            driver.find_element(By.CSS_SELECTOR, "#download-config-modify-institution-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))
            right_insti_count = driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution").get_property("childElementCount")
            if driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").text != search_institution_3:
                testResult = False
                Result_msg += "#2 "

            # Institution left #3
            driver.find_element(By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn").click()
            try:
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#sel-available-download-control-modify-all-institution > option:nth-child("+str(insti_position)+")"), search_institution_3))
            except:
                testResult = False
                Result_msg += "#3 "

            # Institution right 
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-all-institution > option:nth-child("+str(insti_position)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-add-btn")))
            driver.find_element(By.CSS_SELECTOR, "#download-config-modify-institution-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            # Selected Institution Click #4
            if (driver.find_element(By.CSS_SELECTOR, "#download-control-modify-check-emergency-only").get_property("disabled") == True or 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-check-not-emergency-only").get_property("disabled") == True or 
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-modality").get_property("disabled") == True or 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-starting-date").get_property("disabled") == True or 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-ending-date").get_property("disabled") == True or 
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_specialty_chosen > ul > li > input").get_property("disabled") == True ):
                testResult = False
                Result_msg += "#4 "

            # Emergency only, Save #5 #13
            # not emergency only off
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[6]/div/div/div[1]/h3")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[6]/div/div/div[1]/h3").text
            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            del driver.requests
            time.sleep(1)

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))
            
            if (msg != "수정하시겠습니까?" or 
                no_msg != "Download Control Modify" or
                driver.find_element(By.CSS_SELECTOR, "#download-control-modify-check-not-emergency-only").get_property("checked") != False ):
                testResult = False
                Result_msg += "#13 "

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])
            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] != "E":
                            testResult = False
                            Result_msg += "#5 "
                            break
                    elif n["JobPriority"] != "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#5 "
                        break

                if ("#5" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Not Emergency Only #6
            # emergency only off
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            # not emergency only on 
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            del driver.requests
            time.sleep(1)

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] == "E":
                            testResult = False
                            Result_msg += "#6 "
                            break
                    elif n["JobPriority"] == "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#6 "
                        break

                if ("#6" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Both on #7
            # emergency only on
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            del driver.requests
            time.sleep(1)

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])
            
            emergency_check = False
            normal_check = False
            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["JobPriority"] == "E" and emergency_check == False:
                        emergency_check = True
                    if n["JobPriority"] != "E" and normal_check == False:
                        normal_check = True

                if ((emergency_check == True and normal_check == True) or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()
            if emergency_check == False or normal_check == False:
                testResult = False
                Result_msg += "#7 "

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Both off #8
            # emergency only off
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            # not emergency only off
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            time.sleep(2)

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            del driver.requests
            time.sleep(1)

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            request = driver.wait_for_request('.*/GetModalityList')
            body = request.response.body.decode('utf-8')
            modal_data = json.loads(body)

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        testResult = False
                        Result_msg += "#8 "
                        break
                    elif wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#8 "
                        break

                if ("#8" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Modality #9
            # both on
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            
            for n in modal_data:
                if n["ModalityCode"] == target_modal:
                    temp_modal = n["ModalityDesc"]
                    break
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_modality_chosen > ul > li > input").click()
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_modality_chosen > ul > li > input").send_keys(temp_modal)##
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_modality_chosen > ul > li > input").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#sel_available_download_control_modify_modality_chosen > ul > li.search-choice > span"), temp_modal))

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            del driver.requests
            time.sleep(1)

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if target_modal != n["Modality"]:
                        if n["Refer"] == None:
                            testResult = False
                            Result_msg += "#9 "
                            break
                        elif wk_id_2 not in n["Refer"]:
                            testResult = False
                            Result_msg += "#9 "
                            break

                if ("#9" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Date(Job date) #10
            # modality off
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_modality_chosen > ul > li.search-choice > a").click()

            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-starting-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[6]/div/div[2]/button[4]")))
            target_date = target_date.split(' ')[0]
            year = target_date.split('-')[0]
            month_list = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC']
            month = target_date.split('-')[1]
            for n in range (1, 13):
                if int(month) == n:
                    month = month_list[n-1]
                    break
            day = target_date.split('-')[2]
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[6]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[6]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[6]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[6]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[6]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#download-control-modify-starting-date"), target_date))

            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-ending-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[7]/div/div[2]/button[4]")))
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[7]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[7]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[7]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[7]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[7]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#download-control-modify-ending-date"), target_date))

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            del driver.requests
            time.sleep(1)

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if target_date != (n["JobDateDTTMString"].split(' '))[0]:
                            testResult = False
                            Result_msg += "#10 "
                            break
                    elif target_date != (n["JobDateDTTMString"].split(' '))[0] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#10 "
                        break

                if ("#10" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Specialty #11
            # date clear
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-starting-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[6]/div/div[2]/button[4]")))
            driver.find_element(By.XPATH, "/html/body/div[6]/div/div[2]/button[2]").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-contol-modify-save-btn")))
            driver.find_element(By.CSS_SELECTOR, "#download-control-modify-ending-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[7]/div/div[2]/button[4]")))
            driver.find_element(By.XPATH, "/html/body/div[7]/div/div[2]/button[2]").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-contol-modify-save-btn")))
            
            # specialty
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_specialty_chosen > ul > li > input").click()
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_specialty_chosen > ul > li > input").send_keys(specialty)
            driver.find_element(By.CSS_SELECTOR, "#sel_available_download_control_modify_specialty_chosen > ul > li > input").send_keys(Keys.ENTER)

            # save
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlList.*')

            del driver.requests
            time.sleep(1)

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if request_name != n["RequestName"]:
                            testResult = False
                            Result_msg += "#11 "
                            break
                    elif request_name != n["RequestName"] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#11 "
                        break

                if ("#11" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Close #14
            # close
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-contol-modify-close-btn")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[6]/div/div/div[1]/h3").text
            # close
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if (msg != "수정을 취소하시겠습니까?" or 
                no_msg != "Download Control Modify" or 
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[1]/h4").text != "Download Control List"):
                testResult = False
                Result_msg += "#14 "

            # user select
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[3]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/GetModifyInstitutionList.*')
            # institution click
            driver.find_element(By.CSS_SELECTOR, "#sel-available-download-control-modify-institution > option:nth-child("+str(right_insti_count)+")").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-config-modify-institution-remove-btn")))

            # Delete #12
            # delete
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-delete-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-contol-modify-delete-btn")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[6]/div/div/div[1]/h3").text
            # delete
            driver.find_element(By.CSS_SELECTOR, "#download-contol-modify-delete-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"),"OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))

            request = driver.wait_for_request('.*/GetDownloadControlList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["UserID"]==wk_id_2:
                    testResult= False
                    Result_msg += "#12 "

            if "#12" not in Result_msg:
                if (msg != "삭제하시겠습니까?" or
                    no_msg != "Download Control Modify"):
                    testResult= False
                    Reuslt_msg += "#12 "
       
        # User_Modify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1975, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1975, testPlanID, buildName, 'p', "User_Modify Test Passed")

    def Institution_SearchFilter_Class_Search(num):
        print("ITR-76: Configuration > Download Control > Institution > Search Filter - Class")
        del driver.requests
        time.sleep(1)

        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download_search_class_chosen > a > span")))
        driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+(str(num))+")").click()
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()

        request = driver.wait_for_request('.*/GetDownloadControlByInstList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = True
        for n in range(1, len(data)+1):
            if (driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(2)").get_property("textContent") != str(data[n-1]["InstitutionCode"]) or 
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").get_property("textContent") != data[n-1]["InstitutionName"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").get_property("textContent") != (data[n-1]["UserName"].replace('<br />', '')).replace('&nbsp;', ' ') or
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(5)").get_property("textContent") != (data[n-1]["Specialty"].replace('<br />', '')).replace('&nbsp;', ' ')):
                check = False
                break
            
        return check

    def Institution_SearchFilter_Class():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        # Instituion
        driver.find_element(By.CSS_SELECTOR, "#tab-downloadControl-byInst-list").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))

        # Class Search #1
        for a in range (2,6):
            temp = DownloadControl.Institution_SearchFilter_Class_Search(a)
            if temp == False:
                testResult = False
                Result_msg += "#1 "
                break

        # Institution_SearchFilter_Class결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1992, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1992, testPlanID, buildName, 'p', "Institution_SearchFilter_Class Test Passed")

    def Institution_SearchFilter_Institution_Search(num):
        print("ITR-77: Configuration > Download Control > Institution > Search Filter - Institution")
        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
        insti = driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(num)+")").text
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(num)+")").click()
        check_insti = driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(num)+")").get_property("outerText")
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()

        request = driver.wait_for_request('.*/GetDownloadControlByInstList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = True
        for n in range(1, len(data)+1):
            if (driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(2)").get_property("textContent") != data[n-1]["InstitutionCode"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").get_property("textContent") != data[n-1]["InstitutionName"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").get_property("textContent") != (data[n-1]["UserName"].replace('<br />', '')).replace('&nbsp;', ' ') or
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(5)").get_property("textContent") != (data[n-1]["Specialty"].replace('<br />', '')).replace('&nbsp;', ' ') or
                insti !=  driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").get_property("textContent")):
                check = False
                break
            
        return check

    def Institution_SearchFilter_Institution():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        # Instituion
        driver.find_element(By.CSS_SELECTOR, "#tab-downloadControl-byInst-list").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))
        driver.wait_for_request('.*/GetInstitutionList')
        
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
        child = driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul").get_property("childElementCount")
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child(1)").click()

        if child > 50:
            for a in range(2, 50):
                temp = DownloadControl.Institution_SearchFilter_Institution_Search(a)
                if temp == False:
                    testResult = False
                    Result_msg += "#1 "
                    break
        else:
            for a in range(2, child + 1):
                temp = DownloadControl.Institution_SearchFilter_Institution_Search(a)
                if temp == False:
                    testResult = False
                    Result_msg += "#1 "
                    break

        # Institution_SearchFilter_Institution결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1995, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1995, testPlanID, buildName, 'p', "Institution_SearchFilter_Institution Test Passed")

    # target 1 = id / 2 = name
    def Institution_SearchFilter_Filter(target):
        print("ITR-78: Configuration > Download Control > Institution > Search Filter - User ID")
        rnd_id = driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child(1) > td:nth-child("+str(target+1)+")").get_property("textContent")
        rnd_insti = driver.find_element(By.CSS_SELECTOR, "#download-list > tbody > tr:nth-child(1) > td.align-center.download-control-institution").get_property("innerHTML").split('<br>')[0]
        # User Management
        driver.find_element(By.CSS_SELECTOR, "#user-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[1]/div[1]"), "User Management List"))
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(5) > div > label").click()
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div[1]/div[2]/div/div["+str(target+2)+"]/div/div/input").send_keys(rnd_id)

        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#user-search").click()
        driver.wait_for_request('.*/GetUserList')
        rnd_class = driver.find_element(By.CSS_SELECTOR, "#user-list > tbody > tr > td:nth-child(4)").get_property("textContent")

        del driver.requests
        time.sleep(1)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        # Instituion
        driver.find_element(By.CSS_SELECTOR, "#tab-downloadControl-byInst-list").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))

        request = driver.wait_for_request('.*/GetInstitutionList')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        
        for n in data:
            if n["InstitutionName"] == rnd_insti.split('<br>')[0]:
                insti_num = data.index(n) + 2
                break

        del driver.requests
        time.sleep(1)

        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[2]/div/div["+str(target+2)+"]/div/div/input").send_keys(rnd_id)
        time.sleep(1)
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()

        request = driver.wait_for_request('.*/GetDownloadControlByInstList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = True
        for n in range(1, len(data)+1):
            if (rnd_id not in data[n-1]["UserName"] or
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(2)").get_property("textContent") != data[n-1]["InstitutionCode"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").get_property("textContent") != data[n-1]["InstitutionName"] or 
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").get_property("textContent") != ((data[n-1]["UserName"]).replace('<br />', '')).replace('&nbsp;', ' ') or 
                driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(5)").get_property("textContent") != (data[n-1]["Specialty"].replace('<br />', '')).replace('&nbsp;', ' ')):
                check = False
                break

        if check == True:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
            for n in range(2,7):
                if rnd_class == driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text:
                    driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#download-search").click()

            request = driver.wait_for_request('.*/GetDownloadControlByInstList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in range(1, len(data) + 1):
                if rnd_id not in driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").get_property("textContent"):
                    check = False
                    break
            
        if check == True:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child(1)").click()

            driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > ul > li:nth-child("+str(insti_num)+")").click()

            driver.find_element(By.CSS_SELECTOR, "#download-search").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            if rnd_id not in driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td:nth-child(4)").get_property("textContent"):
                check = False

        if check == True:
            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > a > span").click()
            for n in range(2,7):
                if rnd_class == driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").text:
                    driver.find_element(By.CSS_SELECTOR, "#download_search_class_chosen > div > ul > li:nth-child("+str(n)+")").click()
                    break
            driver.find_element(By.CSS_SELECTOR, "#download-search").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            if rnd_id not in driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td:nth-child(4)").get_property("textContent"):
                check = False

        return check

    def Institution_SearchFilter_UserID():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        temp = DownloadControl.Institution_SearchFilter_Filter(target=1)

        if temp == False:
            testResult = False
            Result_msg += "#1 "

        # Institution_SearchFilter_UserID결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(1998, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(1998, testPlanID, buildName, 'p', "Institution_SearchFilter_UserID Test Passed")

    def Institution_SearchFilter_UserName():
        print("ITR-79: Configuration > Download Control > Institution > Search Filter - User Name")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')  

        temp = DownloadControl.Institution_SearchFilter_Filter(target=2)

        if temp == False:
            testResult = False
            Result_msg += "#1 "

        # Institution_SearchFilter_UserName결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2001, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2001, testPlanID, buildName, 'p', "Institution_SearchFilter_UserName Test Passed")

    def Institution_Add_DeletionSetup(insti_position):
        print("ITR-80: Configuration > Download Control > Institution > Add")
        # Deletion
        driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td:nth-child(1) > label").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/div[1]/a[2]")))
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list-byInst_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn"), "Save"))

        # Institution right
        driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-institution-remove-btn")))

        # User right
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > a").click()
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-user-remove-btn")))

    def Institution_Add():
        testResult = True
        Result_msg = "failed at "

        #####request code, request name
        request_name = "Chest PA"
        #####
        
        Common.ReFresh()

        del driver.requests
        time.sleep(0.5)

        # Get info from list
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.wait_for_request(".*/GetAllAssignedList.*")

        del driver.requests
        time.sleep(0.5)

        driver.find_element(By.CSS_SELECTOR, "#tab_all_list > a").click()
        request = driver.wait_for_request('.*/GetAllList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        target_modal = ""
        target_date = ""
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetAllList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["Modality"] != None:
                    target_modal = n["Modality"]
                if n["JobDTTMString"] != "":
                    target_date = n["JobDTTMString"]
                if target_modal != "" and target_date != "":
                    break

            del driver.requests
            time.sleep(1)

            if (a+1 == total or
                (target_modal != "" and target_date != "")):
                break

            driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        # Instituion
        driver.find_element(By.CSS_SELECTOR, "#tab-downloadControl-byInst-list").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))  
        
        del driver.requests
        time.sleep(1)

        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list-byInst_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn"), "Save"))

        # Institution right #1
        request = driver.wait_for_request('.*/GetInstitutionList')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)

        for n in data:
            if n["InstitutionName"] == search_institution_3:
                insti_position = data.index(n) + 1
                driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
                break
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-institution-remove-btn")))
        
        child = driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-selected-institution").get_property("childElementCount")
        if driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-selected-institution > option:nth-child("+str(child)+")").text != search_institution_3:
            testResult = False
            Result_msg += "#1 "

        if testResult == True:
            # Institution left #2
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-institution-remove-btn").click()
            try:
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")"), search_institution_3))
            except:
                testResult = False
                Result_msg += "#2 "

            # Institution right
            driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(insti_position)+")").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-institution-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-institution-remove-btn")))

        if testResult == True:
            # User rigth #3
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > a").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-user-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-user-remove-btn")))
            if driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_selected_user_chosen > a > span").text.split(' - ')[0] != wk_id_2:
                testResult = False
                Result_msg += "#3 "

            if testResult == True:
                # User left #4
                driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-user-remove-btn").click()
                try:
                    WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_selected_user_chosen > a > span"), "Select an Option"))
                except:
                    testResult = False
                    Result_msg += "#4 "

                # User right
                driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > a").click()
                driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
                driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
                driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-user-add-btn").click()
                WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-user-remove-btn")))

        if testResult == True:
            # Emergency only, Save #5 #12
            # not emergency only off
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            ## save
            #driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            #WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            #msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            ## no
            #time.sleep(1)
            #driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            #WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[1]/h3")))
            #no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[5]/div/div/div[1]/h3").text
            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            
            del driver.requests
            time.sleep(1)   

            # search
            driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
            driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            driver.find_element(By.CSS_SELECTOR, "#download-search-user-id").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#download-search").click()
            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            #if (msg != "등록하시겠습니까?" or 
            #    no_msg != "Download Control Registration" or 
            #    driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td:nth-child(3)").get_property("textContent") != search_institution_3 or 
            #    driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td.align-center.download-control-institution").text.split(' - ')[0] != wk_id_2) :
            #    testResult = False
            #    Result_msg += "#12 "
            
            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])
            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] != "E":
                            testResult = False
                            Result_msg += "#5 "
                            break
                    elif n["JobPriority"] != "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#5 "
                        break

                if ("#5" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.Institution_Add_DeletionSetup(insti_position)

            # Not Emergency Only #6
            # emergency only off
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] == "E":
                            testResult = False
                            Result_msg += "#6 "
                            break
                    if n["JobPriority"] == "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#6 "
                        break

                if ("#6" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.Institution_Add_DeletionSetup(insti_position)

            # Both on #7
            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])
            
            emergency_check = False
            normal_check = False
            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["JobPriority"] == "E" and emergency_check == False:
                        emergency_check = True
                    if n["JobPriority"] != "E" and normal_check == False:
                        normal_check = True

                if ((emergency_check == True and normal_check == True) or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()
            if emergency_check == False or normal_check == False:
                testResult = False
                Result_msg += "#7 "

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.Institution_Add_DeletionSetup(insti_position)
           
            # Both off #8
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-add-popup-modal > div > div > div.modal-body > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        testResult = False
                        Result_msg += "#8 "
                        break
                    elif wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#8 "
                        break

                if ("#8" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.Institution_Add_DeletionSetup(insti_position)

            # Modality #9
            request = driver.wait_for_request('.*/GetModalityList')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            for n in data:
                if n["ModalityCode"] == target_modal:
                    temp_modal = n["ModalityDesc"]
                    break
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_modality_chosen > ul > li > input").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_modality_chosen > ul > li > input").send_keys(temp_modal)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_modality_chosen > ul > li > input").send_keys(Keys.ENTER)

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if target_modal != n["Modality"]:
                            testResult = False
                            Result_msg += "#9 "
                            break
                    elif target_modal != n["Modality"] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#9 "
                        break

                if ("#9" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.Institution_Add_DeletionSetup(insti_position)

            # Date(Job date) #10
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-add-starting-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[8]/div/div[2]/button[4]")))
            target_date = target_date.split(' ')[0]
            year = target_date.split('-')[0]
            month_list = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC']
            month = target_date.split('-')[1]
            for n in range (1, 13):
                if int(month) == n:
                    month = month_list[n-1]
                    break
            day = target_date.split('-')[2]
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[8]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[8]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[8]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[8]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[8]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#byInst-download-control-add-starting-date"), target_date))

            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-add-ending-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[9]/div/div[2]/button[4]")))
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[9]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[9]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[9]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[9]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[9]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#byInst-download-control-add-ending-date"), target_date))

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if target_date != (n["JobDateDTTMString"].split(' '))[0]:
                            testResult = False
                            Result_msg += "#10 "
                    elif target_date != (n["JobDateDTTMString"].split(' '))[0] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#10 "
                        break

                if ("#10" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.Institution_Add_DeletionSetup(insti_position)

            # Specialty #11
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_specialty_chosen > ul > li > input").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_specialty_chosen > ul > li > input").send_keys(specialty)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_specialty_chosen > ul > li > input").send_keys(Keys.ENTER)

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if request_name != n["RequestName"]:
                            testResult = False
                            Result_msg += "#11 "
                            break
                    elif request_name != n["RequestName"] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#11 "
                        break

                if ("#11" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            DownloadControl.Institution_Add_DeletionSetup(insti_position)

            # Close #13
            # close
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[7]/div/div/div[1]/h3")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[7]/div/div/div[1]/h3").text
            # close
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if (msg != "등록을 취소하시겠습니까?" or 
                no_msg != "Download Control Registration" or 
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[1]/h4").text != "Download Control List"):
                testResult = False
                Result_msg += "#13 "

        # Institution_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2004, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2004, testPlanID, buildName, 'p', "Institution_Add Test Passed")

    def Institution_Delete():
        print("ITR-81: Configuration > Download Control > Institution > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        
        # Instituion
        driver.find_element(By.CSS_SELECTOR, "#tab-downloadControl-byInst-list").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))   

        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list-byInst_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn"), "Save"))

        # Institution right
        left_insti_count = driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution").get_property("childElementCount")
        for n in range (1, left_insti_count+1):
            if driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(n)+")").text == search_institution_3:
                driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(n)+")").click()
                break
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-institution-remove-btn")))

        # User right
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > a").click()
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-user-remove-btn")))

        # save
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # Nonclick Delete #1
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        # Search
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#download-search-user-id").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td:nth-child(3)"), search_institution_3))
        
        # Click Delete #2
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[1]/label").click()
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[1]/h4").text
        # delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/div[1]/a[2]").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        if (msg != "삭제하시겠습니까?" or
            no_msg != "Download Control List" or 
            yes_msg != "삭제하였습니다."):
            testResult = False
            Result_msg += "#2 "

        del driver.requests
        time.sleep(1)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')

        del driver.requests
        time.sleep(1)

        # Instituion
        driver.find_element(By.CSS_SELECTOR, "#tab-downloadControl-byInst-list").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))   

        request = driver.wait_for_request('.*/GetDownloadControlByInstList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        if total > 1:
            del driver.requests
            time.sleep(1)

            # Select Other Tab #3
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#download-list-byInst_next > a").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#3 "

            del driver.requests
            time.sleep(1)

        # Select Other Tab > 2 #4
            element = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[1]/label")
            driver.execute_script("arguments[0].click()",element)
            driver.find_element(By.CSS_SELECTOR, "#download-list-byInst_previous > a").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#4 "
        else:
            testResult = False
            Result_msg += "#3 #4 "

        # institution_delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2019, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2019, testPlanID, buildName, 'p', "institution_delete Test Passed")

    def Institution_Modify():
        print("ITR-82: Configuration > Download Control > Institution > Modify")
        testResult = True
        Result_msg = "failed at "
        #####request code, request name
        request_name = "Chest PA"
        #####

        Common.ReFresh()

        del driver.requests
        time.sleep(0.5)

        # Get info from list
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.wait_for_request(".*/GetAllAssignedList.*")
        time.sleep(0.5)

        del driver.requests
        time.sleep(1)

        driver.find_element(By.CSS_SELECTOR, "#tab_all_list > a").click()
        request = driver.wait_for_request('.*/GetAllList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        target_modal = ""
        target_date = ""
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetAllList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["Modality"] != None:
                    target_modal = n["Modality"]
                if n["JobDTTMString"] != "":
                    target_date = n["JobDTTMString"]
                if target_modal != "" and target_date != "":
                    break

            del driver.requests
            time.sleep(1)

            if (a+1 == total or
                (target_modal != "" and target_date != "")):
                break

            driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list_next > a").click()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        time.sleep(0.5)

        # DownloadControl
        driver.find_element(By.CSS_SELECTOR, "#download-control-btn").click()
        driver.wait_for_request('.*/GetDownloadControlList.*')
        time.sleep(0.5)
        
        # Instituion
        driver.find_element(By.CSS_SELECTOR, "#tab-downloadControl-byInst-list").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))   

        # Add
        driver.find_element(By.CSS_SELECTOR, "#download-list-byInst_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn"), "Save"))

        # Institution right
        left_insti_count = driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution").get_property("childElementCount")
        for n in range (1, left_insti_count+1):
            if driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(n)+")").text == search_institution_3:
                driver.find_element(By.CSS_SELECTOR, "#byInst-sel-available-download-control-add-institution > option:nth-child("+str(n)+")").click()
                break
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-institution-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-institution-remove-btn")))

        # User right
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > a").click()
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_add_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-add-user-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-add-user-remove-btn")))

        # save
        driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-add-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        del driver.requests
        time.sleep(1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#download_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#download-search-user-id").send_keys(wk_id_2)
        driver.find_element(By.CSS_SELECTOR, "#download-search").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td:nth-child(3)"), search_institution_3))
        time.sleep(1)

        # Institution click #1
        insti_code = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").text
        insti_name = driver.find_element(By.CSS_SELECTOR, "#download-list-byInst > tbody > tr:nth-child(1) > td:nth-child(3)").text
        temp = "(" + insti_code + ") " + insti_name
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
        request = driver.wait_for_request('.*/ByInstGetModifyUserList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)

        check = False
        for n in data:
            if n["UserID"] == wk_id_2:
                check = True
                break

        if (driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-institution-name").text != temp or
            check == False or
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-check-emergency-only").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-check-not-emergency-only").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_modality_chosen > ul > li > input").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-starting-date").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-ending-date").get_property("disabled") != True or 
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_specialty_chosen > ul > li > input").get_property("disabled") != True ):
            testResult = False
            Result_msg += "#1 "

        if "#1" not in Result_msg:
            # User right #2
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_all_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_all_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_all_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-modify-user-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))
            try:
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span"), wk_id_2))
            except:
                pass
            if driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").text.split(' - ')[0] != wk_id_2:
                testResult = False
                Result_msg += "#2 "

            # Option on #4
            if (driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-check-emergency-only").get_property("disabled") != False or 
                driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-check-not-emergency-only").get_property("disabled") != False or 
                driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_modality_chosen > ul > li > input").get_property("disabled") != False or 
                driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-starting-date").get_property("disabled") != False or 
                driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-ending-date").get_property("disabled") != False or 
                driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_specialty_chosen > ul > li > input").get_property("disabled") != False ):
                testResult = False
                Result_msg += "#4 "

            # User left #3
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span"), "Select an Option"))
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_all_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_all_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_all_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            if driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_all_user_chosen > a > span").text.split(' - ')[0] != wk_id_2:
                testResult = False
                Result_msg += "#3 "

            # User right
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-config-modify-user-add-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

        if testResult == True:
            # Emergency only, Save #5 #13
            # not emergency only off
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[8]/div/div/div[1]/h3")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[8]/div/div/div[1]/h3").text
            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')
            time.sleep(0.5)

            del driver.requests
            time.sleep(1)

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))
            
            if (msg != "수정하시겠습니까?" or 
                no_msg != "Download Control Modify" or
                driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-check-not-emergency-only").get_property("checked") != False ):
                testResult = False
                Result_msg += "#13 "

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])
            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] != "E":
                            testResult = False
                            Result_msg += "#5 "
                            break
                    elif n["JobPriority"] != "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#5 "
                        break

                if ("#5" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Not Emergency Only #6
            # emergency only off
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            # not emergency only on 
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            del driver.requests
            time.sleep(1)

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if n["JobPriority"] == "E":
                            testResult = False
                            Result_msg += "#6 "
                            break
                    elif n["JobPriority"] == "E" and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#6 "
                        break

                if ("#6" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Both on #7
            # emergency only on
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            del driver.requests
            time.sleep(1)

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])
            
            emergency_check = False
            normal_check = False
            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["JobPriority"] == "E" and emergency_check == False:
                        emergency_check = True
                    if n["JobPriority"] != "E" and normal_check == False:
                        normal_check = True

                if ((emergency_check == True and normal_check == True) or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()
            if emergency_check == False or normal_check == False:
                testResult = False
                Result_msg += "#7 "

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Both off #8
            # emergency only off
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            # not emergency only off
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            time.sleep(2)

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            del driver.requests
            time.sleep(1)

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

            request = driver.wait_for_request('.*/GetModalityList')
            body = request.response.body.decode('utf-8')
            modal_data = json.loads(body)

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        testResult = False
                        Result_msg += "#8 "
                        break
                    elif wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#8 "
                        break

                if ("#8" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Modality #9
            # both on
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(1) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-byInst-modify-popup-modal > div > div > div.modal-body > div:nth-child(3) > div:nth-child(2) > div > div:nth-child(2) > label").click()
            
            for n in modal_data:
                if n["ModalityCode"] == target_modal:
                    temp_modal = n["ModalityDesc"]
                    break
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_modality_chosen > ul > li > input").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_modality_chosen > ul > li > input").send_keys(temp_modal)##
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_modality_chosen > ul > li > input").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_modality_chosen > ul > li.search-choice > span"), temp_modal))

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            del driver.requests
            time.sleep(1)

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if target_modal != n["Modality"]:
                        if n["Refer"] == None:
                            testResult = False
                            Result_msg += "#9 "
                            break
                        elif wk_id_2 not in n["Refer"]:
                            testResult = False
                            Result_msg += "#9 "
                            break

                if ("#9" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Date(Job date) #10
            # modality off
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_modality_chosen > ul > li.search-choice > a").click()

            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-starting-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[10]/div/div[2]/button[4]")))
            target_date = target_date.split(' ')[0]
            year = target_date.split('-')[0]
            month_list = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC']
            month = target_date.split('-')[1]
            for n in range (1, 13):
                if int(month) == n:
                    month = month_list[n-1]
                    break
            day = target_date.split('-')[2]
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[10]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[10]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[10]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[10]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[10]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#byInst-download-control-modify-starting-date"), target_date))

            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-ending-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[11]/div/div[2]/button[4]")))
            while(1):
                if (driver.find_element(By.XPATH, "/html/body/div[11]/div/div[1]/div[1]/div[3]/div[2]").text == year and 
                    driver.find_element(By.XPATH, "/html/body/div[11]/div/div[1]/div[1]/div[1]/div[2]").text == month):
                    break
                driver.find_element(By.XPATH, "/html/body/div[11]/div/div[1]/div[1]/div[1]/div[1]/a/i").click()
                time.sleep(0.3)
            time.sleep(1)
            check = False
            for a in range(2, 7):
                for b in range(1, 8):
                    if driver.find_element(By.XPATH, "/html/body/div[11]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").get_property("textContent") == day:
                        driver.find_element(By.XPATH, "/html/body/div[11]/div/div[1]/div[3]/div[1]/table/tbody/tr["+str(a)+"]/td["+str(b)+"]").click()
                        check = True
                        break
                if check == True:
                    break
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#byInst-download-control-modify-ending-date"), target_date))

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            del driver.requests
            time.sleep(1)

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if target_date != (n["JobDateDTTMString"].split(' '))[0]:
                            testResult = False
                            Result_msg += "#10 "
                            break
                    elif target_date != (n["JobDateDTTMString"].split(' '))[0] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#10 "
                        break

                if ("#10" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Specialty #11
            # date clear
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-starting-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[10]/div/div[2]/button[4]")))
            driver.find_element(By.XPATH, "/html/body/div[10]/div/div[2]/button[2]").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn")))
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-control-modify-ending-date").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/div[11]/div/div[2]/button[4]")))
            driver.find_element(By.XPATH, "/html/body/div[11]/div/div[2]/button[2]").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn")))
            
            # specialty
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_specialty_chosen > ul > li > input").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_specialty_chosen > ul > li > input").send_keys(specialty)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_specialty_chosen > ul > li > input").send_keys(Keys.ENTER)

            # save
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            driver.wait_for_request('.*/GetDownloadControlByInstList.*')

            del driver.requests
            time.sleep(1)

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

            # 새로운 탭 + 전환
            driver.execute_script("window.open()")
            driver.switch_to.window(driver.window_handles[1])

            del driver.requests
            time.sleep(1)

            driver.get(WorklistUrl);
            signInOut.wk_login(wk_id_2, wk_pw_2)

            request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"]/data["Length"])

            for a in range (0, total+1):
                request = driver.wait_for_request('.*/GetCurrentJobWorklist.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["Refer"] == None:
                        if request_name != n["RequestName"] :
                            testResult = False
                            Result_msg += "#11 "
                            break
                    elif request_name != n["RequestName"] and wk_id_2 not in n["Refer"]:
                        testResult = False
                        Result_msg += "#11 "
                        break

                if ("#11" in Result_msg or 
                    a+1 == total):
                    break

                del driver.requests
                time.sleep(1)

                driver.find_element(By.CSS_SELECTOR, "#current-job-list_next > a").click()

            # logout 및 전환
            driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout > span").click()
            driver.implicitly_wait(5)
            driver.close()
            driver.switch_to.window(driver.window_handles[0])

            # Close #14
            # close
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-contol-modify-close-btn")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[8]/div/div/div[1]/h3").text
            # close
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if (msg != "수정을 취소하시겠습니까?" or 
                no_msg != "Download Control Modify" or 
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[1]/div[1]/h4").text != "Download Control List"):
                testResult = False
                Result_msg += "#14 "

            # code click
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div/table/tbody/tr[1]/td[2]/a").click()
            driver.wait_for_request('.*/ByInstGetModifyUserList.*')
            # user click
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(wk_id_2)
            driver.find_element(By.CSS_SELECTOR, "#byInst_sel_available_download_control_modify_user_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-config-modify-user-remove-btn")))

            # Delete #12
            ## delete
            #driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-delete-btn").click()
            #WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            #msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            ## no
            #time.sleep(1)
            #driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            #WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#byInst-download-contol-modify-delete-btn")))
            #no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[8]/div/div/div[1]/h3").text
            # delete
            driver.find_element(By.CSS_SELECTOR, "#byInst-download-contol-modify-delete-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"),"OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#download-search")))

            request = driver.wait_for_request('.*/GetDownloadControlByInstList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["InstitutionName"]==search_institution_3:
                    testResult= False
                    Result_msg += "#12 "

            #if "#12" not in Result_msg:
            #    if (msg != "삭제하시겠습니까?" or
            #        no_msg != "Download Control Modify"):
            #        testResult= False
            #        Reuslt_msg += "#12 "

        # Institution_Modify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2025, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2025, testPlanID, buildName, 'p', "Institution_Modify Test Passed")

class Institution:
    def insti_idx_find(target):
        print("ITR-83: Configuration > Institution > Search Filter > Institution Code")
        # Find
        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        idx = 0
        check = False
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetInstitutionsList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["InstitutionName"] == target:
                    idx = data.index(n) + 1
                    check = True
                    break
            if check == True:
                break
            del driver.requests
            time.sleep(0.1)
            driver.find_element(By.CSS_SELECTOR, "#institutions-list_next > a").click()

        return idx

    def SearchFilter_Institution_Code():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Institution
        driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        search_institution_code = data[0]["InstitutionCode"]
        
        del driver.requests
        time.sleep(0.1)
        
        driver.find_element(By.CSS_SELECTOR, "#institutions-search-institution-code").send_keys(search_institution_code)
        driver.find_element(By.CSS_SELECTOR, "#institutions-search").click()

        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = True
        num = 0
        for n in data:
            if search_institution_code not in n["InstitutionCode"]:
                check = False

            lst = ["InstitutionCode", "InstitutionName", "CenterCodeList", "ReportModificationMode", "ReportingRuleCount", "ReportingDownloadDelayTime"]
            for a in lst:
                if n[a] == None:
                    n[a] = ""

            num += 1
            if (driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(2)").text != n["InstitutionCode"] or
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(3)").text != n["InstitutionName"] or 
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(4)").text != n["CenterCodeList"] or 
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(5)").text != n["ReportModificationMode"] or 
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(6)").text != str(n["ReportingRuleCount"]) or
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(7)").text != n["ReportingDownloadDelayTime"]):
                check = False

            if check == False:
                testResult = False
                Result_msg += "#1 "
                break

        # SearchFilter_InstitutionCode결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2043, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2043, testPlanID, buildName, 'p', "SearchFilter_InstitutionCode Test Passed")
    
    def SearchFilter_Institution_Name():
        print("ITR-84: Configuration > Institution > Search Filter > Institution Name")
        testResult = True
        Result_msg = "failed at "

        del driver.requests
        time.sleep(1)
        
        driver.find_element(By.CSS_SELECTOR, "#institutions-search-institution-code").clear()
        driver.find_element(By.CSS_SELECTOR, "#institutions-search-institution-name").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#institutions-search").click()

        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        check = True
        num = 0
        for n in data:
            if search_institution_2 not in n["InstitutionName"]:
                print("1")
                check = False

            lst = ["InstitutionCode", "InstitutionName", "CenterCodeList", "ReportModificationMode", "ReportingRuleCount", "ReportingDownloadDelayTime"]
            for a in lst:
                if n[a] == None:
                    n[a] = ""

            num += 1
            if (driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(2)").text != n["InstitutionCode"] or
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(3)").text != n["InstitutionName"] or 
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(4)").text != n["CenterCodeList"] or 
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(5)").text != n["ReportModificationMode"] or 
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(6)").text != str(n["ReportingRuleCount"]) or
                driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(num)+") > td:nth-child(7)").text != n["ReportingDownloadDelayTime"]):
                check = False

            if check == False:
                testResult = False
                Result_msg += "#1 "
                break

        # SearchFilter_InstitutionName결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2046, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2046, testPlanID, buildName, 'p', "SearchFilter_InstitutionName Test Passed")

    def Add():
        print("ITR-85: Configuration > Institution > Add")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        time.sleep(0.5)

        del driver.requests
        time.sleep(1)

        # Institution
        driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        search_institution_code = data[0]["InstitutionCode"]
        
        # Add #1
        driver.find_element(By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        try:
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[3]/div/div/div[1]/h3")))
            assert(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[3]/div/div/div[1]/h3").text == "Institutions Registration")
        except:
            testResult = False
            Result_msg += "#1 "

        if testResult == True:
            # None input Save Yes #2
            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-save-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            try:
                WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2"),"Institution Code를 입력해주세요."))
            except:
                testResult = False
                Result_msg += "#2 "
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-add-save-btn")))
                

            # Institution Code input #3 4
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-institution-code").send_keys("123456")
 
            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-save-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(0.5)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            try:
                WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2"),"Institution Name를 입력해주세요."))
            except:
                testResult = False
                if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2") == "Exist검사 중 문제가 발생하였습니다.":
                    Result_msg += "#3 "
                else:
                    Result_msg += "#4 "
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-add-save-btn"))) 
            
            # Already Institution Code #5
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-institution-code").clear()
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-institution-code").send_keys(search_institution_code)
            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-save-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(0.5)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            try:
                WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2"),"이미 동일한 내용이 존재합니다."))
            except:
                testResult = False
                Result_msg += "#5 "
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-add-save-btn"))) 

            # Center #6
            driver.find_element(By.CSS_SELECTOR, "#institutions_add_center_code_list_chosen > ul > li > input[type=text]").click()
            driver.find_element(By.CSS_SELECTOR, "#institutions_add_center_code_list_chosen > ul > li > input[type=text]").send_keys(search_center)
            driver.find_element(By.CSS_SELECTOR, "#institutions_add_center_code_list_chosen > ul > li > input[type=text]").send_keys(Keys.ENTER)
            try:
                WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#institutions_add_center_code_list_chosen > ul > li.search-choice > span"),search_center))
            except:
                testResult = False
                Result_msg += "#6 "

            # Center X #7
            if "#6" not in Result_msg:
                driver.find_element(By.CSS_SELECTOR, "#institutions_add_center_code_list_chosen > ul > li.search-choice > a").click()
                try:
                    WebDriverWait(driver, 0.5).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#institutions_add_center_code_list_chosen > ul > li.search-choice > span"),search_center))
                    testResult = False
                    Result_msg += "#7 "
                except:
                    pass
            
            # input Institution Name
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-institution-code").clear()
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-institution-code").send_keys("123456")
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-institution-name").send_keys("Cloud_ITRTest")

            del driver.requests
            time.sleep(1)

            # Save #15
            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-save-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[3]/div/div/div[1]/h3")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[3]/div/div/div[1]/h3").text
            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-save-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            try:
                assert((msg == "등록하시겠습니까?") and (no_msg == "Institutions Registration"))
                WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2"),"등록하였습니다."))
            except:
                testResult = False
                Result_msg += "#15 "
            # ok
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn"))) 

            if "#15" not in Result_msg:
                request = driver.wait_for_request('.*/GetInstitutionsList.*')
                time.sleep(0.5)
                body = request.response.body.decode('utf-8')
                data = json.loads(body)
                total = math.ceil(data["recordsFiltered"] / data["Length"])

                check = False
                for a in range(0, total):
                    request = driver.wait_for_request('.*/GetInstitutionsList.*')
                    body = request.response.body.decode('utf-8')
                    data = json.loads(body)["data"]

                    for n in data:
                        if n["InstitutionName"] == "Cloud_ITRTest":
                            if driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(data.index(n)+1)+") > td:nth-child(3)").text == "Cloud_ITRTest":
                                check = True
                            break
                    if check == True:
                        break
                    del driver.requests
                    time.sleep(1)
                    driver.find_element(By.CSS_SELECTOR, "#institutions-list_next > a").click()

                if check== False:
                    testResult = False
                    Result_msg += "#15 "

            # Close #14
            # add
            driver.find_element(By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[3]/div/div/div[1]/h3")))
            # close
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-close-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-add-close-btn")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[3]/div/div/div[1]/h3").text
            # close
            driver.find_element(By.CSS_SELECTOR, "#institutions-add-close-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(0.5)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            #WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
            try:
                assert((msg == "등록을 취소하시겠습니까?")and(no_msg == "Institutions Registration"))
                WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#institutions-tab-name"),"Institution List"))
            except:
                testResult = False
                Result_msg += "#14 "

        # Institution_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2049, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2049, testPlanID, buildName, 'p', "Institution_Add Test Passed")

    # Cloud_ITRTest
    def Delete():
        print("ITR-86: Configuration > Institution > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        time.sleep(0.5)

        del driver.requests
        time.sleep(1)

        # Institution
        driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
        driver.wait_for_request('.*/GetInstitutionsList.*')
        time.sleep(0.5)
        
        # None Selecet Delete #1
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        # Select Delete #2
        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        check = False
        for a in range(0, total):
            request = driver.wait_for_request('.*/GetInstitutionsList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["InstitutionName"] == "Cloud_ITRTest":
                    if driver.find_element(By.CSS_SELECTOR, "#institutions-list > tbody > tr:nth-child("+str(data.index(n)+1)+") > td:nth-child(3)").text == "Cloud_ITRTest":
                        check = True
                        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(data.index(n)+1)+"]/td[1]/label").click()
                    break
            if check == True:
                break
            del driver.requests
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "#institutions-list_next > a").click()
        # delete
        driver.find_element(By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn").click()
        WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn")))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#institutions-tab-name").text
        # delete
        driver.find_element(By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn").click()
        WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

        del driver.requests
        time.sleep(1)

        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        try:
            assert((msg == "삭제하시겠습니까?") and (no_msg == "Institution List"))
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2"), "삭제하였습니다."))
        except:
            testResult = False
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        if "#2 " not in Result_msg:
            request = driver.wait_for_request('.*/GetInstitutionsList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            total = math.ceil(data["recordsFiltered"] / data["Length"])

            check = False
            for a in range(0, total):
                request = driver.wait_for_request('.*/GetInstitutionsList.*')
                body = request.response.body.decode('utf-8')
                data = json.loads(body)["data"]

                for n in data:
                    if n["InstitutionName"] == "Cloud_ITRTest":
                        testResult = False
                        Result_msg += "#2 "
                        check = True    
                        break
                if check == True:
                    break
                del driver.requests
                time.sleep(0.1)
                driver.find_element(By.CSS_SELECTOR, "#institutions-list_next > a").click()

        # Institution
        driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
        request = driver.wait_for_request('.*/GetInstitutionsList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        if total < 2:
            testResult = False
            Result_msg += "#3 #4 "

        if ("#3" not in Result_msg) and ("#4" not in Result_msg):
            # Select & Other Tab #3
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[1]/label")))
            time.sleep(1)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#institutions-list_next > a").click()
            driver.wait_for_request('.*/GetInstitutionsList.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#3 "

            # Select at 2> & Other Tab #4
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()

            del driver.requests
            time.sleep(0.1)

            driver.find_element(By.CSS_SELECTOR, "#institutions-list_previous > a").click()
            driver.wait_for_request('.*/GetInstitutionsList.*')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/div[1]/a[2]").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#4 "

        # Institution_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2066, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2066, testPlanID, buildName, 'p', "Institution_Delete Test Passed")

    def Modify_ToWL(RM_num, RM, RDT_num, RDT):
        print("ITR-87: Configuration > Institution > Modify")
        Result_msg = ""
        time.sleep(1)

        # report mode - None
        driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_mode_chosen").click()
        #driver.execute_script("arguments[0].click()",element)
        driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_mode_chosen > div > ul > li:nth-child("+str(RM_num)+")").click()

        # report delay time - None
        driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_time_chosen").click()
        driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_time_chosen > div > ul > li:nth-child("+str(RDT_num)+")").click()

        del driver.requests

        # save
        driver.find_element(By.CSS_SELECTOR, "#institutions-modify-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[1]/h3").get_property("textContent")
        # save
        driver.find_element(By.CSS_SELECTOR, "#institutions-modify-save-btn").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        
        # 새로운 탭 + 전환
        driver.execute_script("window.open()")
        driver.switch_to.window(driver.window_handles[1])
        driver.get(WorklistUrl);
        driver.implicitly_wait(5)
        signInOut.wk_login(wk_id, wk_pw)

        # search hospital
        driver.find_element(By.CSS_SELECTOR, "#search_institution_chosen > a").click()
        driver.find_element(By.CSS_SELECTOR, "#search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_3)
        driver.find_element(By.CSS_SELECTOR, "#search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#current-hospital-name"), search_institution_3))
        
        # set job report
        driver.find_element(By.CSS_SELECTOR, "#setting_columns > i").click()
        WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#setting-columns-apply")))
        if driver.find_element(By.CSS_SELECTOR, "#chk-column-5").get_property("checked") == False:
            driver.find_element(By.CSS_SELECTOR, "#modal-setting-columns > div > div > div.modal-body > div:nth-child(1) > div.setting-column > ul > li:nth-child(5) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#setting-columns-apply").click()
        time.sleep(1)
        num = 0
        while(1):
            try:
                num += 1
                if driver.find_element(By.XPATH, "/html/body/section[1]/div/div/div/section[1]/div[3]/div/div[2]/div/div[4]/div[1]/div/table/thead/tr/th["+str(num)+"]").get_property("textContent") == "Job Report":
                   break
            except:
                Result_msg += "worklist setting "
                return Result_msg
         
        driver.find_element(By.XPATH, "/html/body/section[1]/div/div/div/section[1]/div[3]/div/div[2]/div/div[4]/div[2]/table/tbody/tr[1]/td["+str(num)+"]/span/label").click()
        # 탭 전환
        driver.switch_to.window(driver.window_handles[2])
        driver.implicitly_wait(5)
        driver.wait_for_request(".*/GetJobReport.*")
        
        if RM_num != 1:
            if RM not in driver.find_element(By.CSS_SELECTOR, "#job-report-view-report-mode").get_property("textContent"):
                Result_msg += "#6 "
        else:
            if "" != driver.find_element(By.CSS_SELECTOR, "#job-report-view-report-mode").get_property("textContent"):
                Result_msg += "#6 "
        if RDT not in driver.find_element(By.CSS_SELECTOR, "#job-report-view-delaytime").get_property("textContent"):
            Result_msg += "#7 "

        if (Result_msg != "" or 
            msg != "수정하시겠습니까?" or 
            no_msg != "Institutions Modify"):
            Result_msg += "#13 "

        driver.close()
        driver.switch_to.window(driver.window_handles[1])

        driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout").click()
        driver.implicitly_wait(5)
        driver.close()
        driver.switch_to.window(driver.window_handles[0])

        return Result_msg
        

    def Modify():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        time.sleep(0.5)

        del driver.requests
        time.sleep(1)

        # Institution
        driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
        driver.wait_for_request('.*/GetInstitutionsList.*')
        time.sleep(0.5)
        
        # Find
        idx = Institution.insti_idx_find(search_institution_3)
        # Select Institution Code #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))
        try:
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))
        except:
            testResult = False
            Result_msg += "#1 "

        if "#1" not in Result_msg:
            # Change Institution Code #2
            if driver.find_element(By.CSS_SELECTOR, "#institutions-modify-institution-code").value_of_css_property("cursor") != "not-allowed":
                testResult = False
                Result_msg += "#2 "

            # Change Institution Name #3
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-institution-name").send_keys("_re")
            time.sleep(1)
            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-save-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3+"_re"))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[1]/h3").get_property("textContent")
            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-save-btn").click()
            WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))

            del driver.requests
            time.sleep(1)

            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
            # find
            idx = Institution.insti_idx_find(search_institution_3+"_re")
            if (idx == 0 or 
                msg != "수정하시겠습니까?" or 
                no_msg != "Institutions Modify") :
                testResult = False
                Result_msg += "#3 "

            # Select Institution Code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-institution-name").clear()
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-institution-name").send_keys(search_institution_3)

            time.sleep(1)#
            # Center X #5
            temp = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[3]/div/div[2]/div/ul/li[1]/span").get_property("outerText")
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[1]/div[3]/div/div[2]/div/ul/li[1]/a").click()
            driver.find_element(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > ul > li.search-field > input[type=text]").click()
            time.sleep(1)
            child = driver.find_element(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > div > ul").get_property("childElementCount")
            check = False
            for n in range (1, child+1):
                if temp == driver.find_element(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > div > ul > li:nth-child("+str(n)+")").text:
                    
                    check = True
                    break
            if check == False:
                testResult = False
                Result_msg += "#5 "

            # Center Select #4
            driver.find_element(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > ul > li.search-field > input[type=text]").send_keys(temp)
            driver.find_element(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > ul > li.search-field > input[type=text]").send_keys(Keys.ENTER)
            
            elements = driver.find_elements(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > ul > li.search-choice > span")
            check = False
            for n in elements:
                if temp == n.get_property("outerText"):
                    check = True
                    break
            if check  == False:
                testResult = False
                Result_msg += "#4 "

            # Report Mode, Delay Time, Save #6 7 13
            ori_RM = driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_mode_chosen > a > span").text
            ori_RDT = driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_time_chosen > a > span").text
            ori_comment = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-use-referring-comment2").get_property("checked")
            ori_revised = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-enable-revised").get_property("checked")
            ori_discard = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-enable-discard").get_property("checked")
            ori_request = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-enable-request").get_property("checked") 

            #driver.find_element(By.CSS_SELECTOR, "#institutions-modify-institution-name").send_keys("")

            temp = Institution.Modify_ToWL(1, "", 1, "0분")
            if temp != "":
                testResult= False
                Result_msg += temp

            # Find
            idx = Institution.insti_idx_find(search_institution_3)
        
            # select institution code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))

            temp = Institution.Modify_ToWL(2, "Overwrite", 2, "30분")
            if temp != "":
                testResult= False
                Result_msg += temp

            # Find
            idx = Institution.insti_idx_find(search_institution_3)
        
            # select institution code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))

            temp = Institution.Modify_ToWL(3, "Addendum", 3, "60분")
            if temp != "":
                testResult= False
                Result_msg += temp

            # Find
            idx = Institution.insti_idx_find(search_institution_3)
        
            # select institution code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))

            temp = Institution.Modify_ToWL(4, "Prohibition", 4, "120분")
            if temp != "":
                testResult= False
            Result_msg += temp 

            # Find
            idx = Institution.insti_idx_find(search_institution_3)
        
            # select institution code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))

            temp = Institution.Modify_ToWL(4, "Prohibition", 5, "180분")
            if temp != "":
                testResult= False
                Result_msg += temp 

            # Find
            idx = Institution.insti_idx_find(search_institution_3)
        
            # select institution code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))

            # Comment, Revised, Discard, Request  #8 9 10 11
            # comment - check
            if ori_comment == driver.find_element(By.CSS_SELECTOR, "#institutions-modify-use-referring-comment2").get_property("checked") == False:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(6) > div > div > label").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#institution-modify-refer-comment-select-box > li > span"), "+ Create New Comment"))

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#institution-modify-refer-comment-select-box > li").click()
            request = driver.wait_for_request(".*/LoadReferringComments")
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[2]/div/div[2]/ul/li["+str(len(data)+1)+"]").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institution-modify-refer-comment-title"), "New Refer Comment"))
            driver.find_element(By.CSS_SELECTOR, "#institution-modify-refer-comment-title").clear()
            driver.find_element(By.CSS_SELECTOR, "#institution-modify-refer-comment-title").send_keys("test_comment")
            driver.find_element(By.CSS_SELECTOR, "#institution-modify-refer-comment-text").send_keys("test_comment")
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institution-modify-refer-comment-text"), "test_comment"))
            driver.find_element(By.CSS_SELECTOR, "#modify-institution-refer-comment-confirm-btn").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[2]/div/div[2]/ul/li["+str(len(data)+1)+"]").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institution-modify-refer-comment-title"), "test_comment"))
            driver.find_element(By.CSS_SELECTOR, "#modify-institution-refer-comment-set-default-btn").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # revised - check
            if ori_revised == driver.find_element(By.CSS_SELECTOR, "#institutions-modify-enable-revised").get_property("checked") == False:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(7) > div > div > label").click()

            # discard - check
            if ori_discard == driver.find_element(By.CSS_SELECTOR, "#institutions-modify-enable-discard").get_property("checked") == False:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(8) > div > div > label").click()

            # request - check
            if ori_request == driver.find_element(By.CSS_SELECTOR, "#institutions-modify-enable-request").get_property("checked") == False:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(9) > div > div > label").click()

            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))

            del driver.requests
            time.sleep(1)
            
            # refer
            element = driver.find_element(By.CSS_SELECTOR, "#tab-refer > a")
            driver.execute_script("arguments[0].click()",element)
            driver.wait_for_request(".*/GetReferCountsByInstitution.*")
            time.sleep(0.5)

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
            driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            driver.wait_for_request(".*/GetAllAssignedList.*")
            time.sleep(0.5)

            del driver.requests
            time.sleep(1)
            
            driver.find_element(By.CSS_SELECTOR, "#tab_all_list > a").click()
            driver.wait_for_request(".*/GetAllList.*")
            time.sleep(0.5)

            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[2]/table/tbody/tr[1]/td[1]/label").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#refer_tab > div > div:nth-child(4) > div > div.p-t-15 > div.row > div:nth-child(2) > button.btn.bg-purple.btn-xs.waves-effect.refer-btn")))
            driver.find_element(By.CSS_SELECTOR, "#refer_tab > div > div:nth-child(4) > div > div.p-t-15 > div.row > div:nth-child(2) > button.btn.bg-purple.btn-xs.waves-effect.refer-btn").click()
            try:
                WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#refer-comments"), "test_comment"))
            except:
                testResult = False
                Result_msg += "#8 "
            driver.find_element(By.CSS_SELECTOR, "#refer-close").click()
            try:
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#refer-revised-btn > span")))
            except:
                testResult = False
                Result_msg += "#9 "
            try:
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#refer-discard-btn > span")))
            except:
                testResult = False
                Result_msg += "#10 "
            try:
                WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#refer-retry-btn > span")))
            except:
                testResult = False
                Result_msg += "#11 "

            del driver.requests
            time.sleep(1)

            # Configuration
            driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
            driver.implicitly_wait(5)

            # Institution
            driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
            driver.wait_for_request('.*/GetInstitutionsList.*')
            time.sleep(0.5)

            # Find
            idx = Institution.insti_idx_find(search_institution_3)

            del driver.requests
            time.sleep(1)
        
            # select institution code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))

            # delete comment
            driver.wait_for_request(".*/LoadReferringComments")
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[2]/div/div[2]/ul/li[2]/button")))
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[2]/div[2]/div/div[2]/ul/li[2]/button").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

            # comment -ucheck
            driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(6) > div > div > label").click()
            # revised - uncheck
            driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(7) > div > div > label").click()
            # discard - uncheck
            driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(8) > div > div > label").click()
            # request - uncheck
            driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(9) > div > div > label").click()

            # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))

            del driver.requests
            time.sleep(1)
            
            # refer
            element = driver.find_element(By.CSS_SELECTOR, "#tab-refer > a")
            driver.execute_script("arguments[0].click()",element)
            driver.wait_for_request(".*/GetReferCountsByInstitution.*")
            time.sleep(0.5)

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > a > span").click()
            driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
            driver.find_element(By.CSS_SELECTOR, "#refer_search_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
            driver.wait_for_request(".*/GetAllAssignedList.*")
            time.sleep(0.5)

            del driver.requests
            time.sleep(1)
            
            driver.find_element(By.CSS_SELECTOR, "#tab_all_list > a").click()
            driver.wait_for_request(".*/GetAllList.*")
            time.sleep(0.5)

            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[4]/div/div[2]/div[2]/div/div[2]/div[2]/table/tbody/tr[1]/td[1]/label").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#refer_tab > div > div:nth-child(4) > div > div.p-t-15 > div.row > div:nth-child(2) > button.btn.bg-purple.btn-xs.waves-effect.refer-btn")))
            driver.find_element(By.CSS_SELECTOR, "#refer_tab > div > div:nth-child(4) > div > div.p-t-15 > div.row > div:nth-child(2) > button.btn.bg-purple.btn-xs.waves-effect.refer-btn").click()
            try:
                WebDriverWait(driver, 0.5).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#refer-comments"), "test_comment"))
                testResult = False
                Result_msg += "#8 "
            except:
                pass
            driver.find_element(By.CSS_SELECTOR, "#refer-close").click()
            try:
                WebDriverWait(driver, 0.5).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#refer-revised-btn > span")))
                testResult = False
                Result_msg += "#9 "
            except:
                pass
            try:
                WebDriverWait(driver, 0.5).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#refer-discard-btn > span")))
                testResult = False
                Result_msg += "#10 "
            except:
                pass
            try:
                WebDriverWait(driver, 0.5).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#refer-retry-btn > span")))
                testResult = False
                Result_msg += "#11 "
            except:
                pass

            del driver.requests
            time.sleep(1)

            # Configuration
            driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
            driver.implicitly_wait(5)

            # Institution
            driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
            driver.wait_for_request('.*/GetInstitutionsList.*')
            time.sleep(0.5)

            # Find
            idx = Institution.insti_idx_find(search_institution_3)

            del driver.requests
            time.sleep(1)
        
            # select institution code
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr["+str(idx)+"]/td[2]/a").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#institutions-modify-institution-name"), search_institution_3))
            
            # set
            driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_mode_chosen > a > span").click()
            for n in range(1,5):
                if driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_mode_chosen > div > ul > li:nth-child("+str(n)+")").text == ori_RM:
                    driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_mode_chosen > div > ul > li:nth-child("+str(n)+")").click()
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#institutions_modify_report_mode_chosen > a > span"), ori_RM))
            driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_time_chosen > a > span").click()
            for n in range(1, 6):
                if driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_time_chosen > div > ul > li:nth-child("+str(n)+")").text == ori_RDT:
                    driver.find_element(By.CSS_SELECTOR, "#institutions_modify_report_time_chosen > div > ul > li:nth-child("+str(n)+")").click()
            if ori_comment == True:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(6) > div > div > label").click()
            if ori_revised == True:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(7) > div > div > label").click()
            if ori_discard == True:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(8) > div > div > label").click()
            if ori_request == True:
                driver.find_element(By.CSS_SELECTOR, "#not-use-default-refer-comment > div:nth-child(9) > div > div > label").click()

             # save
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-save-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2")))
            # yes
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
            # ok
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
            
            # Cancel #12
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[2]/a").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-modify-close-btn")))
            # cancel
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            # no
            time.sleep(1)
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
            WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#institutions-modify-close-btn")))
            no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[4]/div/div/div[1]/h3").text
            # cancel
            driver.find_element(By.CSS_SELECTOR, "#institutions-modify-close-btn").click()
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-modify-close-btn")))
            # yes
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if (msg != "수정을 취소하시겠습니까?" or 
                no_msg != "Institutions Modify" or
                driver.find_element(By.CSS_SELECTOR, "#institutions-tab-name").text != "Institution List"):
                testResult = False
                Reulst_msg += "#12 "

        # Institution_Modify결과 전송 ##
        print("ITR-86: Configuration > Institution > Delete")
        if testResult == False:
            testlink.reportTCResult(2072, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2072, testPlanID, buildName, 'p', "Institution_Modify Test Passed")

#GroupCode_Test
#ReportCode_Test
# Add > GroupAdd > GroupModify > Modify > Delete
class StandardReport:
    def GroupAdd():
        print("ITR-89: Configuration > Standard Report > Group Add")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()
        time.sleep(1)

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # StandardReport
        driver.find_element(By.CSS_SELECTOR, "#standard-report-btn").click()
        driver.wait_for_request('.*/StandardReport.*')
        time.sleep(0.5)
        
        # None Select Group Add #1
        if driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn.disabled").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        # Find & Select
        check = False
        while(1):
            request = driver.wait_for_request('.*/GetStandardReportList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["ReportCode"] == "ReportCode_Test":
                    check = True
                    num = data.index(n) + 1
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[1]/label").click()
                    break

            if check == True:
                break

            del driver.requests
            time.sleep(0.1)
            try:
                driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()
            except:
                break

        # Group Add
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn")))
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-group-add-close-btn")))
        
        # Input Group Code Save #2
        # input group code save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-group-code").send_keys("GroupCode_Test_re")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        # no
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        try:
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn")))
        except:
            testResult = False
            Result_msg += "#2 "
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-group-add-close-btn")))
        # input group code save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-group-code").send_keys("GroupCode_Test_re")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))

        del driver.requests
        time.sleep(1)

        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.5)
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "등록하였습니다.":
            testResult = False
            Result_msg += "#2 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        driver.wait_for_request('.*/StandardReport.*')

        # recovery
        # Find & Select
        check = False
        while(1):
            request = driver.wait_for_request('.*/GetStandardReportList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["ReportCode"] == "ReportCode_Test":
                    check = True
                    num = data.index(n) + 1
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[1]/label").click()
                    break

            if check == True:
                break

            del driver.requests
            time.sleep(1)
            try:
                driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()
            except:
                break
        # Group Add
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn")))
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-group-add-close-btn")))
        # input group code save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-group-code").send_keys("GroupCode_Test")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        del driver.requests
        time.sleep(1)
        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.5)
        if driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "등록하였습니다.":
            testResult = False
            Result_msg += "#2 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        driver.wait_for_request('.*/StandardReport.*')
        time.sleep(0.5)

        # Click & Group Add
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn")))
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-group-add-close-btn")))

        # Close #3
        # close
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-close-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-group-add-close-btn")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[5]/div/div/div[1]/h3").get_property("textContent")
        # close
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-add-close-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        # yes
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn.group-add-btn")))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent")
        if (msg != "등록을 취소하시겠습니까?" or
            no_msg != "Standard Report Group Registration" or
            yes_msg != "Standard Report List"):
            testResult = False
            Result_msg += "#3 "

        # StandardReport_GroupAdd결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2091, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2091, testPlanID, buildName, 'p', "StandardReport_GroupAdd Test Passed")

    def Add():
        print("ITR-90: Configuration > Standard Report > Add")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # StandardReport
        driver.find_element(By.CSS_SELECTOR, "#standard-report-btn").click()
        driver.wait_for_request('.*/StandardReport.*')
        time.sleep(0.5)

        del driver.requests

        # Add #1
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a:nth-child(2) > span").click()
        driver.wait_for_request('.*/GetStandardReportCreatorID')
        if driver.find_element(By.CSS_SELECTOR, "#standard-report-add-creator").get_property("value") != adminID:
            testResult = False
            Result_msg += "#1 "

        # Group Code, Modality, Report Code, Description, Hot Key, Report, Conclusion #2 3 5 6 7 8 9
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-group-code").send_keys("GroupCode_Test")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-auto-expand").send_keys("CT")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-auto-expand"), "CT"))
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-report-code").send_keys("ReportCode_Test")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-report-code"), "ReportCode_Test"))
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-desc").send_keys("Description_Test")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-desc"), "Description_Test"))
        driver.find_element(By.CSS_SELECTOR, "#standard_report_add_hotkey_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#standard_report_add_hotkey_chosen > div > ul > li:nth-child(37)").click()
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-report").send_keys("Report_Test123!@#")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-conclusion").send_keys("Conclusion123!@#")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-conclusion"), "Conclusion123!@#"))
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"),"Yes"))
        msg = driver.find_element(By.XPATH, "/html/body/div[14]/h2").text
        # no
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-report-code"), "ReportCode_Test"))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#addStandartReportLabel").get_property("textContent")
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"),"Yes"))
        del driver.requests
        time.sleep(1)

        ## yes
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"), "OK"))
        ok_msg = driver.find_element(By.XPATH, "/html/body/div[14]/h2").get_property("textContent")
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()

        check = False
        while(1):
            request = driver.wait_for_request('.*/GetStandardReportList.*')
            time.sleep(0.5)
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["ReportCode"] == "ReportCode_Test":
                    check = True
                    num = data.index(n) + 1
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[4]/a").click()
                    try:
                        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-desc"), "Description_Test"))
                        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#standard_report_modify_hotkey_chosen > a > span"), "Z"))
                        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-report"), "Report_Test123!@#"))
                        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-conclusion"), "Conclusion123!@#"))
                    except:
                        testResult = False
                        Result_msg += "#6 #7 #8 #9 "
                    driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-close-btn").click()
                    driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-close-btn").send_keys(Keys.ENTER)
                    WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.visible.showSweetAlert > div.sa-button-container > div > button"), "Yes"))
                    driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.visible.showSweetAlert > div.sa-button-container > div > button").click()
                    WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[4]/a")))
                    break

            if check == True:
                break

            del driver.requests
            time.sleep(1)
            try:
                driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()
            except:
                break

        if (no_msg != "Standard Report Registration" or 
            msg != "등록하시겠습니까?" or 
            ok_msg != "등록하였습니다." or 
            check == False):
            testResult = False
            Result_msg += "#2 #5 "
        

        del driver.requests
        time.sleep(0.25)
        # Add
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a:nth-child(2) > span").click()
        driver.wait_for_request('.*/GetStandardReportCreatorID')
        time.sleep(0.5)

        # Alreay Report Code #4
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-report-code").send_keys("ReportCode_Test")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-report-code"), "ReportCode_Test"))
        # save
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-add-save-btn")))
        element = driver.find_element(By.CSS_SELECTOR, "#standard-report-add-save-btn")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"),"Yes"))
        msg = driver.find_element(By.XPATH, "/html/body/div[14]/h2").text
        # no
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-report-code"), "ReportCode_Test"))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#addStandartReportLabel").get_property("textContent")
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"),"Yes"))
        # yes
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"), "OK"))
        yes_msg = driver.find_element(By.XPATH, "/html/body/div[14]/h2").get_property("textContent")
        # ok
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        result_msg = driver.find_element(By.CSS_SELECTOR, "#addStandartReportLabel").get_property("textContent")

        if (msg != "등록하시겠습니까?" or 
            no_msg != "Standard Report Registration" or 
            yes_msg != "등록을 실패하였습니다." or 
            result_msg != "Standard Report Registration"):
            testResult = False
            Result_msg += "#4 "

        # Close #10
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-close-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.visible.showSweetAlert > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-creator"), adminID))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#addStandartReportLabel").get_property("textContent")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-close-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.visible.showSweetAlert > div.sa-button-container > div > button"), "Yes"))
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr[1]/td[4]/a")))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent")
        if (msg != "등록을 취소하시겠습니까?" or 
            no_msg != "Standard Report Registration" or 
            yes_msg != "Standard Report List"):
            testResult = False
            Result_msg += "#10 "

        # StandardReport_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2096, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2096, testPlanID, buildName, 'p', "StandardReport_Add Test Passed")

    def Delete():
        print("ITR-91: Configuration > Standard Report > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # StandardReport
        driver.find_element(By.CSS_SELECTOR, "#standard-report-btn").click()
        driver.wait_for_request('.*/StandardReport.*')
        time.sleep(0.5)

        # Non-Select Delete #1
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/div[1]/a[3]").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#1 "

        # Select Delete #2
        # Find & Select
        check = False
        check2 = False
        while(1):
            request = driver.wait_for_request('.*/GetStandardReportList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["ReportCode"] == "ReportCode_Test":
                    check = True
                    num = data.index(n) + 1
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[1]/label").click()
                if n["ReportCode"] == "ReportCode_Test3":
                    check2 = True
                    num2 = data.index(n) + 1
                    driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num2)+"]/td[1]/label").click()
                    break
            if check == True and check2 == True:
                break

            del driver.requests
            time.sleep(0.1)
            try:
                driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()
            except:
                break
        # Delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/div[1]/a[3]").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn")))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent")
        # Delete
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/div[1]/a[3]").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        del driver.requests
        time.sleep(1)
        # yes
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a:nth-child(2)")))

        # 패킷으로 지움확인
        check = False
        request = driver.wait_for_request('.*/GetStandardReportList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        for a in range(1, total+1):
            request = driver.wait_for_request('.*/GetStandardReportList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if n["ReportCode"] == "ReportCode_Test":
                    check = True
                    break

            if check == True:
                break
            
            del driver.requests
            time.sleep(1)

            if a+1 == total:
                break
            driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()

        if (msg != "삭제하시겠습니까?" or 
            no_msg != "Standard Report List" or 
            yes_msg != "삭제하였습니다." or 
            check == True):
            testResult= False
            Result_msg += "#2 "

        # StandardReport
        driver.find_element(By.CSS_SELECTOR, "#standard-report-btn").click()
        request = driver.wait_for_request('.*/GetStandardReportList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        
        # Select & Other Tab #3
        if total < 2:
            testResult = False
            Result_msg += "#3 "
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()
        del driver.requests
        time.sleep(0.1)
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()
        driver.wait_for_request('.*/StandardReport.*')
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/div[1]/a[3]").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#3 "

        # Select at >= 2 & Other Tab #4
        if total < 3:
            testResult = False
            Result_msg += "#4 "
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr[1]/td[1]/label").click()
        del driver.requests
        time.sleep(0.1)
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()
        driver.wait_for_request('.*/StandardReport.*')
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/div[1]/a[3]").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#4 "

        # StandardReport_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2108, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2108, testPlanID, buildName, 'p', "StandardReport_Delete Test Passed")

    # ReportCode_Test Search
    def ReportSearch(total):
        print("ITR-92: Configuration > Standard Report > Group Modify")
        num = 0
        for a in range(1, total+1):
            request = driver.wait_for_request('.*/GetStandardReportList.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for n in data:
                if "ReportCode_Test" in n["ReportCode"]:
                    num = data.index(n) + 1
                    break

            if num != 0:
                break
            
            del driver.requests
            time.sleep(1)

            if a == total:
                break
            driver.find_element(By.CSS_SELECTOR, "#standard-report-list_next > a").click()

        return num


    def GroupModify():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        del driver.requests
        time.sleep(1)

        # StandardReport
        driver.find_element(By.CSS_SELECTOR, "#standard-report-btn").click()
        request = driver.wait_for_request('.*/GetStandardReportList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)

        # ReportCode_Test Search
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        num = StandardReport.ReportSearch(total)

        # Group Code Click #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[3]/a").click()
        try:
            WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[6]/div/div/div[1]/h3"), "Standard Report Group Modify"))
        except:
            testResult = False
            Result_msg += "#1 "

        # Group Code Change #2
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-btn")))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent")
        # Group Code Click
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[3]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[6]/div/div/div[1]/h3"), "Standard Report Group Modify"))
        # input
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-group-code").send_keys("_re")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-group-modify-group-code"), "GroupCode_Test_re"))
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))

        del driver.requests
        time.sleep(1)

        # yes
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-btn")))

        # ReportCode_Test Search
        num = StandardReport.ReportSearch(total)

        if (msg != "기존 Standard Report Group Code로 수정하시겠습니까?" or 
            no_msg != "Standard Report List" or 
            yes_msg != "수정하였습니다." or 
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[3]/a").get_property('textContent') != "GroupCode_Test_re"):
            testResult = False
            Result_msg += "#2 "

        # additional report for total check
        driver.find_element(By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a:nth-child(2) > span").click()
        driver.wait_for_request('.*/GetStandardReportCreatorID')
        # input
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-group-code").send_keys("GroupCode_Test_re")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-report-code").send_keys("ReportCode_Test2")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-add-report-code"), "ReportCode_Test"))
        # save
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#standard-report-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"),"Yes"))
        del driver.requests
        time.sleep(1)
        ## yes
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"), "OK"))
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()

        request = driver.wait_for_request('.*/GetStandardReportList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)

        # ReportCode_Test Search
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        num = StandardReport.ReportSearch(total)

        # Total Check #3
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[3]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[6]/div/div/div[1]/h3"), "Standard Report Group Modify"))
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-popup-modal > div > div > div.modal-body > div:nth-child(2) > div > div > label").click()
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-btn")))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent")
        # Group Code Click
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[3]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[6]/div/div/div[1]/h3"), "Standard Report Group Modify"))
        # input
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-group-code").send_keys("_total")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-popup-modal > div > div > div.modal-body > div:nth-child(2) > div > div > label").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-group-modify-group-code"), "GroupCode_Test_re"))
        # save
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))

        del driver.requests
        time.sleep(1)

        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-btn")))

        # ReportCode_Test Search
        num = StandardReport.ReportSearch(total)
        if (msg != "기존 Standard Report Group Code로 모두 수정하시겠습니까?" or 
            no_msg != "Standard Report List" or 
            yes_msg != "수정하였습니다." or 
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[3]/a").get_property('textContent') != "GroupCode_Test_re_total" or
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num+1)+"]/td[3]/a").get_property('textContent') != "GroupCode_Test_re_total"):
            testResult = False
            Result_msg += "#3 "

        # Close #4
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num)+"]/td[3]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#standard-report-group-modify-close-btn"), "Close"))
        # close
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-close-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[6]/div/div/div[1]/h3")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[6]/div/div/div[1]/h3").get_property("textContent")
        # close
        driver.find_element(By.CSS_SELECTOR, "#standard-report-group-modify-close-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        # yes
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-btn")))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent")
        if (msg != "수정을 취소하시겠습니까?" or 
            no_msg != "Standard Report Group Modify" or 
            yes_msg != "Standard Report List"):
            testResult = False
            Result_msg += "#4 "

        # StandardReport_GroupModify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2114, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2114, testPlanID, buildName, 'p', "StandardReport_GroupModify Test Passed")

    def Modify():
        print("ITR-93: Configuration > Standard Report > Modify")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # StandardReport
        driver.find_element(By.CSS_SELECTOR, "#standard-report-btn").click()
        request = driver.wait_for_request('.*/GetStandardReportList.*')
        time.sleep(0.5)
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        
        num = StandardReport.ReportSearch(total)

        # Report Code Click #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num+1)+"]/td[4]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-creator"), adminID))
        if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[4]/div/div/div[1]/h3").get_property("textContent") != "Standard Report Modify":
            testResult = False
            Result_msg += "#1 "

        # Group Code, Description, Hot Key, Report, Conclusion #2 6 7 8 9
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-group-code").send_keys("_re")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-desc").send_keys("Description_Test")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-desc"), "Description_Test"))
        driver.find_element(By.CSS_SELECTOR, "#standard_report_modify_hotkey_chosen").click()
        driver.find_element(By.CSS_SELECTOR, "#standard_report_modify_hotkey_chosen > div > ul > li:nth-child(37)").click()
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-report").send_keys("Report_Test123!@#")
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-conclusion").send_keys("Conclusion123!@#")
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-conclusion"), "Conclusion123!@#"))
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-creator"), adminID))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[4]/div/div/div[1]/h3").get_property("textContent")
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        # yes
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        ok_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a:nth-child(2)")))

        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num+1)+"]/td[4]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-creator"), adminID))
        if (msg != "수정하시겠습니까?" or 
            no_msg != "Standard Report Modify" or 
            ok_msg != "수정하였습니다." or 
            driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-group-code").get_property("value") != "GroupCode_Test_re_total_re"):
            testResult = False
            Result_msg += "#2 "
        if driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-desc").get_property("value") != "Description_Test":
            testResult = False
            Result_msg += "#6 "
        if driver.find_element(By.CSS_SELECTOR, "#standard_report_modify_hotkey_chosen > a > span").get_property("textContent") != "Z":
            testResult = False
            Result_msg += "#7 "
        if driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-report").get_property("value") != "Report_Test123!@#":
            testResult = False
            Result_msg += "#8 "
        if driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-conclusion").get_property("value") != "Conclusion123!@#":
            testResult = False
            Result_msg += "#9 "

        # alreay Report Code #4
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-report-code").clear()
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-report-code").send_keys("ReportCode_Test")
        # save
        element = driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-save-btn")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-creator"), adminID))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[4]/div/div/div[1]/h3").get_property("textContent")
        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        # yes
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # ok
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-modify-save-btn")))
        if (msg != "수정하시겠습니까?" or 
            no_msg != "Standard Report Modify" or 
            yes_msg != "수정을 실패하였습니다." or 
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[4]/div/div/div[1]/h3").get_property("textContent") != "Standard Report Modify"):
            testResult = False
            Result_msg += "#4 "

        time.sleep(0.5)
        # new #5
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-report-code").send_keys("3")
        # save
        element = driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-save-btn")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-creator"), adminID))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[4]/div/div/div[1]/h3").get_property("textContent")

        del driver.requests
        time.sleep(1)

        # save
        driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a:nth-child(2)")))
        if (msg != "수정하시겠습니까?" or 
            no_msg != "Standard Report Modify" or 
            yes_msg != "수정하였습니다." or 
            driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent") != "Standard Report List"):
            testResult = False
            Result_msg += "#5 "

        request = driver.wait_for_request('.*/GetStandardReportList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        
        num = StandardReport.ReportSearch(total)
        
        # Close #10
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[2]/div/table/tbody/tr["+str(num+1)+"]/td[4]/a").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#standard-report-modify-creator"), adminID))
        # close
        element = driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-close-btn")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(0.5)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-modify-close-btn")))
        no_msg = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[5]/div[4]/div/div/div[1]/h3").get_property("textContent")
        # close
        time.sleep(0.5)
        element = driver.find_element(By.CSS_SELECTOR, "#standard-report-modify-close-btn")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "Yes"))
        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#standard-report-list_wrapper > div.dt-buttons > a:nth-child(2)")))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#standard-report-tab-name").get_property("textContent")
        if (msg != "수정을 취소하시겠습니까?" or 
            no_msg != "Standard Report Modify" or 
            yes_msg != "Standard Report List"):
            testResult = False
            Result_msg += "#10 "

        # StandardReport_Modify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2120, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2120, testPlanID, buildName, 'p', "StandardReport_Modify Test Passed")
    
    def All():
        StandardReport.Add()
        StandardReport.GroupAdd()
        StandardReport.GroupModify()
        StandardReport.Modify()
        StandardReport.Delete()

class MultiReadingCenterRule:
    def SearchFilter():
        print("ITR-94: Configuration > Multi Reading Center Rule > Search Filter")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

        # Institution
        driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[2]/a")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[2]/a").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-modify-close-btn")))
        insti_name = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-institution-name").get_property("value")
        center_name = []
        num = 0
        while(1):
            try:
                num += 1
                center_name.append(driver.find_element(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > ul > li:nth-child("+str(num)+") > span").text)
            except:
                if num == 1:
                    center_name.append("")
                break
        element = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-close-btn")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        # MultiReadingCenterRule
        driver.find_element(By.CSS_SELECTOR, "#multiReadingCenterRule-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > a > span")))

        # Institution > Center #1
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[1]/div[2]/div/div[1]/div/a/span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > div > div > input[type=text]").send_keys(insti_name)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(0.25)
        try:
            center_name.index(driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > a > span").get_property("textContent"))
        except:
            testResult = False
            Result_msg += "#1 "
        
        # Institution & Center Search #2
        del driver.requests
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-search").click()
        request = driver.wait_for_request('.*/GetMultiReadingCenterRuleList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        for n in range (1, len(data)+1):
            if (driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr["+str(n)+"]/td[2]/a").text != insti_name or
                driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr["+str(n)+"]/td[3]").text not in center_name):
                testResult = False
                Result_msg += "#2 "

        # Request Code #4
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_requestcode_chosen > ul > li > input[type=text]").click()
        try:
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_search_requestcode_chosen > div > ul > li:nth-child(1)")))
        except:
            testResult = False
            Result_msg += "#4 "

        # Request Code Delete #5
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_requestcode_chosen > div > ul > li:nth-child(1)").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_search_requestcode_chosen > ul > li.search-choice > a")))
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_requestcode_chosen > ul > li.search-choice > a").click()
        try:
            driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_requestcode_chosen > ul > li.search-choice > span")
            testResult = False
            Result_msg += "#5 "
        except:
            pass

        # MultiReadingCenterRule
        driver.find_element(By.CSS_SELECTOR, "#multiReadingCenterRule-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > a > span")))

        # Modality Search #3
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > a > span").click()
        modal = driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > div > ul > li:nth-child(3)").text.split(' ')[0]
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > div > ul > li:nth-child(3)").click()
        del driver.requests
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-search").click()
        request = driver.wait_for_request('.*/GetMultiReadingCenterRuleList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        time.sleep(1)
        for n in range (1, len(data)+1):
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr["+str(n)+"]/td[4]").get_property("textContent") != modal:
                testResult = False
                Result_msg += "#3 "
                break

        # MultiReadingCenterRule_SearchFilter결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2133, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2133, testPlanID, buildName, 'p', "MultiReadingCenterRule_SearchFilter Test Passed")

    def Add():
        print("ITR-95: Configuration > Multi Reading Center Rule > Add")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)

         # Institution
        driver.find_element(By.CSS_SELECTOR, "#institutions-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[2]/a")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[4]/div[2]/div/table/tbody/tr[1]/td[2]/a").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#institutions-modify-close-btn")))
        insti_name = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-institution-name").get_property("value")
        center_name = []
        num = 0
        while(1):
            try:
                num += 1
                center_name.append(driver.find_element(By.CSS_SELECTOR, "#institutions_modify_center_code_list_chosen > ul > li:nth-child("+str(num)+") > span").text)
            except:
                if num == 1:
                    center_name.append("")
                break
        element = driver.find_element(By.CSS_SELECTOR, "#institutions-modify-close-btn")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        
        # MultiReadingCenterRule
        driver.find_element(By.CSS_SELECTOR, "#multiReadingCenterRule-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > a > span")))

        # Institution Select #1
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-add-close-btn")))
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys(insti_name)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(0.25)
        if (driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").text not in center_name or 
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").value_of_css_property("cursor") != "not-allowed"):
            testResult = False
            Result_msg += "#1 "

        # Center Right #2
        select_center = driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").text
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-center-remove-btn")))
        if (driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_add_center_chosen > a > span").text != select_center or 
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").value_of_css_property("cursor") != "not-allowed"):
            testResult = False
            Result_msg += "#2 "

        # Center Left #3
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-remove-btn").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(select_center)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        if driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").text != select_center:
            testResult = False
            Result_msg += "#3 "

        # Center Right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-remove-btn").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(select_center)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-center-remove-btn")))

        # Modality Right #4
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > ul > li:nth-child(2)").click()
        select_modal = driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").text
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        if (driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_add_modality_chosen > a > span").text != select_modal or
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").value_of_css_property("cursor") == "not-allowed"):
            testResult = False
            Result_msg += "#4 "

        # Modality Left #5
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn").click()
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(select_modal.split(' - ')[0])
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        if (driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").text != select_modal or
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").value_of_css_property("cursor") != "not-allowed"):
            testResult = False
            Result_msg += "#5 "

        # Modality Right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))

        # Request Code #6
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_request_code_chosen > ul > li > input").click()
        request_name = driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_request_code_chosen > div > ul > li:nth-child(1)").text
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_request_code_chosen > div > ul > li:nth-child(1)").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_add_request_code_chosen > ul > li.search-choice > a")))
        if driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_request_code_chosen > ul > li.search-choice > span").text != request_name:
            testResult = False
            Result_msg += "#6 "

        # Request Code Delete #7
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_request_code_chosen > ul > li.search-choice > a").click()
        try:
            driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_request_code_chosen > ul > li.search-choice > span")
            testResult = False
            Result_msg += "#7 "
        except:
            pass

        # Institution Change #8
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > a > span").click()
        num = 0
        while(1):
            num+=1
            if driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > ul > li:nth-child("+str(num)+")").text != insti_name:
                driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > ul > li:nth-child("+str(num)+")").click()
                break
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-center-add-btn")))
        if (driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_add_center_chosen > a > span").text == select_center or 
            driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_add_modality_chosen > a > span").text == select_modal):
            testResult = False
            Result_msg += "#8 "

        # Center Delete #9
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-center-remove-btn")))
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(select_modal.split(' - ')[0])
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        # center left
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-remove-btn").click()
        time.sleep(0.25)
        if (driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").value_of_css_property("cursor") != "not-allowed" or 
            driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_add_modality_chosen > a > span").text == select_modal):
            testResult = False
            Result_msg += "#9 "

        # Modality Delete #10
        # Set
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys(insti_name)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(select_center)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-center-remove-btn")))
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(select_modal.split(' - ')[0])
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        # modality left
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn").click()
        time.sleep(0.25)
        if driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").value_of_css_property("cursor") != "not-allowed":
            testResult = False
            Result_msg += "#10 "
            
        # Close #12
        # close
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-close-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button")))
        # no
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        try:
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-add-close-btn")))
        except:
            testResult = False
            Result_msg += "#12 "
        # close
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-close-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button")))
        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        try:
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        except:
            testResult = False
            Result_msg += "#12 "

        # Save #11
        # Add
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > a > span")))
        # institution
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys("INFINITT_TEST")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Center
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys("TEST_CENTER")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Center right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        # Modality
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys("AU")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Modality right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        # save
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button")))
        # no
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        try:
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        except:
            testResult = False
            Result_msg += "#11 "

        # Add
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > a > span")))
        # institution
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_institution_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Center
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(search_center)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Center right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        # Modality
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys("AS")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Modality right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        # Modality
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys("AU")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Modality right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        # Center
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(search_center_2)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Center right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        # Modality
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys("AS")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Modality right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        # Modality
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys("AU")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_add_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        # Modality right
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modality-remove-btn")))
        # save
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button")))
        # yes
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        try:
            time.sleep(0.25)
            driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/div/button").click()
        except:
            testResult = False
            Result_msg += "#11 "
 
        # MultiReadingCenterRule_Add결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2140, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2140, testPlanID, buildName, 'p', "MultiReadingCenterRule_Add Test Passed")

    def Delete():
        print("ITR-96: Configuration > Multi Reading Center Rule > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        time.sleep(0.15)

        # MultiReadingCenterRule
        driver.find_element(By.CSS_SELECTOR, "#multiReadingCenterRule-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > a > span")))

        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > div > div > input[type=text]").send_keys(search_center_2)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)

        time.sleep(0.1)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-search").click()
        time.sleep(0.1)

        # No
        try:
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr/td[1]/label").click()
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        except:
            testResult = False
            Result_msg += "#1 "
        # yes
        try:
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.delete-btn").click()
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.1)
            assert(driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text == "삭제하였습니다.")
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        except:
            testResul = False
            Result_msg += "#1 "

        # MultiReadingCenterRule_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2154, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2154, testPlanID, buildName, 'p', "MultiReadingCenterRule_Delete Test Passed")

    def Modify():
        print("ITR-97: Configuration > Multi Reading Center Rule > Modify")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Configuration
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        driver.implicitly_wait(5)
        time.sleep(0.3)

        # MultiReadingCenterRule
        driver.find_element(By.CSS_SELECTOR, "#multiReadingCenterRule-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi_center_rule_search_modality_chosen > a > span")))

        del driver.requests
        time.sleep(0.1)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > div > div > input[type=text]").send_keys(search_institution_2)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_institutioncode_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > div > div > input[type=text]").send_keys(search_center_2)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)                    
        time.sleep(0.1)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-search").click()
        time.sleep(0.1)

        request = driver.wait_for_request('.*/GetMultiReadingCenterRuleList.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        selected_center = []
        for n in data:
            if n["CenterName"] not in selected_center:
                selected_center.append(n["CenterName"])
        selected_modal = []
        temp = []
        num = 0
        for n in range (0, len(data)):
            if data[n]["CenterName"] != selected_center[num]:
                selected_modal.append(temp)
                num += 1
                temp = []
            if data[n]["Modality"] not in temp:
                temp.append(data[n]["Modality"])
            if n+1 == len(data):
                selected_modal.append(temp)


        # instituion name click #1
        insti_name = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr[1]/td[2]/a").text
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr[1]/td[2]/a").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modify-close-btn")))
        if (driver.find_element(By.CSS_SELECTOR, "#modifyCenterRuleLabel").text != "Multi Reading Center Rule Modify" or 
            driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_institution_chosen > a > span").text != insti_name):
            testResult = False
            Result_msg += "#1 "

        # Selected Center, Selected Center Change(Modality) #2 3
        a_num = 0
        while(1):
            a_num += 1
            driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_modify_center_chosen > a").click()
            try:
                element = driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_modify_center_chosen > div > ul > li:nth-child("+str(a_num)+")")
                cur_center = element.text
            except:
                if len(selected_center) != 0:
                    testResult = False
                    Result_msg += "#2 "
                break

            if cur_center in selected_center:
                target = selected_center.index(cur_center)
                element.click()
                
                b_num = 0
                temp = []
                driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_modify_modality_chosen > a > span").click()
                while(1):
                    try:
                        b_num += 1
                        temp.append(driver.find_element(By.CSS_SELECTOR, "#selected_multi_center_rule_modify_modality_chosen > div > ul > li:nth-child("+str(b_num)+")").text.split('-')[0])
                    except:
                        break
                if temp != selected_modal[target]:
                    testResult = False
                    Result_msg += "#3 "

                selected_center.remove(cur_center)
                del selected_modal[target]
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-close-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)

        # Institution name click
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr[1]/td[2]/a").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modify-close-btn")))

        # Modality Left Save #6 7
        # left
        driver.find_element(By.CSS_SELECTOR, "#modify-multi-center-rule-modality-remove-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modify-save-btn")))
        # != not-allowed
        one_remain = driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-save-btn").value_of_css_property("cursor")
        # save
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # no
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#modifyCenterRuleLabel")))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#modifyCenterRuleLabel").get_property("textContent")
        # left
        driver.find_element(By.CSS_SELECTOR, "#modify-multi-center-rule-modality-remove-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-modify-save-btn")))
        # save
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        # yes
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.15)
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        # institution name click
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr[1]/td[2]/a")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr[1]/td[2]/a").click()
        WebDriverWait(driver, 3).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#modifyCenterRuleLabel")))
        # modality check
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_modality_chosen > div > div > input[type=text]").send_keys("AS")
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)

        if (msg != "수정하시겠습니까?" or
            no_msg != "Multi Reading Center Rule Modify" or
            yes_msg != "수정하였습니다." or 
            driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_modality_chosen > a > span").text != "AS - Angioscopy"):
            testResult = False
            Result_msg += "#6 "

        # left
        driver.find_element(By.CSS_SELECTOR, "#modify-multi-center-rule-modality-remove-btn").click()
        if (one_remain == "not-allowed" or
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-save-btn").value_of_css_property("cursor") != "not-allowed"):
            testResult = False
            REesult_msg += "#7 "

        # Modal Right
        driver.find_element(By.CSS_SELECTOR, "#modify-multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#modify-multi-center-rule-modality-remove-btn")))
        # Center Right
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#modify-multi-center-rule-center-add-btn").click()
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#modify-multi-center-rule-center-remove-btn")))

        # Center Left Save #4 5
        # left
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[4]/div/div/div[2]/div[2]/div/div/div[2]/button[2]").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[4]/div/div/div[3]/button[2]")))
        # != not-allowed
        one_remain = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[4]/div/div/div[3]/button[2]").value_of_css_property("cursor")
        # save
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[4]/div/div/div[3]/button[2]").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/button"),"No"))
        msg = driver.find_element(By.XPATH, "/html/body/div[14]/h2").text
        # no
        time.sleep(1)
        driver.find_element(By.XPATH, "/html/body/div[14]/div[7]/button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#selected_multi_center_rule_modify_center_chosen > a > span"),search_center))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#modifyCenterRuleLabel").get_property("textContent")
        # change to on save
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_modality_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_modality_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#modify-multi-center-rule-modality-add-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#modify-multi-center-rule-modality-remove-btn")))
        # save
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[4]/div/div/div[3]/button[2]").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/button"),"No"))
        # yes
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.XPATH, "/html/body/div[14]/div[7]/div/button"),"OK"))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        # ok
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-search")))

        del driver.requests
        time.sleep(1)

        # search
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > div > div > input[type=text]").send_keys(search_center_2)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_search_centercode_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-search").click()

        driver.wait_for_request('.*/GetMultiReadingCenterRuleList.*')

        # institution name click
        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr[1]/td[2]/a")))
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[11]/div[2]/div/table/tbody/tr[1]/td[2]/a").click()
        WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#modifyCenterRuleLabel")))
        # modality check
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_center_chosen > a > span").click()
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_center_chosen > div > div > input[type=text]").send_keys(search_center)
        driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)

        if (msg != "수정하시겠습니까?" or
            no_msg != "Multi Reading Center Rule Modify" or
            yes_msg != "수정하였습니다." or 
            driver.find_element(By.CSS_SELECTOR, "#multi_center_rule_modify_center_chosen > a > span").text != search_center_2):
            testResult = False
            Result_msg += "#4 "

        # left
        driver.find_element(By.CSS_SELECTOR, "#modify-multi-center-rule-center-remove-btn").click()
        if (one_remain == "not-allowed" or
            driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-save-btn").value_of_css_property("cursor") != "not-allowed"):
            testResult = False
            Result_msg += "#5 "

        ## Change Save #8 #보류

        # Close #9
        # close
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-close-btn").click()
        WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#modifyCenterRuleLabel")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").get_property("textContent")
        # no
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "#selected_multi_center_rule_modify_center_chosen > a > span"), search_center_2))
        no_msg = driver.find_element(By.CSS_SELECTOR, "#modifyCenterRuleLabel").get_property("textContent")
        # close
        driver.find_element(By.CSS_SELECTOR, "#multi-center-rule-modify-close-btn").click()
        WebDriverWait(driver, 3).until(EC.visibility_of_element_located((By.CSS_SELECTOR, "#modifyCenterRuleLabel")))
        # yes
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#multi-center-rule-search")))
        yes_msg = driver.find_element(By.CSS_SELECTOR, "#multi-reading-center-rule-tab-name").get_property("textContent")
        if (msg != "수정을 취소하시겠습니까?" or 
            no_msg != "Multi Reading Center Rule Modify" or 
            yes_msg != "Multi Reading Center Rule"):
            testResult = False
            Result_msg += "#9 "
        
        # MultiReadingCenterRule_Modify결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2157, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2157, testPlanID, buildName, 'p', "MultiReadingCenterRule_Modify Test Passed")

    def All():
        MultiReadingCenterRule.Add()
        MultiReadingCenterRule.Modify()
        MultiReadingCenterRule.Delete()

class Auditlog:
    def Auditlog_Search():
        print("ITR-98: Audit Log > Search")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Get Job Key & Insti Name
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[4]/div[1]/div/div[1]").click()
        WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)")))
        job_key = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)").get_property("textContent")
        insti_name = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[4]/div[1]/div/div[1]").get_attribute("data-institution-name")

        # Auditlog
        driver.find_element(By.CSS_SELECTOR, "#tab-auditlog > a").click()
        driver.implicitly_wait(5)

        # Search #1
        del driver.requests
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search_job_key_field").send_keys(job_key)
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search").click()
        request = driver.wait_for_request('.*/SearchAuditLog.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]
        board_date = datetime.strptime(driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child(1) > td.align-center\,.auditlog-table-data.sorting_1").text, '%Y-%m-%d %H:%M:%S')
        for n in range(1, len(data)+1):
            date_temp = datetime.strptime(driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td.align-center\,.auditlog-table-data.sorting_1").text, '%Y-%m-%d %H:%M:%S')
            sub = str(board_date - date_temp)
            board_date = date_temp
            if (driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(2)").text != insti_name or 
                '-' in sub):
                testResult = False
                Result_msg += "#1 "
                break

        # Auditlog_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2169, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2169, testPlanID, buildName, 'p', "Auditlog_Search Test Passed")

    def Auditlog_Export():
        print("ITR-99: Audit Log > Export")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Get Job Key & Insti Name
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[4]/div[1]/div/div[1]").click()
        WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)")))
        job_key = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)").get_property("textContent")

        # Auditlog
        driver.find_element(By.CSS_SELECTOR, "#tab-auditlog > a").click()
        driver.implicitly_wait(5)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search_job_key_field").send_keys(job_key)
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#auditlog_export")))

        # Export #1
        driver.find_element(By.CSS_SELECTOR, "#auditlog_export").click()
        try:
            driver.wait_for_request(".*/GetExportData")
        except:
            testResult = False
            Result_msg += "#1 "

        # Auditlog_Export결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2172, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2172, testPlanID, buildName, 'p', "Auditlog_Export Test Passed")

    def Auditlog_Showentries_fun(entries, num):
        print("ITR-100: Audit Log > Show Entries")
        Result_msg = ""

        del driver.requests
        time.sleep(0.25)
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table_length > label > select > option:nth-child("+str(num)+")").click()
        request = driver.wait_for_request('.*/SearchAuditLog.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        if data["Length"] != entries:
            Result_msg += "#"+str(num)+" "
        if data["recordsFiltered"] > entries:
            try:
                WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#auditlog_search_table_next > a")))
            except:
                Result_msg += "#"+str(num)+" "

        return Result_msg

    def Auditlog_Showentries():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Get Job Key & Insti Name
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[4]/div[1]/div/div[1]").click()
        WebDriverWait(driver, 3).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)")))
        job_key = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)").get_property("textContent")

        # Auditlog
        driver.find_element(By.CSS_SELECTOR, "#tab-auditlog > a").click()
        driver.implicitly_wait(5)

         # Search
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search_job_key_field").send_keys(job_key)
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#auditlog_export")))



        Result_msg += Auditlog.Auditlog_Showentries_fun(20, 1)
        Result_msg += Auditlog.Auditlog_Showentries_fun(50, 2)
        Result_msg += Auditlog.Auditlog_Showentries_fun(100, 3)

        # Auditlog_Showentries결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2175, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2175, testPlanID, buildName, 'p', "Auditlog_Showentries Test Passed")

    def Auditlog_Sorting():
        print("ITR-101: Audit Log > Sorting")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Get Job Key
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[1]/div[2]/div[4]/div[1]/div/div[1]").click()
        WebDriverWait(driver, 3).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)")))
        job_key = driver.find_element(By.CSS_SELECTOR, "#refer-assigned-list > tbody > tr.odd > td:nth-child(2)").get_property("textContent")

        # Auditlog
        driver.find_element(By.CSS_SELECTOR, "#tab-auditlog > a").click()
        driver.implicitly_wait(5)

        # Search & Date #1
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search_job_key_field").send_keys(job_key)
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search").click()

        del driver.requests
        time.sleep(0.25)
        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/div/div/div[3]/div/div[4]/div[1]/div/table/thead/tr/th[11]").click()
        time.sleep(0.25)
        request = driver.wait_for_request('.*/SearchAuditLog.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        board_date = datetime.strptime(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/div/div/div[3]/div/div[4]/div[2]/table/tbody/tr[1]/td[11]").text, '%Y-%m-%d %H:%M:%S')
        for n in range(1, len(data)+1):
            date_temp = datetime.strptime(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/div/div/div[3]/div/div[4]/div[2]/table/tbody/tr["+str(n)+"]/td[11]").text, '%Y-%m-%d %H:%M:%S')
            sub = str(board_date - date_temp)
            board_date = date_temp
            if '-' not in sub:
               if sub != "0:00:00":
                    testResult = False
                    Result_msg += "#1 "
                    break

        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/div/div/div[3]/div/div[4]/div[1]/div/table/thead/tr/th[11]").click()
        time.sleep(0.25)
        board_date = datetime.strptime(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/div/div/div[3]/div/div[4]/div[2]/table/tbody/tr[1]/td[11]").text, '%Y-%m-%d %H:%M:%S')
        for n in range(1, len(data)+1):
            date_temp = datetime.strptime(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/div/div/div[3]/div/div[4]/div[2]/table/tbody/tr["+str(n)+"]/td[11]").text, '%Y-%m-%d %H:%M:%S')
            sub = str(board_date - date_temp)
            board_date = date_temp
            if '-' in sub:
                testResult = False
                Result_msg += "#1 "
                break

        # Auditlog_Sorting결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2180, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2180, testPlanID, buildName, 'p', "Auditlog_Sorting Test Passed")

    def Auditlog_Data():
        print("ITR-102: Audit Log > Data")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Auditlog
        driver.find_element(By.CSS_SELECTOR, "#tab-auditlog > a").click()
        driver.implicitly_wait(5)

        del driver.requests
        time.sleep(0.25)

        # Search
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search_job_key_field").send_keys("74832064")
        driver.find_element(By.CSS_SELECTOR, "#auditlog_search").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#auditlog_search")))

        request = driver.wait_for_request('.*/SearchAuditLog.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        for n in range(1, len(data)+1):
            # app
            if ("PANDORA" in driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(5)").text or 
                "PANGEA" in driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(5)").text or 
                "ITRWeb" in driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(5)").text or 
                "ITRWorklist" in driver.find_element(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(5)").text):
                testResult = False
                Result_msg += "#1 "
                break
            # id
            if ("PANDORA" in driver.find_elemnet(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(7)").text or 
                "PANGEA" in driver.find_elemnet(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(7)").text or 
                "ITRWeb" in driver.find_elemnet(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(7)").text or 
                "ITRWorklist" in driver.find_elemnet(By.CSS_SELECTOR, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(7)").text):
                testResult = False
                Result_msg += "#1 "
                break
            # name
            if ("PANDORA" in driver.find_element(By.CSS_SELECTORq, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(8)").text or 
                "PANGEA" in driver.find_element(By.CSS_SELECTORq, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(8)").text or 
                "ITRWeb" in driver.find_element(By.CSS_SELECTORq, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(8)").text or 
                "ITRWorklist" in driver.find_element(By.CSS_SELECTORq, "#auditlog_search_table > tbody > tr:nth-child("+str(n)+") > td:nth-child(8)").text):
                testResult = False
                Result_msg += "#1 "
                break

        # Auditlog_Data결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2183, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2183, testPlanID, buildName, 'p', "Auditlog_Data Test Passed")

class Notice:
    def NoticeList_NoticeEditBoard():
        print("ITR-103: Notice > Notice list > Notice Edit Board")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Notice
        driver.find_element(By.CSS_SELECTOR, "#tab-notice > a").click()
        driver.implicitly_wait(5)

        # Notice Title #1
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title3#")
        if driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").get_property("value") != "rnd_title3#":
            testResult = False
            Rersult_msg += "#1 "
        
        # Notice Board #2
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#")
        if driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p").get_property("textContent") != "rnd_board3#":
            testResult = False
            Rersult_msg += "#2 "
        
        # Board Bold #3 4
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys(Keys.CONTROL + "a")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-bold > i").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/b")))
        except:
            testResult = False
            Result_msg += "#3 "
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-bold > i").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/b")))
            testResult = False
            Result_msg += "#4 "
        except:
            pass
        
        # Board Italic #5 6
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-italic").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/i")))
        except:
            testResult = False
            Result_msg += "#5 "
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-italic").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/i")))
            testResult = False
            Result_msg += "#6 "
        except:
            pass
        
        # Board Underline #7 8
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-underline").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/u")))
        except:
            testResult = False
            Result_msg += "#7 "
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-underline").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/u")))
            testResult = False
            Result_msg += "#8 "
        except:
            pass
        
        # Board Strikethrough #9 10
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-strikethrough").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/strike")))
        except:
            testResult = False
            Result_msg += "#9 "
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-strikethrough").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/strike")))
            testResult = False
            Result_msg += "#10 "
        except:
            pass
        
        # Board Remove #11
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button.note-btn.btn.btn-default.btn-sm.note-btn-strikethrough").click()
        WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/strike")))
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button:nth-child(5) > i").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[3]/div[2]/p/strike")))
            testResult = False
            Result_msg += "#11 "
        except:
            pass

        # Board Color #12
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-color > div.note-btn-group.btn-group.note-color.note-color-fore > button.note-btn.btn.btn-default.btn-sm.dropdown-toggle > span").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-color > div.note-btn-group.btn-group.note-color.note-color-fore.open > ul > div > div.note-holder > div > div:nth-child(2) > button:nth-child(1)")))
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-color > div.note-btn-group.btn-group.note-color.note-color-fore.open > ul > div > div.note-holder > div > div:nth-child(2) > button:nth-child(1)").click()
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p > font")))
            assert(driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p > font").value_of_css_property("color") == "rgba(255, 0, 0, 1)")
        except:
            testResult = False
            Result_msg += "#12 "
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button:nth-child(5) > i").click()

        # Board Backgorund color #13
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-color > div.note-btn-group.btn-group.note-color.note-color-all > button.note-btn.btn.btn-default.btn-sm.dropdown-toggle > span").click()
        try:
            WebDriverWait(driver, 0.1).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-color > div.note-btn-group.btn-group.note-color.note-color-all.open > ul > div:nth-child(1) > div.note-holder > div > div:nth-child(2) > button:nth-child(1)")))
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-color > div.note-btn-group.btn-group.note-color.note-color-all.open > ul > div:nth-child(1) > div.note-holder > div > div:nth-child(2) > button:nth-child(1)").click()
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p > span")))
            assert(driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p > span").value_of_css_property("background-color") == "rgba(255, 0, 0, 1)")
        except:
            testResult = False
            Result_msg += "#13 "
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-style > button:nth-child(5) > i").click()

        # Picture select #14
        driver.find_element(By.CSS_SELECTOR,"#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-insert > button > i").click()
        WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.modal.note-modal.in > div > div > div.modal-header > h4")))
        if "Insert Image" != driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.modal.note-modal.in > div > div > div.modal-header > h4").text:
            testResult = False
            Result_msg += "#14 "

        if "#14" not in Result_msg:
            # Picture upload #15 16
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[7]/div/div/div[2]/div[1]/input").send_keys(upload_pic)
            try:
                WebDriverWait(driver, 0.3).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p > img")))
            except:
                testResult = False
                Result_msg += "#15 #16 "

            # A + backspace
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys(Keys.CONTROL + "A")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys(Keys.BACKSPACE)

            # Picture Open
            driver.find_element(By.CSS_SELECTOR,"#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-insert > button > i").click()
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.modal.note-modal.in > div > div > div.modal-header > h4")))

            # Picutre url upload #17
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[7]/div/div/div[2]/div[2]/input").send_keys(upload_pic_url)
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.modal.note-modal.in > div > div > div.modal-footer > input").click()
            try:
                WebDriverWait(driver, 0.3).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p > img")))
            except:
                testResult = False
                Result_msg += "#17 "

            # A + backspace
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys(Keys.CONTROL + "A")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys(Keys.BACKSPACE)

            # Picture Open
            driver.find_element(By.CSS_SELECTOR,"#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.panel-heading.note-toolbar > div.note-btn-group.btn-group.note-insert > button > i").click()
            WebDriverWait(driver, 0.1).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.modal.note-modal.in > div > div > div.modal-header > h4")))
            
            # Picutre url bad upload #18
            driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div/section[1]/div[2]/div[2]/div/div[4]/div[7]/div/div/div[2]/div[2]/input").send_keys("bad")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.modal.note-modal.in > div > div > div.modal-footer > input").click()
            try:
                WebDriverWait(driver, 0.3).until(EC.presence_of_element_located((By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable > p > img")))
                testResult = False
                Result_msg += "#18 "
            except:
                pass
        
        # Board input
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#")

        # Both On #21
        # Display Now On (Public On - Default)
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
        WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        text = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)
        if (text != "Notice 등록에 성공하였습니다." or 
            driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(2) > div > label > input").get_property("checked") == False or
            driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(3) > div > label > input").get_property("checked") == False):
            testResult = False
            Result_msg = "#21 "

        if "#21" not in Result_msg:
            # Title & Board input
            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title3#")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#")
            
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
            WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.25)

            if driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.even > td:nth-child(3) > div > label > input").get_property("checked") == True:
                testResult = False
                Result_msg += "#21"
        
        # Deletion
        if "#21" not in Result_msg:
            for n in range (0, 2):
                element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(7) > button")
                driver.execute_script("arguments[0].click()",element)
                WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                time.sleep(0.25)

        # Title & Board input
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title3#")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#")

        # Public off, now on #22
        # public off, now on
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(2) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
        WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        text = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)
        if (text != "Notice 등록에 성공하였습니다." or 
            driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(2) > div > label > input").get_property("checked") == True or
            driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(3) > div > label > input").get_property("checked") == False):
            testResult = False
            Result_msg = "#22 "

        if "#22" not in Result_msg:
            # Title & Board input
            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title3#")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#")
            
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(2) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
            WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.25)

            if driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.even > td:nth-child(3) > div > label > input").get_property("checked") == True:
                testResult = False
                Result_msg += "#22"
        
        # Deletion
        if "#22" not in Result_msg:
            for n in range (0, 2):
                element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(7) > button")
                driver.execute_script("arguments[0].click()",element)
                WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                time.sleep(0.25)

        # Title & Board input
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title3#")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#")

        # Clear #23
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_clear").click()
        if (driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").get_property("value") != "" or
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").get_property("textContent") != ""):
            testResult = False
            Result_msg += "#23 "

        # Public Display Function #20
        # Title & Board input & Save
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title3#")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#_public")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
        WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)

        # Title & Board input & Save
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title3#")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board3#_nopublic")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(2) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
        WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # 새로운 탭 + 전환
        driver.execute_script("window.open()")
        driver.switch_to.window(driver.window_handles[1])
        driver.get(WorklistUrl);
        driver.implicitly_wait(5)
        time.sleep(1.5)

        driver.switch_to.window(driver.window_handles[2])
        driver.implicitly_wait(5)
        if driver.find_element(By.XPATH, "/html/body/div/div/div[3]/div/div[2]/div").text != "rnd_board3#_public":
            testResult = False
            Result_msg += "#20 "
        driver.close()
        driver.switch_to.window(driver.window_handles[1])

        signInOut.wk_login(wk_id, wk_pw)
        time.sleep(1)
        driver.switch_to.window(driver.window_handles[2])
        driver.implicitly_wait(5)
        if driver.find_element(By.XPATH, "/html/body/div/div/div[3]/div/div[2]/div").text != "rnd_board3#_nopublic":
            testResult = False
            Result_msg += "#20 "
        driver.close()
        driver.switch_to.window(driver.window_handles[1])

        driver.find_element(By.CSS_SELECTOR, "#right-sidebar-logout").click()
        driver.implicitly_wait(5)

        driver.close()
        driver.switch_to.window(driver.window_handles[0])

        driver.find_element(By.CSS_SELECTOR, "body > nav > div > ul:nth-child(3) > li > a > span").click()
        driver.implicitly_wait(5)
        time.sleep(1.5)

        driver.switch_to.window(driver.window_handles[1])
        if driver.find_element(By.XPATH, "/html/body/div/div/div[3]/div/div[2]/div").text != "rnd_board3#_public":
            testResult = False
            Result_msg = "#20 "
        driver.close()
        driver.switch_to.window(driver.window_handles[0])

        # Deletion
        signInOut.admin_sign_in()
        # Notice
        driver.find_element(By.CSS_SELECTOR, "#tab-notice > a").click()
        driver.implicitly_wait(5)
        for n in range (0, 2):
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(7) > button")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.25)

        # NoticeList_NoticeEditBoard결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2188, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2188, testPlanID, buildName, 'p', "NoticeList_NoticeEditBoard Test Passed")

    def NoticeList_Edit():
        print("ITR-104: Notice > Notice list > Edit")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Notice
        driver.find_element(By.CSS_SELECTOR, "#tab-notice > a").click()
        driver.implicitly_wait(5)

        # Add #9
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title_edit")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board_edit")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
        WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        if driver.find_element(By.CSS_SELECTOR , "#curernt_display_list > tbody > tr.odd > td:nth-child(5)").text != "rnd_title_edit":
            testResult = False
            Result_msg  += "#9 "
        
        if "#9" not in Result_msg:       
            # Edit #1
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(1) > div")
            driver.execute_script("arguments[0].click()",element)
            time.sleep(0.15)
            if driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").get_property("value") != "rnd_title_edit":
                testResult == False
                Result_msg += "#1 "

        if "#1" not in Result_msg:
            # Update #2
            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("_update")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("_update")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(2) > label").click()

            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_update").click()
            WebDriverWait(driver, 0.3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR , "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.25)
            if (driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(3) > div > label > input").get_property("checked") == True or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(2) > div > label > input").get_property("checked") == True or
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(5)").text != "rnd_title_edit_update" or 
                msg != "Notice 정보를 수정하였습니다."):
                testResult = False
                Result_msg += "#2 "

            # Edit
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(1) > div")
            driver.execute_script("arguments[0].click()",element)
            time.sleep(0.15)

            # Create #3
            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("_create")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("_create")
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(1) > label").click()
            driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div:nth-child(1) > div:nth-child(2) > label").click()

            driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
            WebDriverWait(driver, 0.5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR , "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.25)
            if (driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(3) > div > label > input").get_property("checked") == False or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(2) > div > label > input").get_property("checked") == False or
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(5)").text != "rnd_title_edit_update_create" or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(5)").text != "rnd_title_edit_update" or
                msg != "Notice 등록에 성공하였습니다."):
                testResult = False
                Result_msg += "#3 "

            # Toggle #4 5 6 7
            # 2-1 off > on
            time.sleep(1)
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(2) > div > label > span")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if (msg != "Notice 정보를 수정하였습니다." or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(2) > div > label > input").get_property("checked")==False):
                testResult = False
                Result_msg += "#4 "
            # 2-2 off > on
            time.sleep(1)
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(3) > div > label > span")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if (msg != "Notice 정보를 수정하였습니다." or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(5)").text != "rnd_title_edit_update" or
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(3) > div > label > input").get_property("checked")==False):
                testResult = False
                Result_msg += "#5 "

            if (driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(5)").text != "rnd_title_edit_update_create" or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(3) > div > label > input").get_property("checked") != False):
                testResult = False
                Result_msg += "#6 "

            # 1-1 on > off
            time.sleep(1)
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(2) > div > label > span")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 0.5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.15)
            # 2-1 on > off
            time.sleep(1)
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(2) > div > label > span")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 0.5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.15)
            # 2-2 off > on
            time.sleep(1)
            element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(2) > div > label > span")
            driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 0.5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            time.sleep(0.15)
            if (driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(5)").text != "rnd_title_edit_update" or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(2) > td:nth-child(3) > div > label > input").get_property("checked") != False):
                testResult = False
                Result_msg += "#7 "

            for n in range (0, 2):
                element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(7) > button")
                driver.execute_script("arguments[0].click()",element)
                WebDriverWait(driver, 0.5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
                driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
                time.sleep(0.25)

        # NoticeList_Edit결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2213, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2213, testPlanID, buildName, 'p', "NoticeList_Edit Test Passed")

    def NoticeList_Delete():
        print("ITR-105: Notice > Notice list > Delete")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Notice
        driver.find_element(By.CSS_SELECTOR, "#tab-notice > a").click()
        driver.implicitly_wait(5)

        # Add
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title_delete")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board_edit")
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.3)

        # Delete #1
        element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(7) > button")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        msg = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)

        try:
            if (msg != "Notice가 삭제되었습니다." or 
                driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(5)").text == "rnd_title_delete"):
                testResult = False
                Result_msg += "#1 "
        except:
            pass

        # NoticeList_Delete결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2224, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2224, testPlanID, buildName, 'p', "NoticeList_Delete Test Passed")

    def NoticeList_NoticeDisplay():
        print("ITR-106: Notice > Notice list > Display")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Notice
        driver.find_element(By.CSS_SELECTOR, "#tab-notice > a").click()
        driver.implicitly_wait(5)

        # Add
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_title").send_keys("rnd_title_display")
        driver.find_element(By.CSS_SELECTOR, "#user-search-option > div > div.note-editor.note-frame.panel.panel-default > div.note-editing-area > div.note-editable").send_keys("rnd_board_display")
        driver.find_element(By.CSS_SELECTOR, "#register_itr_notice_confirm").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.3)

        # Display #1
        element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr.odd > td:nth-child(8) > button")
        driver.execute_script("arguments[0].click()",element)
        driver.switch_to.window(driver.window_handles[1])
        driver.implicitly_wait(5)
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#notice_modal_cancel")))
        time.sleep(1.5)
        if (driver.find_element(By.CSS_SELECTOR, "#notice_body_title").text !=  "rnd_title_display" or
            driver.find_element(By.CSS_SELECTOR, "#notice_modal_body_right_side > div").text != "rnd_board_display"):
            testResult = False
            Result_msg += "#1 "
        driver.find_element(By.CSS_SELECTOR, "#notice_modal_cancel").click()
        driver.switch_to.window(driver.window_handles[0])
        driver.implicitly_wait(5)

        # Delete
        element = driver.find_element(By.CSS_SELECTOR, "#curernt_display_list > tbody > tr:nth-child(1) > td:nth-child(7) > button")
        driver.execute_script("arguments[0].click()",element)
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)

        # NoticeList_NoticeDisplay결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2227, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2227, testPlanID, buildName, 'p', "NoticeList_NoticeDisplay Test Passed")

class DirectMessage:
    def DirectMessageBox_ViewSort(asc):
        print("ITR-107: Direct Message > Direct Message Box > Search")
        #del driver.requests - need
        testResult = True
        if asc == True:
            ori_order = "mail"
            nxt_order = "drafts"
        else:
            ori_order = "drafts"
            nxt_order = "mail"

        request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        cmr_content = []
        cmr_content.append(driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr[1]/td[1]/span/i").text)
        time_temp = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr[1]/td[4]").text
        cmr_content.append(datetime.strptime(time_temp, '%Y-%m-%d %H:%M'))
        num = 2
        while num < (len(data)+1):
            time_temp = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr["+str(num)+"]/td[4]").text
            selected_time = datetime.strptime(time_temp, '%Y-%m-%d %H:%M')

            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr["+str(num)+"]/td[1]/span/i").text == nxt_order:
                cmr_content[0] = nxt_order
                cmr_content[1] = selected_time
                num += 1
                break
            
            num += 1
            sub = str(cmr_content[1] - selected_time)
            if '-' in sub:
                testResult = False
                break
            else:
                cmr_content[1] = selected_time

        while num < (len(data)+1):
            if driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr["+str(num)+"]/td[1]/span/i").text == ori_order:
                testResult = False
                break
            
            time_temp = driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr["+str(num)+"]/td[4]").text
            selected_time = datetime.strptime(time_temp, '%Y-%m-%d %H:%M')
            num += 1
            sub = str(cmr_content[1] - selected_time)
            if '-' in sub:
                testResult = False
                break
            else:
                cmr_content[1] = selected_time

        return testResult


    def DirectMessageBox_Search():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # Direct Message Tab #1
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        temp = DirectMessage.DirectMessageBox_ViewSort(asc=True)
        if temp == False:
            testResult = False
            Result_msg += "#1 "

        # User ID Search #2
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_value").send_keys(search_id)
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search > i").click()
        
        request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        for current_page in range(0, total):
            for n in range (1, (len(data["data"]) + 1) ):
                if search_id not in driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr["+str(n)+"]/td[3]").text:
                        testResult = False
                        Result_msg += "#2 "

            if current_page + 1 == total:
                break
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_value").clear()

        # User Name Search #3
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_type").click()
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_type > option:nth-child(2)").click()
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_value").send_keys(search_username)
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search > i").click()
        
        request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        for current_page in range(0, total):
            for n in range (1, (len(data["data"]) + 1) ):
                if search_username not in driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr["+str(n)+"]/td[3]").text:
                        testResult = False
                        Result_msg += "#3 "

            if current_page + 1 == total:
                break
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_value").clear()

        del driver.requests
        time.sleep(1)

        # Msg Text Search #4
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_type").click()
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_type > option:nth-child(3)").click()
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search_value").send_keys(search_text)
        driver.find_element(By.CSS_SELECTOR, "#direct_message_search > i").click()
        
        request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])
        for current_page in range(0, total):
            for n in range (1, (len(data["data"]) + 1) ):
                if search_text not in driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[1]/div/div[1]/div[3]/div/div/div[4]/div[2]/table/tbody/tr["+str(n)+"]/td[2]").text.lower():
                    testResult = False
                    Result_msg += "#4 "
                    break

            if (current_page + 1 == total or
                "#4" in Result_msg ):
                break

        # DirectMessageBox_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2232, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2232, testPlanID, buildName, 'p', "DirectMessageBox_Search Test Passed")

    def DirectMessageBox_ShowEntries_fun(entries, num):
        print("ITR-108: Direct Message > Direct Message Box > Show Entries")
        Result_msg = ""

        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#message_list_group_length > label > select").click()
        driver.find_element(By.CSS_SELECTOR, "#message_list_group_length > label > select > option:nth-child("+str(num)+")").click()
        request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        if data["Length"] != entries:
            Result_msg += "#"+str(num)+" "
        if data["recordsFiltered"] > entries:
            try:
                WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#message_list_group_next > a")))
            except:
                Result_msg += "#"+str(num)+" "

        return Result_msg

    def DirectMessageBox_ShowEntries():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # 10 #2
        temp = DirectMessage.DirectMessageBox_ShowEntries_fun(10, 2)
        if temp != "":
            testResult = False
            Result_msg += temp

        # 5 #1
        temp = DirectMessage.DirectMessageBox_ShowEntries_fun(5, 1)
        if temp != "":
            testResult = False
            Result_msg += temp

        # 20 #3
        temp = DirectMessage.DirectMessageBox_ShowEntries_fun(20, 3)
        if temp != "":
            testResult = False
            Result_msg += temp

        # 50 #4
        temp = DirectMessage.DirectMessageBox_ShowEntries_fun(50, 4)
        if temp != "":
            testResult = False
            Result_msg += temp

        # 100 #5
        temp = DirectMessage.DirectMessageBox_ShowEntries_fun(100, 5)
        if temp != "":
            testResult = False
            Result_msg += temp

        # DirectMessageBox_ShowEntries결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2238, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2238, testPlanID, buildName, 'p', "DirectMessageBox_ShowEntries Test Passed")

    def DirectMessageBox_WNSort(length, asc):
        print("ITR-109: Direct Message > Direct Message Box > Sorting")
        testResult = True
        sender = []

        for n in range (1, length+1):
            sender.append(driver.find_element(By.CSS_SELECTOR, "#message_list_group > tbody > tr:nth-child("+str(n)+") > td:nth-child(3)").text)
        sorted_sender = sender
        if asc == True:
            sorted_sender.sort()
        else:
            sorted_sender.sort(reverse=True)

        if sender != sorted_sender:
            testResult = False

        return testResult

    def DirectMessageBox_STSort(length, asc):
        testResult = True

        time_temp = driver.find_element(By.CSS_SELECTOR, "#message_list_group > tbody > tr:nth-child(1) > td:nth-child(4)").text
        cmr_time = datetime.strptime(time_temp, '%Y-%m-%d %H:%M')
        for n in range(2, length + 1):
            time_temp = driver.find_element(By.CSS_SELECTOR, "#message_list_group > tbody > tr:nth-child("+str(n)+") > td:nth-child(4)").text
            selected_time = datetime.strptime(time_temp, '%Y-%m-%d %H:%M')

            sub = str(cmr_time - selected_time)
            #true일떄 - 찍히거나 0:00:00
            #false일떄 - 안찍히고 0:00:00
            if asc == False:
                if '-' in sub:
                    testResult = False
                    break
            else:
                if sub != "0:00:00":
                    if '-' not in sub:
                        testResult = False
                        break
            cmr_time = selected_time

    def DirectMessageBox_Sorting():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # R #1
        for n in range(0,2):
            del driver.requests
            driver.find_element(By.CSS_SELECTOR, "#message_list_group_wrapper > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:nth-child(1)").click()
            request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)

            if data["OrderColumn"] == "view":
                if data["OrderType"] == "asc":
                    temp = DirectMessage.DirectMessageBox_ViewSort(asc=True)
                    if temp == False:
                        testResult = False
                        Result_msg += "#1 "
                elif data["OrderType"] == "desc":
                    temp = DirectMessage.DirectMessageBox_ViewSort(asc=False)
                    if temp == False:
                        testResult = False
                        Result_msg += "#1 "
            else:
                testResult = False
                Result_msg += "#1 "

        # Sender #2
        for n in range(0,2):
            del driver.requests
            driver.find_element(By.CSS_SELECTOR, "#message_list_group_wrapper > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:nth-child(3)").click()
            request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)

            if data["OrderColumn"] == "WRITER_NAME":
                if data["OrderType"] == "asc":
                    temp = DirectMessage.DirectMessageBox_WNSort(len(data["data"]),asc=True)
                    if temp == False:
                        testResult = False
                        Result_msg += "#2 "
                elif data["OrderType"] == "desc":
                    temp = DirectMessage.DirectMessageBox_WNSort(len(data["data"]),asc=False)
                    if temp == False:
                        testResult = False
                        Result_msg += "#2 "
            else:
                testResult = False
                Result_msg += "#2 "

        # SendTime #3
        for n in range(0,2):
            del driver.requests
            driver.find_element(By.CSS_SELECTOR, "#message_list_group_wrapper > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:nth-child(4)").click()
            request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)

            if data["OrderColumn"] == "WRITE_DTTM":
                if data["OrderType"] == "asc":
                    temp = DirectMessage.DirectMessageBox_STSort(len(data["data"]),asc=True)
                    if temp == False:
                        testResult = False
                        Result_msg += "#3 "
                elif data["OrderType"] == "desc":
                    temp = DirectMessage.DirectMessageBox_STSort(len(data["data"]),asc=False)
                    if temp == False:
                        testResult = False
                        Result_msg += "#3 "
            else:
                testResult = False
                Result_msg += "#3 "

        # DirectMessageBox_Sorting결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2245, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2245, testPlanID, buildName, 'p', "DirectMessageBox_Sorting Test Passed")
   
    def DirectMessageBox_Badge():
        print("ITR-110: Direct Message > Direct Message Box > Badge")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # Message Box Count #1
        request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        unread_count = 0
        for a in range(1, total+1):
            request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)
            time.sleep(0.5)

            for b in range(1, len(data["data"])+1):
                if driver.find_element(By.CSS_SELECTOR, "#message_list_group > tbody > tr:nth-child("+str(b)+") > td:nth-child(1)").get_property("textContent") == "mail":
                    unread_count += 1
                else:
                    break
            if driver.find_element(By.CSS_SELECTOR, "#message_list_group > tbody > tr:nth-child("+str(len(data["data"]))+") > td:nth-child(1)").get_property("textContent") == "drafts" or a == total:
                break

            del driver.requests
            time.sleep(1)

            driver.find_element(By.CSS_SELECTOR, "#message_list_group_next > a").click()

        try:
            assert(unread_count != driver.find_element(By.CSS_SELECTOR, "#direct_message_total_count").text and
                   unread_count != driver.find_element(By.CSS_SELECTOR, "#unread_dm_cnt").text)
        except:
            testResult = False
            Result_msg += "#1 "
            
        # DirectMessageBox_Badge결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2250, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2250, testPlanID, buildName, 'p', "DirectMessageBox_Badge Test Passed")

    def DirectMessageBox_Message():
        print("ITR-111: Direct Message > Direct Message Box > Message")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        del driver.requests
        time.sleep(1)

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # Read
        request = driver.wait_for_request('.*/GetDirectMessageListForTable.*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)["data"]

        target = []
        target.append(data[len(data)-1]["WRITER_NAME"])
        target.append(str(datetime.strptime(data[len(data)-1]["WRITE_DTTM"], '%Y-%m-%dT%H:%M:%S')))
        target.append(data[len(data)-1]["MESSAGE_TEXT_LOB"])
        
        driver.find_element(By.CSS_SELECTOR, "#message_list_group > tbody > tr:nth-child("+str(len(data))+") > td:nth-child(2)").click()
        try:
            WebDriverWait(driver, 10).until(EC.text_to_be_present_in_element_value((By.CSS_SELECTOR, "#load_message_text"), target[2]))
            assert(target[0] == driver.find_element(By.CSS_SELECTOR, "#load_message_writer").get_property("value") and 
                   target[1] == driver.find_element(By.CSS_SELECTOR, "#load_message_write_dttm").get_property("value") and
                   target[2] == driver.find_element(By.CSS_SELECTOR, "#load_message_text").get_property("value"))
        except:
            testResult = False
            Result_msg += "#1 "
        
        # DirectMessageBox_Message결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2253, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2253, testPlanID, buildName, 'p', "DirectMessageBox_Message Test Passed")

    # search = Institution, Center, Reporter
    def NewDirectMessage_Search_fun(search, search_target):
        print("ITR-112: Direct Message > Direct Message Box > Institution - Search")
        testResult = True
        Result_msg = ""
        driver.wait_for_request('.*/GetAccess'+search+'List*')
        
        # Search & Select & Selected select #1 2 3
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#direct_message_send_search_value").send_keys(search_target) 
        driver.find_element(By.CSS_SELECTOR, "#direct_message_send_search > i").click()
        request = driver.wait_for_request('.*/GetAccess'+search+'List*')
        body = request.response.body.decode('utf-8')
        data = json.loads(body)
        total = math.ceil(data["recordsFiltered"] / data["Length"])

        for a in range (1, total+1):
            request = driver.wait_for_request('.*/GetAccess'+search+'List*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]
            for b in range (1, len(data)+1):
                if search == "Reporter":
                    if search_target not in driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[1]/div[2]/div[6]/div/table/tbody/tr["+str(b)+"]/td[3]").text:
                        testResult = False
                        Result_msg += "#1 "
                        break
                else:
                    if search_target not in driver.find_element(By.CSS_SELECTOR, "#add_dm_access_"+search.lower()+"_list > tbody > tr:nth-child("+str(b)+") > td:nth-child(2)").text:
                        testResult = False
                        Result_msg += "#1 "
                        break
            if testResult == False or a == total:
                # 2, 3은 마지막을 기준으로 판단
                try:
                    if search == "Reporter":
                        driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[1]/div[2]/div[6]/div/table/tbody/tr["+str(len(data))+"]/td[1]/label").click()
                    else:
                        driver.find_element(By.CSS_SELECTOR, "#add_dm_access_"+search.lower()+"_list > tbody > tr:nth-child("+str(len(data))+") > td.th-check.align-center.dm-th-check > label").click()
                    WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#selected_recipient_list_wrapper > button")))
                    if search == "Reporter":
                        assert(driver.find_element(By.CSS_SELECTOR, "#selected_recipient_list_wrapper > button").text == driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[2]/div[2]/div/div[1]/div[2]/div[6]/div/table/tbody/tr["+str(len(data))+"]/td[3]").text.split(' / ')[1])
                    else:
                        assert(driver.find_element(By.CSS_SELECTOR, "#selected_recipient_list_wrapper > button").text == driver.find_element(By.CSS_SELECTOR, "#add_dm_access_"+search.lower()+"_list > tbody > tr:nth-child("+str(len(data))+") > td:nth-child(2)").text)
                except:
                    testResult = False
                    Result_msg += "#2 "
                driver.find_element(By.CSS_SELECTOR, "#selected_recipient_list_wrapper > button").click()
                time.sleep(0.25)
                if driver.find_element(By.CSS_SELECTOR, "#add_dm_access_"+search.lower()+"_list > tbody > tr:nth-child("+str(len(data))+") > td.th-check.align-center.dm-th-check > label").is_selected == True:
                    testResult = False
                    Result_msg += "#3 "
                break
            del driver.requests
            driver.find_element(By.CSS_SELECTOR, "#add_dm_access_"+search.lower()+"_list_next > a").click()

        return Result_msg

    # msg - NewDirectMessage_Institution_Message Test, NewDirectMessage_Center_Message Test, NewDirectMessage_Reporter_Message Test
    def NewDirectMessage_Message_fun(search, search_target, num):
        Result_msg = ""

        # Search
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#message-add-tab > div:nth-child(2) > div > div.col-lg-5 > div:nth-child(1) > ul > li:nth-child("+str(num)+") > a").click()
        driver.wait_for_request('.*/GetAccess'+search+'List*')
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#direct_message_send_search_value").send_keys(search_target) 
        driver.find_element(By.CSS_SELECTOR, "#direct_message_send_search > i").click()
        driver.wait_for_request('.*/GetAccess'+search+'List*')

        # Send #1
        driver.find_element(By.CSS_SELECTOR, "#add_dm_access_"+search.lower()+"_list > tbody > tr:nth-child(1) > td.th-check.align-center.dm-th-check > label").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#selected_recipient_list_wrapper > button")))
        driver.find_element(By.CSS_SELECTOR, "#add_direct_message_textarea").send_keys("NewDirectMessage_"+search+"_Message Test")
        driver.find_element(By.CSS_SELECTOR, "#add_direct_message").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        if "Direct Message를 전송하였습니다" != driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text:
            Result_msg += "#1 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.5)

        # Search
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#message-add-tab > div:nth-child(2) > div > div.col-lg-5 > div:nth-child(1) > ul > li:nth-child("+str(num)+") > a").click()
        driver.wait_for_request('.*/GetAccess'+search+'List*')
        del driver.requests
        driver.find_element(By.CSS_SELECTOR, "#direct_message_send_search_value").send_keys(search_target) 
        driver.find_element(By.CSS_SELECTOR, "#direct_message_send_search > i").click()
        driver.wait_for_request('.*/GetAccess'+search+'List*')
        
        # no input send #2
        driver.find_element(By.CSS_SELECTOR, "#add_dm_access_"+search.lower()+"_list > tbody > tr:nth-child(1) > td.th-check.align-center.dm-th-check > label").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#selected_recipient_list_wrapper > button")))
        driver.find_element(By.CSS_SELECTOR, "#add_direct_message").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        if "Message 내용을 입력해주세요" != driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text:
            Result_msg += "#2 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.5)

        # Cancel #3
        driver.find_element(By.CSS_SELECTOR, "#add_direct_message_textarea").send_keys("NewDirectMessage_"+search+"_Message Test")
        driver.find_element(By.CSS_SELECTOR, "#cancel_add_direct_message").click()
        # text안의 값이 바뀐 경우 처리
        if driver.find_element(By.CSS_SELECTOR, "#add_direct_message_textarea").get_property("value") != "NewDirectMessage_"+search+"_Message Test":
            Result_msg += "#3 "
        time.sleep(0.25)

        return Result_msg

    def NewDirectMessage_Institution_Search():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # NewDirectMessage
        driver.find_element(By.CSS_SELECTOR, "#direct-message-add-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#add_direct_message")))

        # Search & Select & Selected select #1 2 3
        driver.find_element(By.CSS_SELECTOR, "#message-add-tab > div:nth-child(2) > div > div.col-lg-5 > div:nth-child(1) > ul > li:nth-child(1) > a").click()
        temp = DirectMessage.NewDirectMessage_Search_fun("Institution", search_institution)
        if temp != "":
            testResult = False
            Result_msg += temp

        # NewDirectMessage_Institution_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2256, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2256, testPlanID, buildName, 'p', "NewDirectMessage_Institution_Search Test Passed")

    def NewDirectMessage_Institution_Message():
        print("ITR-113: Direct Message > Direct Message Box > Institution - Message")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # NewDirectMessage
        driver.find_element(By.CSS_SELECTOR, "#direct-message-add-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#add_direct_message")))

        # Send, no input send, Cancel #1, 2, 3
        # search, search_target, num, msg
        temp = DirectMessage.NewDirectMessage_Message_fun("Institution", search_institution, 1)
        if temp != "":
            testResult = False
            Result_msg += temp

        # NewDirectMessage_Institution_Message결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2261, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2261, testPlanID, buildName, 'p', "NewDirectMessage_Institution_Message Test Passed")

    def NewDirectMessage_Center_Search():
        print("ITR-114: Direct Message > Direct Message Box > Center - Search")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # NewDirectMessage
        driver.find_element(By.CSS_SELECTOR, "#direct-message-add-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#add_direct_message")))

        # Search & Select & Selected select #1 2 3
        driver.find_element(By.CSS_SELECTOR, "#message-add-tab > div:nth-child(2) > div > div.col-lg-5 > div:nth-child(1) > ul > li:nth-child(2) > a").click()
        temp = DirectMessage.NewDirectMessage_Search_fun("Center", search_center)
        if temp != "":
            testResult = False
            Result_msg += temp

        # NewDirectMessage_Center_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2266, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2266, testPlanID, buildName, 'p', "NewDirectMessage_Center_Search Test Passed")

    def NewDirectMessage_Center_Message():
        print("ITR-115: Direct Message > Direct Message Box > Center - Message")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # NewDirectMessage
        driver.find_element(By.CSS_SELECTOR, "#direct-message-add-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#add_direct_message")))

        # Send, no input send, Cancel #1, 2, 3
        # search, search_target, num, msg
        temp = DirectMessage.NewDirectMessage_Message_fun("Center", search_center, 2)
        if temp != "":
            testResult = False
            Result_msg += temp

        # NewDirectMessage_Center_Message결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2271, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2271, testPlanID, buildName, 'p', "NewDirectMessage_Center_Message Test Passed")


    def NewDirectMessage_Reporter_Search():
        print("ITR-116: Direct Message > Direct Message Box > Reporter - Search")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # NewDirectMessage
        driver.find_element(By.CSS_SELECTOR, "#direct-message-add-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#add_direct_message")))

        # Search & Select & Selected select #1 2 3
        driver.find_element(By.CSS_SELECTOR, "#message-add-tab > div:nth-child(2) > div > div.col-lg-5 > div:nth-child(1) > ul > li:nth-child(3) > a").click()
        temp = DirectMessage.NewDirectMessage_Search_fun("Reporter", search_reporter)
        if temp != "":
            testResult = False
            Result_msg += temp

        # NewDirectMessage_Reporter_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2276, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2276, testPlanID, buildName, 'p', "NewDirectMessage_Reporter_Search Test Passed")

    def NewDirectMessage_Reporter_Message():
        print("ITR-117: Direct Message > Direct Message Box > Reporter - Message")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessageBox
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # NewDirectMessage
        driver.find_element(By.CSS_SELECTOR, "#direct-message-add-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#add_direct_message")))

        # Send, no input send, Cancel #1, 2, 3
        # search, search_target, num, msg
        temp = DirectMessage.NewDirectMessage_Message_fun("Reporter", search_reporter, 3)
        if temp != "":
            testResult = False
            Result_msg += temp

        # NewDirectMessage_Reporter_Message결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2281, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2281, testPlanID, buildName, 'p', "NewDirectMessage_Reporter_Message Test Passed")

    def DirectMessageSetting_Search_fun(auth, search_target):
        print("ITR-118: Direct Message > Direct Message Setting > Search")
        Result_msg = ""

        if auth == "unAuth":
            list_position = 2
        elif auth == "auth":
            list_position = 4

        # ID & Name
        for a in range (1, 3):
            del driver.requests

            driver.find_element(By.CSS_SELECTOR, "#"+auth+"_reporter_search_type").click()
            driver.find_element(By.CSS_SELECTOR, "#"+auth+"_reporter_search_type > option:nth-child("+str(a)+")").click()
            driver.find_element(By.CSS_SELECTOR, "#"+auth+"_reporter_search_value").send_keys(search_target)
            driver.find_element(By.CSS_SELECTOR, "#search_"+auth+"_reporter").click()
            driver.find_element(By.CSS_SELECTOR, "#"+auth+"_reporter_search_value").clear()

            request = driver.wait_for_request('.*/GetDirectMessage.*')
            body = request.response.body.decode('utf-8')
            data = json.loads(body)["data"]

            for b in range(1, len(data)+1):
                if search_target.lower() not in driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div["+str(list_position)+"]/div[3]/div/div/table/tbody/tr["+str(b)+"]/td["+str(a+1)+"]").text.lower():
                    if auth == "unAuth":
                        Result_msg += "#"+str(a)+" "
                    else:
                        Result_msg += "#"+str(a+2)+" "
                    break
        
        return Result_msg

    def DirectMessageSetting_Search():
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessage
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # Direct Message Setting
        driver.find_element(By.CSS_SELECTOR, "#direct-message-setting-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#search_unAuth_reporter > i")))

        # unAuth / auth Search #1 2 3 4
        temp = DirectMessage.DirectMessageSetting_Search_fun("unAuth", unauth_search_id)
        temp += DirectMessage.DirectMessageSetting_Search_fun("unAuth", unauth_search_username)
        temp += DirectMessage.DirectMessageSetting_Search_fun("auth", search_id)
        temp += DirectMessage.DirectMessageSetting_Search_fun("auth", search_username)

        if temp != "":
            testResult = False
            Result_msg += temp

        # DirectMessageSetting_Search결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2287, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2287, testPlanID, buildName, 'p', "DirectMessageSetting_Search Test Passed")

    def DirectMessageSetting_Authorize():
        print("ITR-119: Direct Message > Direct Message Setting > Authorize")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessage
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # Direct Message Setting
        driver.find_element(By.CSS_SELECTOR, "#direct-message-setting-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#search_unAuth_reporter > i")))

        # Auth Search
        del driver.requests
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#auth_reporter_search_value").send_keys(search_id)
        driver.find_element(By.CSS_SELECTOR, "#search_auth_reporter").click()
        driver.wait_for_request('.*/GetDirectMessage.*')
        time.sleep(0.5)

        # Select #2
        driver.find_element(By.CSS_SELECTOR, "#center_authorized_reporter_list > tbody > tr.odd > td.th-check.align-center.dm-th-check > label").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#selected_reporter_box > button")))
        #rgb(242, 222, 222)
        color = driver.find_element(By.CSS_SELECTOR, "#selected_reporter_box > button").value_of_css_property("background-color")
        driver.find_element(By.CSS_SELECTOR, "#remove_direct_message_authentication_btn > i").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        if color != "rgba(242, 222, 222, 1)" or driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "Direct Messsage 권한을 삭제하였습니다":
            testResult = False
            Result_msg += "#2 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)

        # UnAuth Search
        del driver.requests
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#unAuth_reporter_search_value").send_keys(search_id)
        driver.find_element(By.CSS_SELECTOR, "#search_unAuth_reporter").click()
        driver.wait_for_request('.*/GetDirectMessage.*')
        time.sleep(0.5)

        # Select #1
        driver.find_element(By.CSS_SELECTOR, "#center_unauthorized_reporter_list > thead > tr > th.align-center.th-check.dm-th-check.sorting_disabled > label").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#selected_reporter_box > button")))
        #rgb(255, 152, 0)
        color = driver.find_element(By.CSS_SELECTOR, "#selected_reporter_box > button").value_of_css_property("background-color")
        driver.find_element(By.CSS_SELECTOR, "#grant_direct_message_authentication_btn > i").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        if color != "rgba(255, 152, 0, 1)" or driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text != "Direct Messsage 권한을 추가하였습니다":
            testResult = False
            Result_msg += "#1 "
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        time.sleep(0.25)

        # Non Select Arrow #3
        if (driver.find_element(By.CSS_SELECTOR, "#remove_direct_message_authentication_btn").value_of_css_property("cursor") != "not-allowed" and
            driver.find_element(By.CSS_SELECTOR, "#grant_direct_message_authentication_btn").value_of_css_property("cursor") != "not-allowed"):
            testResult = False
            Result_msg += "#3 "

        # New User #4
        # User Management Add
        driver.find_element(By.CSS_SELECTOR, "#tab-config > a").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn")))
        driver.find_element(By.CSS_SELECTOR, "#user-list_wrapper > div.dt-buttons > a.dt-button.btn.btn-xs.waves-effect.add-btn").click()
        # Input
        while(1):
            test_id = add_test_id+str(random.randrange(0,100000))
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").clear()
            driver.find_element(By.CSS_SELECTOR, "#user-add-id").send_keys(test_id)
            WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user-add-validation-btn")))
            driver.find_element(By.CSS_SELECTOR, "#user-add-validation-btn").click()
            #driver.execute_script("arguments[0].click()",element)
            WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
            check = driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > h2").text
            driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
            if check != "User ID is Exist!":
                break
        driver.find_element(By.CSS_SELECTOR, "#user-add-pw").send_keys(add_test_pw)
        driver.find_element(By.CSS_SELECTOR, "#user-add-name").send_keys(test_id)

        # Reporter Click
        driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > a").click()
        child_num = driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div").get_property("childElementCount")
        for n in range (1, child_num+1):
            if driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").text == "Reporter":
                driver.find_element(By.CSS_SELECTOR, "#user_add_level_chosen > div > ul > li:nth-child("+str(n)+")").click()

        # Center Click
        driver.find_element(By.CSS_SELECTOR, "#user_add_center_chosen").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#user_add_center_chosen > div > div > input[type=text]")))
        driver.find_element(By.CSS_SELECTOR, "#user_add_center_chosen > div > div > input[type=text]").send_keys(search_center)
        driver.find_element(By.CSS_SELECTOR, "#user_add_center_chosen > div > div > input[type=text]").send_keys(Keys.ENTER)
        
        # Save
        driver.find_element(By.CSS_SELECTOR, "#user-add-save-btn").click()
        WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button")))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()
        WebDriverWait(driver, 3).until(EC.text_to_be_present_in_element((By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button"), "OK"))
        driver.find_element(By.CSS_SELECTOR, "body > div.sweet-alert.showSweetAlert.visible > div.sa-button-container > div > button").click()

        # DirectMessage
        del driver.requests
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.wait_for_request(".*/GetUnread.*")
        time.sleep(0.5)

        # Direct Message Setting
        driver.find_element(By.CSS_SELECTOR, "#direct-message-setting-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#search_unAuth_reporter > i")))

        # Search
        del driver.requests
        time.sleep(1)
        driver.find_element(By.CSS_SELECTOR, "#unAuth_reporter_search_value").send_keys(test_id)
        driver.find_element(By.CSS_SELECTOR, "#search_unAuth_reporter").click()
        driver.wait_for_request('.*/GetDirectMessage.*')
        time.sleep(0.5)

        # Check
        if driver.find_element(By.CSS_SELECTOR, "#center_unauthorized_reporter_list > tbody > tr:nth-child(1) > td:nth-child(2)").text != test_id:
            testResult = False
            Result_msg += "#4 "

        # DirectMessageSetting_Authorize결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2293, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2293, testPlanID, buildName, 'p', "DirectMessageSetting_Authorize Test Passed")

    def DirectMessageSetting_Selection():
        print("ITR-120: Direct Message > Direct Message Setting > Selection")
        testResult = True
        Result_msg = "failed at "
        
        Common.ReFresh()

        # DirectMessage
        driver.find_element(By.CSS_SELECTOR, "#tab-direct-message > a").click()
        driver.implicitly_wait(5)

        # Direct Message Setting
        driver.find_element(By.CSS_SELECTOR, "#direct-message-setting-btn").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#search_unAuth_reporter > i")))

        # Click > Click & Arrow #1, 2, 3, 4
        driver.find_element(By.CSS_SELECTOR, "#center_unauthorized_reporter_list > tbody > tr:nth-child(1) > td.th-check.align-center.dm-th-check > label").click()
        WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "#selected_reporter_box > button")))
        driver.find_element(By.CSS_SELECTOR, "#center_authorized_reporter_list > tbody > tr.odd > td.th-check.align-center.dm-th-check > label").click()
        time.sleep(0.25)
        if (driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[2]/div[3]/div/div/table/tbody/tr[1]/td[1]/input").is_selected() == True or
            driver.find_element(By.CSS_SELECTOR, "#selected_reporter_box > button").value_of_css_property("background-color") == "rgba(255, 152, 0, 1)"):
            testResult = False
            Result_msg += "#1 "

        if driver.find_element(By.CSS_SELECTOR, "#grant_direct_message_authentication_btn").value_of_css_property("cursor") != "not-allowed":
            tesTresult = False
            Result_msg += "#4 "

        driver.find_element(By.CSS_SELECTOR, "#center_unauthorized_reporter_list > tbody > tr:nth-child(1) > td.th-check.align-center.dm-th-check > label").click()
        time.sleep(0.25)
        if (driver.find_element(By.XPATH, "/html/body/section/div/div/div/div[2]/div[2]/div/div/div/div[2]/div/div[3]/div[4]/div[3]/div/div/table/tbody/tr[1]/td[1]/input").is_selected() == True or
            driver.find_element(By.CSS_SELECTOR, "#selected_reporter_box > button").value_of_css_property("background-color") == "rgba(242, 222, 222, 1)"):
            testResult = False
            Result_msg += "#2 "

        if driver.find_element(By.CSS_SELECTOR, "#remove_direct_message_authentication_btn").value_of_css_property("cursor") != "not-allowed":
            tesTresult = False
            Result_msg += "#3 "

        # DirectMessageSetting_Selection결과 전송 ##
        print("Test Result: Pass" if testResult != False else Result_msg)
        if testResult == False:
            testlink.reportTCResult(2299, testPlanID, buildName, 'f', Result_msg)            
        else:
            testlink.reportTCResult(2299, testPlanID, buildName, 'p', "DirectMessageSetting_Selection Test Passed")

failed_test_list = []
full_test = [
    # Sign
    Sign.Sign_InOut, # ITR-1
    Sign.Rememeber_Me, # ITR-2
    # Topbar
    Topbar.Search_Schedule_List, # ITR-3
    ## Refer
    #Refer.Hospital_List, # ITR-7
    #Refer.Reporter_List, # ITR-8
    ## Search filter
    #Search_filter.Priority, # ITR-9
    #Search_filter.Job_Status, # ITR-10
    #Search_filter.Date, # ITR-11
    #Search_filter.Patient_Location, # ITR-12
    #Search_filter.Patient_ID, # ITR-13
    #Search_filter.Patient_Name, # ITR-14
    #Search_filter.Age, # ITR-15
    #Search_filter.Study_Description, # ITR-16
    #Search_filter.Modality, # ITR-17
    #Search_filter.Bodypart, # ITR-18
    #Search_filter.Department, # ITR-19
    #Search_filter.Request_Name, # ITR-20
    #Search_filter.Search_All, # ITR-21
    #Search_filter.RealTime, # ITR-22
    #Search_filter.ShortCut, # ITR-23
    ## Worklist
    #Worklist.All_Assigned_List, # ITR-24
    #Worklist.Not_Assigned_List, # ITR-25
    #Worklist.All_List, # ITR-26
    #Worklist.Schedule, # ITR-27
    #Worklist.Priority, # ITR-28
    #Worklist.Canceled, # ITR-29
    #Worklist.Refer, # ITR-30
    #Worklist.Refer_Cancel, # ITR-31
    #Worklist.Refer_Cancel_And_Refer, # ITR-32
    Worklist.Set_Schedule, # ITR-34
    Worklist.Schedule_Cancel, # ITR-35
    Worklist.Revised, # ITR-36
    Worklist.Discard, # ITR-37
    Worklist.Retry_Request, # ITR-38
    Worklist.Columns, # ITR-39
    Worklist.Show_Entries, # ITR-40
    Worklist.Use_Related_Worklist, # ITR-224
    Worklist.Sort_By, # ITR-41
    # Statistics
    Statistics.SearchFilter_Date, # ITR-44
    Statistics.SearchFilter_Hospital, # ITR-45
    Statistics.SearchFilter_Reporter, # ITR-46
    Statistics.SearchFilter_Modality, # ITR-47
    Statistics.Columns, # ITR-42
    Statistics.Show_Entries # ITR-43
    ]

# Full Test
for test in full_test:
    time.sleep(0.5)
    #try:
    #    print("(",str(full_test.index(test)+1) + " / " + str(len(full_test)),")", round(((full_test.index(test)+1)*100/int(len(full_test))),1),"%")
    #    run_time = time.time()
    #    test()
    #except:
    #    for i in range(0,3):
    #        try:
    #            if test not in failed_test_list:
    #                failed_test_list.append(test)
    #            print("retry ("+str(i+1)+"/3)")
    #            print("before",failed_test_list)
    #            test()
    #            failed_test_list.remove(test)
    #            print("after",failed_test_list)
    #            break
    #        except:
    #            print("Occurred Exception")
    #            pass
    #finally:
    #    print("Run Time:", round((int(time.time() - run_time)/60),2),"min\n")
    #    pass
    test()

print("Total Run Time:", round((int(time.time() - start)/60),2),"min")
print("Failed Test List: ", failed_test_list)



# driver.quit()